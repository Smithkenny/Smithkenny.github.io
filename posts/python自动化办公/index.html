<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>python自动化办公之文件读写 - My New Hugo Site</title><meta name=Description content="This is my cool site"><meta property="og:title" content="python自动化办公之文件读写"><meta property="og:description" content="读写文件（上）&ndash;文件与文件路径
主要是os.path()第三方库
1.Windows系统中的\和Linux系统中的/
以下代码在Terminal中执行更直观
# D:\\code2022\\auto-work # /code2022/auto-work # 解决 \ 和 / 的问题，可以使用os.path.join() # os.path.join('D:\\','code2022','auto-work') 2.获取当前的目录
os.getcwd() # 切换到指定路径下 os.chdir('D:\\code2022') >>> os.getcwd() 'D:\\code2022\\auto-work' >>> os.chdir('D:\\code2022') >>> os.getcwd() 'D:\\code2022' 3.绝对路径和相对路径
绝对路径总是从根文件夹开始
相对路径是相对程序的当前工作目录
test1.py 的绝对路径 # D:\code2022\auto-work\test1.py # D:\code2022\auto-work\test2.py test2.py相对于test1.py的路径 # '.' 当前文件夹 # '..' 父文件夹 # 相对于test1.py 的路径 ../test2.py # 相对于auto-work/test2.py 的路径 ../../test2.py # 返回绝对路径 os.path.abspath('.') # 'D:\\code2022\\auto-work' os.path.abspath('test1.py') # 'D:\\code2022\\auto-work\\test1.py' # 返回相对路径 os.path.relpath(path[, start]) # 返回最后一个斜杠前的所有内容--目录名 os.path.dirname('D:\\code2022\\auto-work\\test1.py') # 'D:\\code2022\\auto-work' # 返回最后一个斜杠后的所有内容--文件名 os."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-07-11T22:01:17+00:00"><meta property="article:modified_time" content="2022-07-11T22:01:17+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="python自动化办公之文件读写"><meta name=twitter:description content="读写文件（上）&ndash;文件与文件路径
主要是os.path()第三方库
1.Windows系统中的\和Linux系统中的/
以下代码在Terminal中执行更直观
# D:\\code2022\\auto-work # /code2022/auto-work # 解决 \ 和 / 的问题，可以使用os.path.join() # os.path.join('D:\\','code2022','auto-work') 2.获取当前的目录
os.getcwd() # 切换到指定路径下 os.chdir('D:\\code2022') >>> os.getcwd() 'D:\\code2022\\auto-work' >>> os.chdir('D:\\code2022') >>> os.getcwd() 'D:\\code2022' 3.绝对路径和相对路径
绝对路径总是从根文件夹开始
相对路径是相对程序的当前工作目录
test1.py 的绝对路径 # D:\code2022\auto-work\test1.py # D:\code2022\auto-work\test2.py test2.py相对于test1.py的路径 # '.' 当前文件夹 # '..' 父文件夹 # 相对于test1.py 的路径 ../test2.py # 相对于auto-work/test2.py 的路径 ../../test2.py # 返回绝对路径 os.path.abspath('.') # 'D:\\code2022\\auto-work' os.path.abspath('test1.py') # 'D:\\code2022\\auto-work\\test1.py' # 返回相对路径 os.path.relpath(path[, start]) # 返回最后一个斜杠前的所有内容--目录名 os.path.dirname('D:\\code2022\\auto-work\\test1.py') # 'D:\\code2022\\auto-work' # 返回最后一个斜杠后的所有内容--文件名 os."><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/><link rel=prev href=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC%E4%B9%8Bexcel/><link rel=next href=https://blog.haipengv.com/posts/%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1%E7%88%AC%E8%99%AB/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"python自动化办公之文件读写","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.haipengv.com\/posts\/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC\/"},"genre":"posts","wordcount":601,"url":"https:\/\/blog.haipengv.com\/posts\/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC\/","datePublished":"2022-07-11T22:01:17+00:00","dateModified":"2022-07-11T22:01:17+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">python自动化办公之文件读写</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-07-11>2022-07-11</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;601 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;3 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#纯文本文件和二进制文件的区别>纯文本文件和二进制文件的区别</a></li><li><a href=#shelve模块>shelve模块</a></li><li><a href=#读写文件总结>读写文件总结</a></li><li><a href=#使用python实现大批量文件简繁体转换>使用python实现大批量文件简繁体转换</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>读写文件（上）&ndash;文件与文件路径</p><p>主要是<code>os.path()</code>第三方库</p><p>1.<code>Windows</code>系统中的<code>\</code>和Linux系统中的<code>/</code></p><p>以下代码在Terminal中执行更直观</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># D:\\code2022\\auto-work</span>
</span></span><span style=display:flex><span><span style=color:#75715e># /code2022/auto-work</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 解决 \ 和 / 的问题，可以使用os.path.join()</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#  os.path.join(&#39;D:\\&#39;,&#39;code2022&#39;,&#39;auto-work&#39;)</span>
</span></span></code></pre></div><p>2.获取当前的目录</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span><span style=color:#75715e># 切换到指定路径下</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>auto-work&#39;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> os<span style=color:#f92672>.</span>chdir(<span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022&#39;</span>
</span></span></code></pre></div><p>3.绝对路径和相对路径</p><p><strong>绝对路径总是从根文件夹开始</strong></p><p><strong>相对路径是相对程序的当前工作目录</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>test1<span style=color:#f92672>.</span>py 的绝对路径
</span></span><span style=display:flex><span><span style=color:#75715e># D:\code2022\auto-work\test1.py</span>
</span></span><span style=display:flex><span><span style=color:#75715e># D:\code2022\auto-work\test2.py</span>
</span></span><span style=display:flex><span>test2<span style=color:#f92672>.</span>py相对于test1<span style=color:#f92672>.</span>py的路径
</span></span><span style=display:flex><span><span style=color:#75715e># &#39;.&#39; 当前文件夹</span>
</span></span><span style=display:flex><span><span style=color:#75715e># &#39;..&#39; 父文件夹</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 相对于test1.py 的路径 ../test2.py</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 相对于auto-work/test2.py 的路径 ../../test2.py </span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 返回绝对路径</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(<span style=color:#e6db74>&#39;.&#39;</span>) <span style=color:#75715e># &#39;D:\\code2022\\auto-work&#39;</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>abspath(<span style=color:#e6db74>&#39;test1.py&#39;</span>) <span style=color:#75715e># &#39;D:\\code2022\\auto-work\\test1.py&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 返回相对路径</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>relpath(path[, start])
</span></span><span style=display:flex><span><span style=color:#75715e># 返回最后一个斜杠前的所有内容--目录名</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>dirname(<span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>auto-work</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>test1.py&#39;</span>) <span style=color:#75715e># &#39;D:\\code2022\\auto-work&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 返回最后一个斜杠后的所有内容--文件名</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(<span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>auto-work</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>test1.py&#39;</span>) <span style=color:#75715e># &#39;test1.py&#39;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 以元组的方式同时返回目录名和文件名</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>auto-work</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>test1.py&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#75715e># 结果：(&#39;D:\\code2022\\auto-work&#39;, &#39;test1.py&#39;)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 按照斜杠裁剪,os.path.sep 会根据系统取不同的值</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>auto-work</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>test1.py&#39;</span><span style=color:#f92672>.</span>split(os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>sep)
</span></span><span style=display:flex><span><span style=color:#75715e># 结果：[&#39;D:&#39;, &#39;code2022&#39;, &#39;auto-work&#39;, &#39;test1.py&#39;]</span>
</span></span></code></pre></div><p>4.创建新文件夹（<code>os.mkdir()</code>）</p><p>在<code>auto-work</code>文件夹下创建<code>test3</code>文件夹</p><p>重复创建会报错</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>os<span style=color:#f92672>.</span>mkdir(<span style=color:#e6db74>&#39;D:</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>code2022</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>auto-work</span><span style=color:#ae81ff>\\</span><span style=color:#e6db74>test3&#39;</span>)
</span></span></code></pre></div><p>5.查看文件大小和文件夹内容(单位是字节)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>getsize(<span style=color:#e6db74>&#39;test2.py&#39;</span>) <span style=color:#75715e># 28</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>listdir(<span style=color:#e6db74>&#39;.&#39;</span>) <span style=color:#75715e># [&#39;test1.py&#39;, &#39;test2.py&#39;, &#39;test3&#39;]</span>
</span></span></code></pre></div><p>这里是<code>os.listdir()</code>而不是<code>os.path.list()</code></p><p>6.检查路径是否有效</p><p>如果提供的路径不存在，会使程序崩溃，以下函数可以检查路径是否存在</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(<span style=color:#e6db74>&#39;test1.py&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isfile(<span style=color:#e6db74>&#39;test1.py&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isdir(<span style=color:#e6db74>&#39;test3&#39;</span>)
</span></span><span style=display:flex><span><span style=color:#66d9ef>True</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&gt;&gt;&gt;</span>
</span></span></code></pre></div><p>7.课后练习</p><p>把<code>test3</code>文件夹下的文件按照文件类型放到不同的文件夹下</p><p>把<code>xlsx</code>文件放到<code>test3\xlsx</code>文件夹下</p><p>把<code>jpeg</code>文件放到<code>test3\jpeg</code>文件夹下</p><p>把<code>pptx</code>文件放到<code>test3\pptx</code>文件夹下</p><p>把<code>docx</code>文件放到<code>test3\doc</code>文件夹下</p><p>把<code>txt</code>文件放到<code>test3\txt</code>文件夹下</p><p><strong><code>shutil</code>模块支持文件的复制和删除</strong></p><p><strong>windows和linux都能使用</strong></p><p><code>.py</code>文件放到整理的文件夹内执行</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os<span style=color:#f92672>,</span>shutil
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>cleanDir</span>():
</span></span><span style=display:flex><span>    BaseDir <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getcwd()
</span></span><span style=display:flex><span>    xlsxPath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(BaseDir,<span style=color:#e6db74>&#39;xlsx&#39;</span>)
</span></span><span style=display:flex><span>    imgPath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(BaseDir,<span style=color:#e6db74>&#39;img&#39;</span>)
</span></span><span style=display:flex><span>    pptPath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(BaseDir,<span style=color:#e6db74>&#39;ppt&#39;</span>)
</span></span><span style=display:flex><span>    docPath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(BaseDir,<span style=color:#e6db74>&#39;doc&#39;</span>)
</span></span><span style=display:flex><span>    txtPath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(BaseDir,<span style=color:#e6db74>&#39;txt&#39;</span>) <span style=color:#75715e># D:\\code2022\\auto-work\\test3\\txt</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(xlsxPath):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>mkdir(xlsxPath)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(imgPath):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>mkdir(imgPath)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(pptPath):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>mkdir(pptPath)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(docPath):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>mkdir(docPath)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>exists(txtPath):
</span></span><span style=display:flex><span>        os<span style=color:#f92672>.</span>mkdir(txtPath)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(BaseDir):
</span></span><span style=display:flex><span>        baseName <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>basename(file) <span style=color:#75715e># 9.txt</span>
</span></span><span style=display:flex><span>        filePath <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(BaseDir,file) <span style=color:#75715e># D:\\code2022\\auto-work\\test3\\9.txt</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>isfile(filePath):
</span></span><span style=display:flex><span>            ex <span style=color:#f92672>=</span> baseName<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#ae81ff>1</span>] <span style=color:#75715e># .txt</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> ex <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;xlsx&#39;</span>:
</span></span><span style=display:flex><span>                shutil<span style=color:#f92672>.</span>move(filePath,os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(xlsxPath,baseName))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> ex <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;jpeg&#39;</span>:
</span></span><span style=display:flex><span>                shutil<span style=color:#f92672>.</span>move(filePath,os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(imgPath,baseName))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> ex <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;pptx&#39;</span>:
</span></span><span style=display:flex><span>                shutil<span style=color:#f92672>.</span>move(filePath,os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(pptPath,baseName))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> ex <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;docx&#39;</span>:
</span></span><span style=display:flex><span>                shutil<span style=color:#f92672>.</span>move(filePath,os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(docPath,baseName))
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> ex <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;txt&#39;</span>:
</span></span><span style=display:flex><span>                shutil<span style=color:#f92672>.</span>move(filePath,os<span style=color:#f92672>.</span>path<span style=color:#f92672>.</span>join(txtPath,baseName))
</span></span><span style=display:flex><span>                <span style=color:#75715e># 把D:\\code2022\\auto-work\\test3\\9.txt 剪切到D:\\code2022\\auto-work\\test3\\txt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>cleanDir()
</span></span></code></pre></div><h3 id=纯文本文件和二进制文件的区别>纯文本文件和二进制文件的区别</h3><p>纯文本文件就是只包含基本文本字符，不包含字体、大小和颜色信息的，例如txt文件</p><p>二进制文件只是除了纯文本文件外的其他文件，例如pdf，图像,excel等。</p><h4 id=用程序读纯文本文件三步骤>用程序读纯文本文件三步骤：</h4><p><code>open()</code>打开，返回<code>File</code>对象</p><p>调用<code>File</code>对象的<code>read()</code>和<code>write</code>函数</p><p>调用<code>File</code>对象的<code>close()</code>函数，关闭该文件。</p><h4 id=打开文件>打开文件</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;D:\code2022\auto-work\test3\txt\9.txt&#39;</span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(filePath,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span></code></pre></div><h4 id=读取文件内容>读取文件内容</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># read() 读取所有</span>
</span></span><span style=display:flex><span>content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;txt的内容:&#39;</span>)
</span></span><span style=display:flex><span>print(content)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span><span style=color:#75715e># 按行读取</span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(filePath)
</span></span><span style=display:flex><span>rowIndex <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> f<span style=color:#f92672>.</span>readlines():
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;txt第</span><span style=color:#e6db74>{0}</span><span style=color:#e6db74>行内容:&#39;</span><span style=color:#f92672>.</span>format(rowIndex))
</span></span><span style=display:flex><span>    print(line)
</span></span><span style=display:flex><span>    rowIndex <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span><span style=color:#75715e># 规定读取字节数</span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(filePath)
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;第一行内容：&#39;</span>)
</span></span><span style=display:flex><span>print(f<span style=color:#f92672>.</span>readline())
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>print(<span style=color:#e6db74>&#39;读取5个字节：&#39;</span>)
</span></span><span style=display:flex><span>print(f<span style=color:#f92672>.</span>readline(<span style=color:#ae81ff>5</span>))
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><h4 id=写入文件>写入文件</h4><p><strong>写模式和添加模式</strong></p><p><strong>写模式会覆盖原来的内容</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>newFilePath <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;D:\code2022\auto-work\test3\txt\9.txt&#39;</span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(newFilePath,<span style=color:#e6db74>&#39;w&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;你好</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>f <span style=color:#f92672>=</span> open(newFilePath, <span style=color:#e6db74>&#39;a&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#34;这是我用添加模式增加的内容</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><p>练习：</p><p>将<code>D:\code2022\auto-work\test3\txt\10.txt</code>中的数字转换成中文数字并且保存到源文件中</p><p>文本内容如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>我还记得我初中3年都是在4班的<span style=color:#960050;background-color:#1e0010>，</span>成绩一直马马虎虎<span style=color:#960050;background-color:#1e0010>，</span>在班级前5名<span style=color:#960050;background-color:#1e0010>。</span>
</span></span><span style=display:flex><span>然后中考就进入了县里的重点高中<span style=color:#960050;background-color:#1e0010>。</span>
</span></span><span style=display:flex><span>高1的时候是在8班<span style=color:#960050;background-color:#1e0010>，</span>换了6位同桌<span style=color:#960050;background-color:#1e0010>，</span>其中2位是女生
</span></span><span style=display:flex><span>到高2高3<span style=color:#960050;background-color:#1e0010>，</span>又机缘巧合分到4班<span style=color:#960050;background-color:#1e0010>，</span>然后就一直到了毕业<span style=color:#960050;background-color:#1e0010>。</span>
</span></span></code></pre></div><p>代码实现：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>convertNum</span>():
</span></span><span style=display:flex><span>    filePath <span style=color:#f92672>=</span> <span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;D:\code2022\auto-work\test3\txt\10.txt&#39;</span>
</span></span><span style=display:flex><span>    f <span style=color:#f92672>=</span> open(filePath,<span style=color:#e6db74>&#39;r&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>    newlines <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> f<span style=color:#f92672>.</span>readlines():
</span></span><span style=display:flex><span>        newline <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> i <span style=color:#f92672>in</span> range(len(line)):
</span></span><span style=display:flex><span>            c <span style=color:#f92672>=</span> line[i]
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;0&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;零&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;1&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;一&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;2&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;二&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;3&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;三&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;4&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;四&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;5&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;五&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;6&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;六&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;7&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;七&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;8&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;八&#39;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>elif</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;9&#39;</span>:
</span></span><span style=display:flex><span>                c <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;九&#39;</span>
</span></span><span style=display:flex><span>            newline <span style=color:#f92672>=</span> newline <span style=color:#f92672>+</span> c 
</span></span><span style=display:flex><span>        newlines<span style=color:#f92672>.</span>append(newline)
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>    f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;D:\code2022\auto-work\test3\txt\11.txt&#39;</span>,<span style=color:#e6db74>&#39;w&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>writelines(newlines)
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>convertNum()
</span></span></code></pre></div><p>解读代码：</p><p>用<code>utf-8</code>编码打开文件，最外层<code>for</code>循环打印出每行形式，每一行都是一个列表。内层<code>for</code>循环，循环每一个列表中每一个字，如果碰到（0-9）就转换成相对应的汉字。保存到newlines列表中。关闭文件。创建一个新文件<code>11.txt</code>把处理后的列表写入<code>11.txt</code>中。</p><h3 id=shelve模块>shelve模块</h3><p>windows 保存成三个新文件 <code>.bak .dat .dir</code></p><p>mac/Linux 保存成一个新文件 <code>.db</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> shelve
</span></span><span style=display:flex><span>shelfFile <span style=color:#f92672>=</span> shelve<span style=color:#f92672>.</span>open(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;D:\code2022\auto-work\test3\txt\shelve.txt&#39;</span>)
</span></span><span style=display:flex><span>datas <span style=color:#f92672>=</span> {<span style=color:#e6db74>&#39;username&#39;</span>: <span style=color:#e6db74>&#39;smith&#39;</span>,<span style=color:#e6db74>&#39;password&#39;</span>:<span style=color:#e6db74>&#39;123456&#39;</span>}
</span></span><span style=display:flex><span>shelfFile[<span style=color:#e6db74>&#39;userInfo&#39;</span>] <span style=color:#f92672>=</span> datas
</span></span><span style=display:flex><span>shelfFile<span style=color:#f92672>.</span>close()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>shelfFile <span style=color:#f92672>=</span> shelve<span style=color:#f92672>.</span>open(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;D:\code2022\auto-work\test3\txt\shelve.txt&#39;</span>)
</span></span><span style=display:flex><span>print(list(shelfFile<span style=color:#f92672>.</span>keys()))
</span></span><span style=display:flex><span>print(shelfFile[<span style=color:#e6db74>&#39;userInfo&#39;</span>])
</span></span></code></pre></div><h3 id=读写文件总结>读写文件总结</h3><p>学习<code>os.path</code>的相关内容，绝对路径和相对路径，判断是否存在该路径</p><p>是否是文件或者目录，新建目录，得到该目录下所有文件等。</p><p><code>File</code>对象，纯文本文件的读取方式，<code>open()</code>打开，<code>read()/write()</code>读写，<code>close()</code>关闭</p><p><code>shelve</code>模块将数据保存到硬盘。</p><h3 id=使用python实现大批量文件简繁体转换>使用python实现大批量文件简繁体转换</h3><p>需要先安装<code>zhconv</code>和<code>python-docx</code></p><p><code>ToChs</code>是繁体转换成简体，<code>ToCht</code>是简体转换成繁体</p><p><code>ToChs</code>会把该文件夹下所有的docx文件全部处理成简体，保存为新文件，同理如<code>ToCht</code>.</p><p><strong>无论是繁体转换成简体还是繁体转换成简体，都要把程序放在和文件的同级目录内。支持表格内的文字转换</strong></p><p>原文章：<code>文章.docx</code></p><p>转换后的文章：<code>文章繁体版.docx</code></p><p>简体版同理</p><p><strong>简体转繁体</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 简体转繁体</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zhconv
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> docx <span style=color:#f92672>import</span> Document
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os 
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>convert</span>(text):
</span></span><span style=display:flex><span>    rule <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;zh-hant&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> zhconv<span style=color:#f92672>.</span>convert(text,rule)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ProcessDocx</span>(docxName):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;正在处理&#39;</span><span style=color:#f92672>+</span>docxName)
</span></span><span style=display:flex><span>    obj <span style=color:#f92672>=</span> Document(docxName)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> obj<span style=color:#f92672>.</span>paragraphs:
</span></span><span style=display:flex><span>        p<span style=color:#f92672>.</span>text <span style=color:#f92672>=</span> convert(p<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> obj<span style=color:#f92672>.</span>tables:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> t<span style=color:#f92672>.</span>rows:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>cells:
</span></span><span style=display:flex><span>                c<span style=color:#f92672>.</span>text <span style=color:#f92672>=</span> convert(c<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    <span style=color:#75715e># 文章.docx</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 文章繁体版.docx</span>
</span></span><span style=display:flex><span>    fileName <span style=color:#f92672>=</span> docxName<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)
</span></span><span style=display:flex><span>    newDocxName <span style=color:#f92672>=</span> fileName[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;繁体版&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> fileName[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    obj<span style=color:#f92672>.</span>save(newDocxName)
</span></span><span style=display:flex><span>    print(docxName<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;已经处理完毕&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(<span style=color:#e6db74>&#39;.&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> file<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;docx&#39;</span>:
</span></span><span style=display:flex><span>            ProcessDocx(file)
</span></span></code></pre></div><p><strong>繁体转简体</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># 繁体转换成简体</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> zhconv
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> docx <span style=color:#f92672>import</span> Document
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>convert</span>(text):
</span></span><span style=display:flex><span>    rule <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;zh-hans&#39;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> zhconv<span style=color:#f92672>.</span>convert(text,rule)
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>ProcessDocx</span>(docxName):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#39;正在处理&#39;</span><span style=color:#f92672>+</span>docxName)
</span></span><span style=display:flex><span>    obj <span style=color:#f92672>=</span> Document(docxName)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> p <span style=color:#f92672>in</span> obj<span style=color:#f92672>.</span>paragraphs:
</span></span><span style=display:flex><span>        p<span style=color:#f92672>.</span>text <span style=color:#f92672>=</span> convert(p<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> t <span style=color:#f92672>in</span> obj<span style=color:#f92672>.</span>tables:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> r <span style=color:#f92672>in</span> t<span style=color:#f92672>.</span>rows:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>for</span> c <span style=color:#f92672>in</span> r<span style=color:#f92672>.</span>cells:
</span></span><span style=display:flex><span>                c<span style=color:#f92672>.</span>text <span style=color:#f92672>=</span> convert(c<span style=color:#f92672>.</span>text)
</span></span><span style=display:flex><span>    <span style=color:#75715e># 文章.docx</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 文章简体版.docx</span>
</span></span><span style=display:flex><span>    fileName <span style=color:#f92672>=</span> docxName<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)
</span></span><span style=display:flex><span>    newDocxName <span style=color:#f92672>=</span> fileName[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;简体版&#34;</span> <span style=color:#f92672>+</span> <span style=color:#e6db74>&#39;.&#39;</span> <span style=color:#f92672>+</span> fileName[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>    obj<span style=color:#f92672>.</span>save(newDocxName)
</span></span><span style=display:flex><span>    print(docxName<span style=color:#f92672>+</span><span style=color:#e6db74>&#39;已经处理完毕&#39;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> file <span style=color:#f92672>in</span> os<span style=color:#f92672>.</span>listdir(<span style=color:#e6db74>&#39;.&#39;</span>):
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> file<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;.&#39;</span>)[<span style=color:#ae81ff>1</span>] <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;docx&#39;</span>:
</span></span><span style=display:flex><span>            ProcessDocx(file)
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-07-11</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/ data-title=python自动化办公之文件读写><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/ data-title=python自动化办公之文件读写><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/ data-title=python自动化办公之文件读写><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@6.20.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://blog.haipengv.com/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC/ data-title=python自动化办公之文件读写><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/python%E8%87%AA%E5%8A%A8%E5%8C%96%E5%8A%9E%E5%85%AC%E4%B9%8Bexcel/ class=prev rel=prev title=python自动化办公之excel><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>python自动化办公之excel</a>
<a href=/posts/%E8%B1%86%E7%93%A3%E7%94%B5%E5%BD%B1%E7%88%AC%E8%99%AB/ class=next rel=next title=豆瓣电影数据分析>豆瓣电影数据分析<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>