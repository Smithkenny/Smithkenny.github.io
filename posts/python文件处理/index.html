<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>python文件处理 - My New Hugo Site</title><meta name=Description content="This is my cool site"><meta property="og:title" content="python文件处理"><meta property="og:description" content="文件处理流程 1.打开文件，得到文件句柄并赋值给一个变量
2.通过句柄对文件进行操作
3.关闭文件
两种文件操作方式 直接操作（需要手动关闭文件） #1. 打开文件，得到文件句柄并赋值给一个变量 f=open('a.txt','r',encoding='utf-8') #默认打开模式就为r #2. 通过句柄对文件进行操作 data=f.read() #3. 关闭文件 f.close() 使用with关键字（推荐！自动关闭文件无需手动操作） #可用用with同时打开多个文件，用逗号分隔开即可 with open('a.txt','r',encoding='utf-8') as read_f,open('b.txt','w',encoding='utf-8') as write_f: data=read_f.read() write_f.write(data) 注意：若要保证不乱码，文件以什么方式存的，就要以什么方式打开。
f=open('a.txt','r',encoding='utf-8') linux默认编码'utf-8' windows默认编码 'gbk' python2中文件打开 #首先在python3中操作文件只有一种选择，那就是open() #而在python2中则有两种方式：file()与open() 两者都能够打开文件，对文件进行操作，也具有相似的用法和参数，但是，这两种文件打开方式有本质的区别，file为文件类，用file()来打开文件，相当于这是在构造文件类，而用open()打开文件，是用python的内建函数来操作，我们一般使用open()打开文件进行操作，而用file当做一个类型，比如type(f) is file。 打开文件的模式 基础 打开文件的模式有(默认为文本模式)
r，只读模式【默认模式，文件必须存在，文件存在文件内指针直接跳到文件开头,不存在则抛出异常】 w，只写模式【不可读；不存在则创建；存在则清空内容,文件指针跑到文件开头.】 a，之追加写模式【不可读；不存在则创建；存在则只追加内容，文件存在会将文件指针直接移动到文件末尾】 强调 在文件不关闭的情况下,连续的写入，后写的内容一定跟在前写内容的后面。
如果重新以w模式打开文件，则会清空文件内容。
a与w相同与异同 相同点：在打开的文件不关闭的情况下，连续的写入，新写的内容总会跟在前写的内容之后
不同点：以 a 模式重新打开文件，不会清空原文件内容，会将文件指针直接移动到文件末尾，新写的内容永远写在最后。
对于非文本文件，我们只能使用b模式，&ldquo;b&#34;表示以字节的方式操作（而所有文件也都是以字节的形式存储的，使用这种模式无需考虑文本文件的字符编码、图片文件的jgp格式、视频文件的avi格式）
rb wb ab 注：以b方式打开时，读取到的内容是字节类型，写入时也需要提供字节类型，不能指定编码 在平时工作中，我们只单纯使用r/w/a，要么只读，要么只写，一般不用可读可写的模式。 大前提: tb模式均不能单独使用,必须与r/w/a之一结合使用。
t（默认的）：文本模式 1. 读写文件都是以字符串为单位的 2. 只能针对文本文件 3. 必须指定encoding参数 b：二进制模式: 1.读写文件都是以bytes/二进制为单位的 2. 可以针对所有文件 3."><meta property="og:type" content="article"><meta property="og:url" content="https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-31T11:00:01+00:00"><meta property="article:modified_time" content="2022-03-31T11:00:01+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="python文件处理"><meta name=twitter:description content="文件处理流程 1.打开文件，得到文件句柄并赋值给一个变量
2.通过句柄对文件进行操作
3.关闭文件
两种文件操作方式 直接操作（需要手动关闭文件） #1. 打开文件，得到文件句柄并赋值给一个变量 f=open('a.txt','r',encoding='utf-8') #默认打开模式就为r #2. 通过句柄对文件进行操作 data=f.read() #3. 关闭文件 f.close() 使用with关键字（推荐！自动关闭文件无需手动操作） #可用用with同时打开多个文件，用逗号分隔开即可 with open('a.txt','r',encoding='utf-8') as read_f,open('b.txt','w',encoding='utf-8') as write_f: data=read_f.read() write_f.write(data) 注意：若要保证不乱码，文件以什么方式存的，就要以什么方式打开。
f=open('a.txt','r',encoding='utf-8') linux默认编码'utf-8' windows默认编码 'gbk' python2中文件打开 #首先在python3中操作文件只有一种选择，那就是open() #而在python2中则有两种方式：file()与open() 两者都能够打开文件，对文件进行操作，也具有相似的用法和参数，但是，这两种文件打开方式有本质的区别，file为文件类，用file()来打开文件，相当于这是在构造文件类，而用open()打开文件，是用python的内建函数来操作，我们一般使用open()打开文件进行操作，而用file当做一个类型，比如type(f) is file。 打开文件的模式 基础 打开文件的模式有(默认为文本模式)
r，只读模式【默认模式，文件必须存在，文件存在文件内指针直接跳到文件开头,不存在则抛出异常】 w，只写模式【不可读；不存在则创建；存在则清空内容,文件指针跑到文件开头.】 a，之追加写模式【不可读；不存在则创建；存在则只追加内容，文件存在会将文件指针直接移动到文件末尾】 强调 在文件不关闭的情况下,连续的写入，后写的内容一定跟在前写内容的后面。
如果重新以w模式打开文件，则会清空文件内容。
a与w相同与异同 相同点：在打开的文件不关闭的情况下，连续的写入，新写的内容总会跟在前写的内容之后
不同点：以 a 模式重新打开文件，不会清空原文件内容，会将文件指针直接移动到文件末尾，新写的内容永远写在最后。
对于非文本文件，我们只能使用b模式，&ldquo;b&#34;表示以字节的方式操作（而所有文件也都是以字节的形式存储的，使用这种模式无需考虑文本文件的字符编码、图片文件的jgp格式、视频文件的avi格式）
rb wb ab 注：以b方式打开时，读取到的内容是字节类型，写入时也需要提供字节类型，不能指定编码 在平时工作中，我们只单纯使用r/w/a，要么只读，要么只写，一般不用可读可写的模式。 大前提: tb模式均不能单独使用,必须与r/w/a之一结合使用。
t（默认的）：文本模式 1. 读写文件都是以字符串为单位的 2. 只能针对文本文件 3. 必须指定encoding参数 b：二进制模式: 1.读写文件都是以bytes/二进制为单位的 2. 可以针对所有文件 3."><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/><link rel=prev href=https://blog.haipengv.com/posts/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/><link rel=next href=https://blog.haipengv.com/posts/vsftpd%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"python文件处理","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.haipengv.com\/posts\/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86\/"},"genre":"posts","wordcount":331,"url":"https:\/\/blog.haipengv.com\/posts\/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86\/","datePublished":"2022-03-31T11:00:01+00:00","dateModified":"2022-03-31T11:00:01+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">python文件处理</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-03-31>2022-03-31</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;331 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;2 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#文件处理流程>文件处理流程</a><ul><li><a href=#两种文件操作方式>两种文件操作方式</a></li><li><a href=#python2中文件打开>python2中文件打开</a></li><li><a href=#打开文件的模式>打开文件的模式</a></li><li><a href=#操作文件的方法>操作文件的方法</a></li><li><a href=#文件内光标移动>文件内光标移动</a></li><li><a href=#文件的修改>文件的修改</a></li><li><a href=#文件的逐行读取并打印行号>文件的逐行读取并打印行号</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=文件处理流程>文件处理流程</h2><p>1.打开文件，得到文件句柄并赋值给一个变量</p><p>2.通过句柄对文件进行操作</p><p>3.关闭文件</p><h3 id=两种文件操作方式>两种文件操作方式</h3><h4 id=直接操作需要手动关闭文件>直接操作（需要手动关闭文件）</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#1. 打开文件，得到文件句柄并赋值给一个变量</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>=</span>open(<span style=color:#e6db74>&#39;a.txt&#39;</span>,<span style=color:#e6db74>&#39;r&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#75715e>#默认打开模式就为r</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#2. 通过句柄对文件进行操作</span>
</span></span><span style=display:flex><span>data<span style=color:#f92672>=</span>f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#3. 关闭文件</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>close()
</span></span></code></pre></div><h4 id=使用with关键字推荐自动关闭文件无需手动操作>使用<code>with</code>关键字（推荐！自动关闭文件无需手动操作）</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#可用用with同时打开多个文件，用逗号分隔开即可</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;a.txt&#39;</span>,<span style=color:#e6db74>&#39;r&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> read_f,open(<span style=color:#e6db74>&#39;b.txt&#39;</span>,<span style=color:#e6db74>&#39;w&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> write_f:
</span></span><span style=display:flex><span>    data<span style=color:#f92672>=</span>read_f<span style=color:#f92672>.</span>read()
</span></span><span style=display:flex><span>    write_f<span style=color:#f92672>.</span>write(data)
</span></span></code></pre></div><p>注意：若要保证不乱码，文件以什么方式存的，就要以什么方式打开。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>f<span style=color:#f92672>=</span>open(<span style=color:#e6db74>&#39;a.txt&#39;</span>,<span style=color:#e6db74>&#39;r&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>)
</span></span><span style=display:flex><span>linux默认编码<span style=color:#e6db74>&#39;utf-8&#39;</span>
</span></span><span style=display:flex><span>windows默认编码 <span style=color:#e6db74>&#39;gbk&#39;</span>
</span></span></code></pre></div><h3 id=python2中文件打开>python2中文件打开</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#首先在python3中操作文件只有一种选择，那就是open()</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#而在python2中则有两种方式：file()与open()</span>
</span></span><span style=display:flex><span>两者都能够打开文件<span style=color:#960050;background-color:#1e0010>，</span>对文件进行操作<span style=color:#960050;background-color:#1e0010>，</span>也具有相似的用法和参数<span style=color:#960050;background-color:#1e0010>，</span>但是<span style=color:#960050;background-color:#1e0010>，</span>这两种文件打开方式有本质的区别<span style=color:#960050;background-color:#1e0010>，</span>file为文件类<span style=color:#960050;background-color:#1e0010>，</span>用file()来打开文件<span style=color:#960050;background-color:#1e0010>，</span>相当于这是在构造文件类<span style=color:#960050;background-color:#1e0010>，</span>而用open()打开文件<span style=color:#960050;background-color:#1e0010>，</span>是用python的内建函数来操作<span style=color:#960050;background-color:#1e0010>，</span>我们一般使用open()打开文件进行操作<span style=color:#960050;background-color:#1e0010>，</span>而用file当做一个类型<span style=color:#960050;background-color:#1e0010>，</span>比如type(f) <span style=color:#f92672>is</span> file<span style=color:#960050;background-color:#1e0010>。</span>
</span></span></code></pre></div><h3 id=打开文件的模式>打开文件的模式</h3><h4 id=基础>基础</h4><p>打开文件的模式有(默认为文本模式)</p><pre tabindex=0><code>r，只读模式【默认模式，文件必须存在，文件存在文件内指针直接跳到文件开头,不存在则抛出异常】
w，只写模式【不可读；不存在则创建；存在则清空内容,文件指针跑到文件开头.】
a，之追加写模式【不可读；不存在则创建；存在则只追加内容，文件存在会将文件指针直接移动到文件末尾】
</code></pre><h4 id=强调>强调</h4><p>在文件不关闭的情况下,连续的写入，后写的内容一定跟在前写内容的后面。</p><p>如果重新以w模式打开文件，则会清空文件内容。</p><h4 id=a与w相同与异同><code>a</code>与<code>w</code>相同与异同</h4><p>相同点：在打开的文件不关闭的情况下，连续的写入，新写的内容总会跟在前写的内容之后</p><p>不同点：以 a 模式重新打开文件，不会清空原文件内容，会将文件指针直接移动到文件末尾，新写的内容永远写在最后。</p><p>对于非文本文件，我们只能使用b模式，&ldquo;b"表示以字节的方式操作（而所有文件也都是以字节的形式存储的，使用这种模式无需考虑文本文件的字符编码、图片文件的<code>jgp格式</code>、视频文件的<code>avi格式</code>）</p><pre tabindex=0><code>rb 
wb
ab
注：以b方式打开时，读取到的内容是字节类型，写入时也需要提供字节类型，不能指定编码
</code></pre><p>在平时工作中，我们只单纯使用<code>r/w/a</code>，要么只读，要么只写，一般不用可读可写的模式。
大前提: <code>tb模式</code>均不能单独使用,必须与<code>r/w/a</code>之一结合使用。</p><pre tabindex=0><code>t（默认的）：文本模式
    1. 读写文件都是以字符串为单位的
    2. 只能针对文本文件
    3. 必须指定encoding参数
b：二进制模式:
   1.读写文件都是以bytes/二进制为单位的
   2. 可以针对所有文件
   3. 一定不能指定encoding参数
</code></pre><p>强调：<code>b模式对比t模式</code>
1、在操作纯文本文件方面t模式帮我们省去了编码与解码的环节，b模式则需要手动编码与解码，所以此时t模式更为方便。
2、针对非文本文件（如图片、视频、音频等）只能使用b模式。</p><h4 id=拓展>拓展</h4><pre tabindex=0><code>&#34;+&#34; 表示可以同时读写某个文件
r+， 读写【可读，可写】
w+，写读【可读，可写】
a+， 写读【可读，可写】
x， 只写模式【不可读；不存在则创建，存在则报错】
x+ ，写读【可读，可写】
</code></pre><p>回车与换行</p><pre tabindex=0><code>\n 换行
\r 回车
</code></pre><h3 id=操作文件的方法>操作文件的方法</h3><h4 id=基础-1>基础</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>f<span style=color:#f92672>.</span>read() <span style=color:#75715e>#读取所有内容,光标移动到文件末尾。</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>readline() <span style=color:#75715e>#读取一行内容,光标移动到第二行首部。</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>readlines() <span style=color:#75715e>#读取每一行内容,存放于列表中。</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>write(<span style=color:#e6db74>&#39;11111</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>222</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>) <span style=color:#75715e>#针对文本模式的写,需要自己写换行符。</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>writelines(<span style=color:#e6db74>&#39;11111</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>222</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)) <span style=color:#75715e>#针对b模式的写,需要自己写换行符。</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>writelines([<span style=color:#e6db74>&#39;333</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>,<span style=color:#e6db74>&#39;444</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>]) <span style=color:#75715e>#文件模式</span>
</span></span><span style=display:flex><span>f<span style=color:#f92672>.</span>writelines([bytes(<span style=color:#e6db74>&#39;333</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>),<span style=color:#e6db74>&#39;444</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#39;</span><span style=color:#f92672>.</span>encode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)]) <span style=color:#75715e>#b模式</span>
</span></span></code></pre></div><h4 id=拓展-1>拓展</h4><pre tabindex=0><code>f.readable() #文件是否可读
f.writeable() #文件是否可写
f.closed #文件是否关闭
f.encoding() #如果文件打开模式为b,则没有该属性。
f.flush() #立刻将文件内容从内存刷到硬盘
f.name #显示文件名
f.tell() #显示当前光标位置
f.seek(0) #重置光标位置,光标会跳到第一行行首。
</code></pre><h3 id=文件内光标移动>文件内光标移动</h3><p><code>read(3)</code></p><pre tabindex=0><code>文件打开方式为文本模式时，代表读取3个字符。
文件打开方式为b模式时，代表读取3个字节。
</code></pre><p>其余的文件内光标移动都是以字节为单位如<code>seek，tell，truncate</code>。</p><p>注意</p><p><code>seek</code>有三种移动方式<code>0，1，2</code>，其中1和2必须在<code>b模式</code>下进行，但无论哪种模式，都是以<code>bytes</code>为单位移动的.</p><p><code>truncate</code>是截断文件，所以文件的打开方式必须可写，但是不能用<code>w</code>或<code>w+</code>等方式打开，因为那样直接清空文件了，所以<code>truncate</code>要在<code>r+或a或a+</code>等模式下测试效果。</p><p>之前文件内指针的移动都是由读/写操作而被动触发的，若想读取文件某一特定位置的数据，则需要用<code>f.seek方法</code>主动控制文件内指针的移动，详细用法如下：
<code>f.seek</code>(指针移动的字节数,模式控制):
模式控制:
0: 默认的模式,该模式代表指针移动的字节数是以文件开头为参照的
1: 该模式代表指针移动的字节数是以当前所在的位置为参照的
2: 该模式代表指针移动的字节数是以文件末尾的位置为参照的
强调:其中0模式可以在t或者b模式使用,而1跟2模式只能在b模式下用</p><p><code>0模式</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># a.txt用utf-8编码，内容如下（abc各占1个字节，中文“你好”各占3个字节）</span>
</span></span><span style=display:flex><span>abc你好
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 0模式的使用</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;a.txt&#39;</span>,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rt&#39;</span>,encoding<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;utf-8&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>seek(<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>0</span>)     <span style=color:#75715e># 参照文件开头移动了3个字节</span>
</span></span><span style=display:flex><span>    print(f<span style=color:#f92672>.</span>tell()) <span style=color:#75715e># 查看当前文件指针距离文件开头的位置，输出结果为3</span>
</span></span><span style=display:flex><span>    print(f<span style=color:#f92672>.</span>read()) <span style=color:#75715e># 从第3个字节的位置读到文件末尾，输出结果为：你好</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 注意：由于在t模式下，会将读取的内容自动解码，所以必须保证读取的内容是一个完整中文数据，否则解码失败</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;a.txt&#39;</span>,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>seek(<span style=color:#ae81ff>6</span>,<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    print(f<span style=color:#f92672>.</span>read()<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>)) <span style=color:#75715e>#输出结果为: 好</span>
</span></span></code></pre></div><p><code>1模式</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ae81ff>1</span>模式
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;a.txt&#39;</span>,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>seek(<span style=color:#ae81ff>3</span>,<span style=color:#ae81ff>1</span>) <span style=color:#75715e># 从当前位置往后移动3个字节，而此时的当前位置就是文件开头</span>
</span></span><span style=display:flex><span>    print(f<span style=color:#f92672>.</span>tell()) <span style=color:#75715e># 输出结果为：3</span>
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>seek(<span style=color:#ae81ff>4</span>,<span style=color:#ae81ff>1</span>)     <span style=color:#75715e># 从当前位置往后移动4个字节，而此时的当前位置为3</span>
</span></span><span style=display:flex><span>    print(f<span style=color:#f92672>.</span>tell()) <span style=color:#75715e># 输出结果为：7</span>
</span></span></code></pre></div><p>练习：使用<code>seek()</code>实现<code>shell中tail -f （文件日志追加功能）</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> time
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;access.log&#39;</span>,<span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> f:
</span></span><span style=display:flex><span>    f<span style=color:#f92672>.</span>seek(<span style=color:#ae81ff>0</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        line <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readline()
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> line:
</span></span><span style=display:flex><span>            print(line<span style=color:#f92672>.</span>decode(<span style=color:#e6db74>&#39;utf-8&#39;</span>))
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>            time<span style=color:#f92672>.</span>sleep(<span style=color:#ae81ff>0.2</span>)
</span></span></code></pre></div><p>练习编写文件<code>copy</code>工具</p><p>方法1</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>src_file<span style=color:#f92672>=</span>input(<span style=color:#e6db74>&#39;源文件路径: &#39;</span>)<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span>dst_file<span style=color:#f92672>=</span>input(<span style=color:#e6db74>&#39;目标文件路径: &#39;</span>)<span style=color:#f92672>.</span>strip()
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span>src_file,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> read_f,open(<span style=color:#e6db74>r</span><span style=color:#e6db74>&#39;</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#39;</span> <span style=color:#f92672>%</span>dst_file,mode<span style=color:#f92672>=</span><span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> write_f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> read_f:
</span></span><span style=display:flex><span>        <span style=color:#75715e># print(line)</span>
</span></span><span style=display:flex><span>        write_f<span style=color:#f92672>.</span>write(line)
</span></span></code></pre></div><p>方法2</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#任意文件拷贝</span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> sys <span style=color:#75715e>#引入sys模块</span>
</span></span><span style=display:flex><span>_, src_file, dst_file <span style=color:#f92672>=</span> sys<span style=color:#f92672>.</span>argv <span style=color:#75715e>#传参，_表示占位符。</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(src_file, <span style=color:#e6db74>&#39;rb&#39;</span>) <span style=color:#66d9ef>as</span> read_f,\
</span></span><span style=display:flex><span>        open(dst_file, <span style=color:#e6db74>&#39;wb&#39;</span>) <span style=color:#66d9ef>as</span> write_f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> read_f:
</span></span><span style=display:flex><span>        write_f<span style=color:#f92672>.</span>write(line)
</span></span><span style=display:flex><span><span style=color:#75715e>#print(sys.argv)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#使用方式 python D:\pccharmcode\begin.py 源文件路径 目的文件路径</span>
</span></span></code></pre></div><h3 id=文件的修改>文件的修改</h3><p>文件的数据是存放于硬盘上的，因而只存在覆盖、不存在修改这么一说，我们平时看到的修改文件，都是模拟出来的效果，具体的说有两种实现方式：</p><p>方式一：将硬盘存放的该文件的内容全部加载到内存，在内存中是可以修改的，修改完毕后，再由内存覆盖到硬盘（word，vim，nodpad++等编辑器）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;a.txt&#39;</span>) <span style=color:#66d9ef>as</span> read_f,open(<span style=color:#e6db74>&#39;.a.txt.swap&#39;</span>,<span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> write_f:
</span></span><span style=display:flex><span>    data<span style=color:#f92672>=</span>read_f<span style=color:#f92672>.</span>read() <span style=color:#75715e>#全部读入内存,如果文件很大,会很卡</span>
</span></span><span style=display:flex><span>    data<span style=color:#f92672>=</span>data<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;alex&#39;</span>,<span style=color:#e6db74>&#39;SB&#39;</span>) <span style=color:#75715e>#在内存中完成修改</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    write_f<span style=color:#f92672>.</span>write(data) <span style=color:#75715e>#一次性写入新文件</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>remove(<span style=color:#e6db74>&#39;a.txt&#39;</span>)
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>rename(<span style=color:#e6db74>&#39;.a.txt.swap&#39;</span>,<span style=color:#e6db74>&#39;a.txt&#39;</span>) 
</span></span></code></pre></div><p>方式二：将硬盘存放的该文件的内容一行一行地读入内存，修改完毕就写入新文件，最后用新文件覆盖源文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>with</span> open(<span style=color:#e6db74>&#39;a.txt&#39;</span>) <span style=color:#66d9ef>as</span> read_f,open(<span style=color:#e6db74>&#39;.a.txt.swap&#39;</span>,<span style=color:#e6db74>&#39;w&#39;</span>) <span style=color:#66d9ef>as</span> write_f:
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> line <span style=color:#f92672>in</span> read_f: <span style=color:#75715e>#读</span>
</span></span><span style=display:flex><span>        line<span style=color:#f92672>=</span>line<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;alex&#39;</span>,<span style=color:#e6db74>&#39;SB&#39;</span>) <span style=color:#75715e>#替换</span>
</span></span><span style=display:flex><span>        write_f<span style=color:#f92672>.</span>write(line)	<span style=color:#75715e>#写入</span>
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>remove(<span style=color:#e6db74>&#39;a.txt&#39;</span>)
</span></span><span style=display:flex><span>os<span style=color:#f92672>.</span>rename(<span style=color:#e6db74>&#39;.a.txt.swap&#39;</span>,<span style=color:#e6db74>&#39;a.txt&#39;</span>) 
</span></span></code></pre></div><h3 id=文件的逐行读取并打印行号>文件的逐行读取并打印行号</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>f <span style=color:#f92672>=</span> open(<span style=color:#e6db74>&#34;test.txt&#34;</span>,<span style=color:#e6db74>&#34;r&#34;</span>)
</span></span><span style=display:flex><span>content <span style=color:#f92672>=</span> f<span style=color:#f92672>.</span>readlines()
</span></span><span style=display:flex><span>i <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> 
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> temp <span style=color:#f92672>in</span> content:
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>&#34;</span><span style=color:#e6db74>%d</span><span style=color:#e6db74>:</span><span style=color:#e6db74>%s</span><span style=color:#e6db74>&#34;</span><span style=color:#f92672>%</span>(i,temp))
</span></span><span style=display:flex><span>    i <span style=color:#f92672>+=</span> <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>输出</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#ae81ff>1</span>:hello world<span style=color:#960050;background-color:#1e0010>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>2</span>:hello world<span style=color:#960050;background-color:#1e0010>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>3</span>:hello world<span style=color:#960050;background-color:#1e0010>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>4</span>:hello world<span style=color:#960050;background-color:#1e0010>!</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>5</span>:hello world<span style=color:#960050;background-color:#1e0010>!</span>
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-03-31</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ data-title=python文件处理><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ data-title=python文件处理><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ data-title=python文件处理><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@6.20.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://blog.haipengv.com/posts/python%E6%96%87%E4%BB%B6%E5%A4%84%E7%90%86/ data-title=python文件处理><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98%E6%80%BB%E7%BB%93/ class=prev rel=prev title=常见问题总结><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>常见问题总结</a>
<a href=/posts/vsftpd%E7%9B%B8%E5%85%B3%E9%85%8D%E7%BD%AE/ class=next rel=next title=vsftpd相关配置>vsftpd相关配置<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>