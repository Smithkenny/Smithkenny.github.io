<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>git入门 - My New Hugo Site</title><meta name=Description content="This is my cool site"><meta property="og:title" content="git入门"><meta property="og:description" content="git入门 介绍 Git 是一个开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目。
windows中安装 各操作系统版本下载 安装后在开始菜单里找到&#34;Git&#34;->&ldquo;Git Bash&rdquo;，会弹出 Git 命令窗口，你可以在该窗口进行 Git 操作。
创建工作目录，比如在D盘根目录下创建blog
mkdir -p blog git初始化 默认会生成.git文件夹
git init 用户信息 配置个人的用户名称和电子邮件地址：
git config --global user.name &#34;smith&#34; git config --global user.email smith@gmail.com 查看配置信息 git config --list 也可以在配置文件中看到
vim ~/.gitconfig [http] postBuffer = 2M [user] name = smith email = smith@gmail.com git 工作流程 git-process.png
创建readme.txt文件 Git is a version control system. Git is free software. 把文件提交到暂存区 git add readme.txt git commit -m &#34;first push&#34; -m:后面输入本次提交的说明，可以输入任何内容。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-05-07T12:50:33+00:00"><meta property="article:modified_time" content="2022-05-07T12:50:33+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="git入门"><meta name=twitter:description content="git入门 介绍 Git 是一个开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目。
windows中安装 各操作系统版本下载 安装后在开始菜单里找到&#34;Git&#34;->&ldquo;Git Bash&rdquo;，会弹出 Git 命令窗口，你可以在该窗口进行 Git 操作。
创建工作目录，比如在D盘根目录下创建blog
mkdir -p blog git初始化 默认会生成.git文件夹
git init 用户信息 配置个人的用户名称和电子邮件地址：
git config --global user.name &#34;smith&#34; git config --global user.email smith@gmail.com 查看配置信息 git config --list 也可以在配置文件中看到
vim ~/.gitconfig [http] postBuffer = 2M [user] name = smith email = smith@gmail.com git 工作流程 git-process.png
创建readme.txt文件 Git is a version control system. Git is free software. 把文件提交到暂存区 git add readme.txt git commit -m &#34;first push&#34; -m:后面输入本次提交的说明，可以输入任何内容。"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/><link rel=prev href=https://blog.haipengv.com/posts/ansible%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/><link rel=next href=https://blog.haipengv.com/posts/%E5%AE%89%E8%A3%85%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%ACpython/><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"git入门","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.haipengv.com\/posts\/git%E5%85%A5%E9%97%A8\/"},"genre":"posts","wordcount":1454,"url":"https:\/\/blog.haipengv.com\/posts\/git%E5%85%A5%E9%97%A8\/","datePublished":"2022-05-07T12:50:33+00:00","dateModified":"2022-05-07T12:50:33+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">git入门</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-05-07>2022-05-07</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;1454 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;7 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#git入门>git入门</a><ul><li><a href=#介绍>介绍</a></li><li><a href=#windows中安装>windows中安装</a></li><li><a href=#git初始化>git初始化</a></li><li><a href=#git-工作流程>git 工作流程</a></li><li><a href=#查看提交日志>查看提交日志</a></li><li><a href=#版本回退>版本回退</a></li><li><a href=#总结>总结</a></li><li><a href=#工作区和暂存区>工作区和暂存区</a></li><li><a href=#管理修改>管理修改</a></li><li><a href=#撤销更改>撤销更改</a></li><li><a href=#删除文件>删除文件</a></li><li><a href=#远程仓库>远程仓库</a></li><li><a href=#分支管理>分支管理</a></li><li><a href=#分支管理策略>分支管理策略</a></li><li><a href=#参考>参考</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=git入门>git入门</h2><h3 id=介绍>介绍</h3><p>Git 是一个开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目。</p><h3 id=windows中安装>windows中安装</h3><p><a href=https://git-scm.com/downloads target=_blank rel="noopener noreffer">各操作系统版本下载</a></p><p>安装后在开始菜单里找到"Git"->&ldquo;Git Bash&rdquo;，会弹出 Git 命令窗口，你可以在该窗口进行 Git 操作。</p><p>创建工作目录，比如在D盘根目录下创建blog</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>mkdir -p blog
</span></span></code></pre></div><h3 id=git初始化>git初始化</h3><p>默认会生成.git文件夹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>git init
</span></span></code></pre></div><h4 id=用户信息>用户信息</h4><p>配置个人的用户名称和电子邮件地址：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git config --global user.name <span style=color:#e6db74>&#34;smith&#34;</span>
</span></span><span style=display:flex><span>git config --global user.email smith@gmail.com
</span></span></code></pre></div><h4 id=查看配置信息>查看配置信息</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git config --list
</span></span></code></pre></div><p>也可以在配置文件中看到</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vim ~/.gitconfig 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>http<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    postBuffer <span style=color:#f92672>=</span> 2M
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>user<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>    name <span style=color:#f92672>=</span> smith
</span></span><span style=display:flex><span>    email <span style=color:#f92672>=</span> smith@gmail.com
</span></span></code></pre></div><h3 id=git-工作流程>git 工作流程</h3><p>git-process.png</p><h4 id=创建readmetxt文件>创建<code>readme.txt</code>文件</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span></code></pre></div><h4 id=把文件提交到暂存区>把文件提交到暂存区</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add readme.txt
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#34;first push&#34;</span>
</span></span></code></pre></div><p><code>-m</code>:后面输入本次提交的说明，可以输入任何内容。</p><h3 id=查看提交日志>查看提交日志</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log 
</span></span><span style=display:flex><span>commit 934e87838ae19b396a9db3779f5722be53701f22 <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Author: smith &lt;smith@gmail.com&gt;
</span></span><span style=display:flex><span>Date:   Mon May <span style=color:#ae81ff>9</span> 09:17:05 <span style=color:#ae81ff>2022</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    thired version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit 7580fbdc4ddfd4cf740cba51e1661b020806638c
</span></span><span style=display:flex><span>Author: smith &lt;smith@gmail.com&gt;
</span></span><span style=display:flex><span>Date:   Mon May <span style=color:#ae81ff>9</span> 09:16:18 <span style=color:#ae81ff>2022</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    second version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit 48eca9171d496942470fbcb5b93500bf593c3fdf
</span></span><span style=display:flex><span>Author: smith &lt;smith@gmail.com&gt;
</span></span><span style=display:flex><span>Date:   Mon May <span style=color:#ae81ff>9</span> 09:12:21 <span style=color:#ae81ff>2022</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    first push
</span></span></code></pre></div><p>精简输出加上<code>--pretty=oneline</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log --pretty<span style=color:#f92672>=</span>oneline
</span></span><span style=display:flex><span>934e87838ae19b396a9db3779f5722be53701f22 <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span> thired version
</span></span><span style=display:flex><span>7580fbdc4ddfd4cf740cba51e1661b020806638c second version
</span></span><span style=display:flex><span>48eca9171d496942470fbcb5b93500bf593c3fdf first push
</span></span></code></pre></div><p><code>commit</code>后面的id是根据<code>sha1</code>算法得来的。</p><p>各个版本中readme.txt内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>版本一
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>版本二
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>second version
</span></span><span style=display:flex><span>版本三
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>thired version
</span></span></code></pre></div><h3 id=版本回退>版本回退</h3><p>通过<code>git log</code>查看最新一次提交id为<code>934e87838ae19b396a9db3779f5722be53701f22</code>。git中用HEAD表示当前版本。上一个版本用<code>HEAD^'</code>表示，上上版本用<code>HEAD^^</code>表示。往上100个版本用<code>HEAD~100</code>表示。现在回到上一个版本。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git reset --hard HEAD^
</span></span><span style=display:flex><span>HEAD is now at 7580fbd second version
</span></span></code></pre></div><p>查看readme.txt文件内容。果然回到上一个版本了。</p><h4 id=查看当前版本库状态>查看当前版本库状态</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log
</span></span><span style=display:flex><span>commit 7580fbdc4ddfd4cf740cba51e1661b020806638c <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Author: smith &lt;smith@gmail.com&gt;
</span></span><span style=display:flex><span>Date:   Mon May <span style=color:#ae81ff>9</span> 09:16:18 <span style=color:#ae81ff>2022</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    second version
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>commit 48eca9171d496942470fbcb5b93500bf593c3fdf
</span></span><span style=display:flex><span>Author: smith &lt;smith@gmail.com&gt;
</span></span><span style=display:flex><span>Date:   Mon May <span style=color:#ae81ff>9</span> 09:12:21 <span style=color:#ae81ff>2022</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    first push
</span></span></code></pre></div><p>发现之前的版本不见了，还可以通过commit id 回到之前的版本。id不用写全，至少写6位。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git reset --hard 934e87
</span></span><span style=display:flex><span>HEAD is now at 934e878 thired version
</span></span></code></pre></div><p>再次查看readme.txt文件果然又回来了。</p><p>Git的版本回退速度非常快，因为Git在内部有个指向当前版本的<code>HEAD</code>指针，当你回退版本的时候，Git仅仅是把HEAD从指向<code>thired version</code>.</p><p>如果还想回退到最新版本而又忘记了commit id ，Git提供了一个命令<code>git reflog</code>用来记录你的每一次命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git reflog
</span></span><span style=display:flex><span>934e878 <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span> HEAD@<span style=color:#f92672>{</span>0<span style=color:#f92672>}</span>: reset: moving to 934e87
</span></span><span style=display:flex><span>7580fbd HEAD@<span style=color:#f92672>{</span>1<span style=color:#f92672>}</span>: reset: moving to HEAD^
</span></span><span style=display:flex><span>934e878 <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span> HEAD@<span style=color:#f92672>{</span>2<span style=color:#f92672>}</span>: commit: thired version
</span></span><span style=display:flex><span>7580fbd HEAD@<span style=color:#f92672>{</span>3<span style=color:#f92672>}</span>: commit: second version
</span></span><span style=display:flex><span>48eca91 HEAD@<span style=color:#f92672>{</span>4<span style=color:#f92672>}</span>: commit <span style=color:#f92672>(</span>initial<span style=color:#f92672>)</span>: first push
</span></span></code></pre></div><p>然后通过commit id回到最新版本。</p><h3 id=总结>总结</h3><ul><li><code>HEAD</code>指向的版本就是当前版本，因此，Git允许我们在版本的历史之间穿梭，使用命令<code>git reset --hard commit_id</code>。</li><li>穿梭前，用<code>git log</code>可以查看提交历史，以便确定要回退到哪个版本。</li><li>要重返未来，用<code>git reflog</code>查看命令历史，以便确定要回到未来的哪个版本。</li></ul><h3 id=工作区和暂存区>工作区和暂存区</h3><h4 id=工作区>工作区</h4><p>在笔记本中创建的blog文件夹就是工作区。</p><h4 id=暂存区>暂存区</h4><h4 id=版本库repository>版本库（Repository）</h4><p>工作区有一个隐藏目录<code>.git</code>，这个不算工作区，而是Git的版本库。Git的版本库里存了很多东西，其中最重要的就是称为stage（或者叫index）的暂存区，还有Git为我们自动创建的第一个分支<code>master</code>，以及指向<code>master</code>的一个指针叫<code>HEAD</code>。</p><p>把文件向git版本库里添加时，分两步执行：</p><ul><li>用<code>git add</code>把文件添加进去，实际上就是把文件修改添加到暂存区</li><li>用<code>git commit</code>提交更改，实际上就是把暂存区的所有内容提交到当前分支。</li></ul><p>因为我们创建Git版本库时，Git自动为我们创建了唯一一个<code>master</code>分支，所以，现在，<code>git commit</code>就是往<code>master</code>分支上提交更改。</p><p>需要提交的文件修改通通放到暂存区，然后，一次性提交暂存区的所有修改。</p><p>测试：</p><p>修改readme.txt文件。提交到暂存区，查看当前状态，最后提交到当前分支。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>Changes to be committed:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   readme.txt
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;change sth&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>master 410b2e7<span style=color:#f92672>]</span> change sth
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>1</span> insertion<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>, <span style=color:#ae81ff>1</span> deletion<span style=color:#f92672>(</span>-<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>nothing to commit, working tree clean
</span></span></code></pre></div><p>一旦提交后，如果你又没有对工作区做任何修改，那么工作区就是“干净”的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>nothing to commit, working tree clean
</span></span></code></pre></div><h3 id=管理修改>管理修改</h3><p>测试过程：第一次修改 -> <code>git add</code> -> 第二次修改 -> <code>git commit</code></p><p>修改readme.txt文件</p><p>第一次修改并提交到缓存区</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi readme.txt
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>with add
</span></span><span style=display:flex><span>$ git add readme.txt
</span></span></code></pre></div><p>第二次修改直接使用commit 提交</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ with readme.txt
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>no add
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;change sth&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>master 729bf9e<span style=color:#f92672>]</span> change sth
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>1</span> insertion<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>最后查看状态，发现第二次修改没被提交。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>Changes not staged <span style=color:#66d9ef>for</span> commit:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   readme.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>no changes added to commit <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add&#34;</span> and/or <span style=color:#e6db74>&#34;git commit -a&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><h4 id=总结-1>总结</h4><p>Git管理的是修改，当你用<code>git add</code>命令后，在工作区的第一次修改被放入暂存区，准备提交，但是，在工作区的第二次修改并没有放入暂存区，所以，<code>git commit</code>只负责把暂存区的修改提交了，也就是第一次的修改被提交了，第二次的修改不会被提交。</p><p>提交后，用<code>git diff HEAD -- readme.txt</code>命令可以查看工作区和版本库里面最新版本的区别：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git diff HEAD -- readme.txt
</span></span><span style=display:flex><span>diff --git a/readme.txt b/readme.txt
</span></span><span style=display:flex><span>index 23faa4f..199308a <span style=color:#ae81ff>100644</span>
</span></span><span style=display:flex><span>--- a/readme.txt
</span></span><span style=display:flex><span>+++ b/readme.txt
</span></span><span style=display:flex><span>@@ -1,3 +1,3 @@
</span></span><span style=display:flex><span> Git is a version control system.
</span></span><span style=display:flex><span> Git is free software.
</span></span><span style=display:flex><span>-with add
</span></span><span style=display:flex><span>+no add
</span></span></code></pre></div><p>那怎么提交第二次修改呢？你可以继续<code>git add</code>再<code>git commit</code>，也可以别着急提交第一次修改，先<code>git add</code>第二次修改，再<code>git commit</code>，就相当于把两次修改合并后一块提交了：</p><p>第一次修改 -> <code>git add</code> -> 第二次修改 -> <code>git add</code> -> <code>git commit</code></p><p>都操作完后查看状态。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>nothing to commit, working tree clean
</span></span></code></pre></div><h3 id=撤销更改>撤销更改</h3><p>修改<code>readme.txt</code>文件&ndash;>git add(提交到暂存区，没有commit) &ndash;>发现文件修改有错误&ndash;>git reset HEAD file(把暂存区的修改回退到工作区) &ndash;>git checkout &ndash; file(丢弃工作区的修改)&ndash;>git status (查看状态)</p><p><code>vi readme.txt</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>no add
</span></span><span style=display:flex><span>add sthssssss
</span></span></code></pre></div><p>提交到暂存区，没有commit</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git add readme.txt
</span></span></code></pre></div><p>查看状态。有修改。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>Changes to be committed:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore --staged &lt;file&gt;...&#34;</span> to unstage<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   readme.txt
</span></span></code></pre></div><p>把暂存区的修改回退到工作区</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git reset HEAD readme.txt
</span></span><span style=display:flex><span>Unstaged changes after reset:
</span></span><span style=display:flex><span>M       readme.txt
</span></span></code></pre></div><p>查看状态。已撤回。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>Changes not staged <span style=color:#66d9ef>for</span> commit:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   readme.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>no changes added to commit <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add&#34;</span> and/or <span style=color:#e6db74>&#34;git commit -a&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>丢弃工作区的修改</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git checkout -- readme.txt
</span></span></code></pre></div><p>查看状态。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>nothing to commit, working tree clean
</span></span></code></pre></div><p>文件已还原</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat readme.txt
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>no add
</span></span></code></pre></div><h4 id=总结-2>总结</h4><ul><li>提交到暂存区的文件可以用<code>git reset HEAD file</code>命令把文件退回到工作区。</li><li>退回到工作区后用<code>git checkout -- file</code>命令丢弃工作区修改。</li><li>可以用<code>git status</code>查看状态。</li></ul><h3 id=删除文件>删除文件</h3><p>文件提交后直接把文件删除可以在版本库中找到并恢复，如果从来没提交过，那文件是无法恢复的。</p><p>实验：创建<code>test.txt</code>文件并提交到版本库，工作区删除文件。并恢复。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git add .
</span></span><span style=display:flex><span>git commit -m <span style=color:#e6db74>&#39;test&#39;</span>
</span></span><span style=display:flex><span>rm test.txt
</span></span></code></pre></div><p>查看状态</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch master
</span></span><span style=display:flex><span>Changes not staged <span style=color:#66d9ef>for</span> commit:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add/rm &lt;file&gt;...&#34;</span> to update what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        deleted:    test.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>no changes added to commit <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add&#34;</span> and/or <span style=color:#e6db74>&#34;git commit -a&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><p>恢复文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git checkout -- test.txt
</span></span></code></pre></div><p><code>git checkout</code>其实是用版本库里的版本替换工作区的版本，无论工作区是修改还是删除，都可以“一键还原”。</p><p>如果确实不想用了版本区可以删除文件，这样就永久删除了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git rm test.txt
</span></span></code></pre></div><h3 id=远程仓库>远程仓库</h3><p>需求：</p><p>将本地仓和远程仓数据同步，还可以多人协同。</p><p>本地仓：笔记本</p><p>远程仓：github</p><p>1.github上创建新仓库</p><p>2.将远程仓库克隆到本地</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git remote add origin git@github.com:github用户名/仓库名.git</span>
</span></span></code></pre></div><p>3.把本地库所有内容推送到远程库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git push -u origin master
</span></span></code></pre></div><p>把本地库的内容推送到远程，用<code>git push</code>命令，实际上是把当前分支<code>master</code>推送到远程。由于远程库是空的，我们第一次推送<code>master</code>分支时，加上了<code>-u</code>参数，Git不但会把本地的<code>master</code>分支内容推送的远程新的<code>master</code>分支，还会把本地的<code>master</code>分支和远程的<code>master</code>分支关联起来，在以后的推送或者拉取时就可以简化命令。</p><p>推送成功后，可以立刻在GitHub页面中看到远程库的内容已经和本地一模一样。</p><p>后面再次推送可以使用简化命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git push origin master
</span></span></code></pre></div><h4 id=删除远程库>删除远程库</h4><p>如果添加的时候地址写错了，或者就是想删除远程库，可以用<code>git remote rm &lt;name></code>命令。使用前，建议先用<code>git remote -v</code>查看远程库信息。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git remote -v</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>origin  git@github.com:michaelliao/learn-git.git (fetch)</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>origin  git@github.com:michaelliao/learn-git.git (push)</span>
</span></span></code></pre></div><p>然后，根据名字删除，比如删除<code>origin</code>：</p><pre tabindex=0><code>$ git remote rm origin
</code></pre><p>此处的“删除”其实是解除了本地和远程的绑定关系，并不是物理上删除了远程库。远程库本身并没有任何改动。要真正删除远程库，需要登录到GitHub，在后台页面找到删除按钮再删除。</p><p>总结</p><p>要关联一个远程库，使用命令<code>git remote add origin git@server-name:path/repo-name.git</code>；</p><p>关联一个远程库时必须给远程库指定一个名字，<code>origin</code>是默认习惯命名；</p><p>关联后，使用命令<code>git push -u origin master</code>第一次推送master分支的所有内容；</p><p>此后，每次本地提交后，只要有必要，就可以使用命令<code>git push origin master</code>推送最新修改。</p><h4 id=从远程库克隆>从远程库克隆</h4><p>克隆一个本地库</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>$ git clone git@github.com:github用户名/仓库名.git</span>
</span></span></code></pre></div><p>本地查看有了。</p><p>有几种方式克隆仓库到本地</p><ul><li>https :https://github.com/github用户名/仓库名.git</li><li>ssh : <a href=mailto:git@github.com rel>git@github.com</a>
:github用户名/仓库名.git</li><li>github cli : gh repo clone github用户名/仓库名</li></ul><p>推荐使用ssh方式，速度更快。</p><h3 id=分支管理>分支管理</h3><p>创建分支dev</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git checkout -b dev</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Switched to a new branch &#39;dev&#39;</span>
</span></span></code></pre></div><p>查看当前分支，星号代表当前分支</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git branch -a</span>
</span></span><span style=display:flex><span>* <span style=color:#ae81ff>dev</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>master</span>
</span></span></code></pre></div><p>写入内容</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi readme.txt
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>dev branch add sth
</span></span></code></pre></div><p>上传到暂存区，并推送到dev分支。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git add .</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ git commit -m &#34;push dev branch&#34;</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>dev d51e5f2] push dev branch</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>file changed, 1 insertion(+)</span>
</span></span></code></pre></div><p>切换到master主分支，查看readme.txt文件发现最后一行不见了。git中各分支之间互不影响。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git checkout master
</span></span></code></pre></div><p>将dev分支和master主分支合并。<code>merge</code>后面是要合并的分支名。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git merge dev</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Updating 8e3076e..d51e5f2</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Fast-forward</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>readme.txt | 1 +</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>file changed, 1 insertion(+)</span>
</span></span></code></pre></div><p>切换到master分支</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>git checkout master
</span></span></code></pre></div><p>再次查看文件内容，显示了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat readme.txt
</span></span><span style=display:flex><span>Git is a version control system.
</span></span><span style=display:flex><span>Git is free software.
</span></span><span style=display:flex><span>dev branch add sth
</span></span></code></pre></div><h4 id=删除dev分支>删除dev分支</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>git branch -d dev</span>
</span></span></code></pre></div><h4 id=总结-3>总结</h4><p>Git鼓励大量使用分支：</p><p>查看分支：<code>git branch</code></p><p>创建分支：<code>git branch &lt;name></code></p><p>切换分支：<code>git checkout &lt;name></code>或者<code>git switch &lt;name></code></p><p>创建+切换分支：<code>git checkout -b &lt;name></code>或者<code>git switch -c &lt;name></code></p><p>合并某分支到当前分支：<code>git merge &lt;name></code></p><p>删除分支：<code>git branch -d &lt;name></code></p><p>新版本git 支持switch来切换分支。更加容易区分。</p><h3 id=分支管理策略>分支管理策略</h3><p>通常，合并分支时，如果可能，Git会用<code>Fast forward</code>模式，但这种模式下，删除分支后，会丢掉分支信息。</p><p>如果要强制禁用<code>Fast forward</code>模式，Git就会在merge时生成一个新的commit，这样，从分支历史上就可以看出分支信息。</p><p>下面我们实战一下<code>--no-ff</code>方式的<code>git merge</code>：</p><p>首先，仍然创建并切换<code>dev</code>分支：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git switch -c dev
</span></span><span style=display:flex><span>Switched to a new branch <span style=color:#e6db74>&#39;dev&#39;</span>
</span></span></code></pre></div><p>修改readme.txt文件，并提交一个新的commit：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git add readme.txt 
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;add merge&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>dev f52c633<span style=color:#f92672>]</span> add merge
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>1</span> insertion<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>现在，我们切换回<code>master</code>：</p><pre tabindex=0><code>$ git switch master
Switched to branch &#39;master&#39;
</code></pre><p>准备合并<code>dev</code>分支，请注意<code>--no-ff</code>参数，表示禁用<code>Fast forward</code>：</p><pre tabindex=0><code>$ git merge --no-ff -m &#34;merge with no-ff&#34; dev
Merge made by the &#39;recursive&#39; strategy.
 readme.txt | 1 +
 1 file changed, 1 insertion(+)
</code></pre><p>因为本次合并要创建一个新的commit，所以加上<code>-m</code>参数，把commit描述写进去。</p><p>合并后，我们用<code>git log</code>看看分支历史：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git log --graph --pretty<span style=color:#f92672>=</span>oneline --abbrev-commit
</span></span><span style=display:flex><span>*   f116cb6 <span style=color:#f92672>(</span>HEAD -&gt; master<span style=color:#f92672>)</span> merge with no-ff
</span></span><span style=display:flex><span>|<span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>| * 98d73ce <span style=color:#f92672>(</span>dev<span style=color:#f92672>)</span> add merge
</span></span><span style=display:flex><span>|/
</span></span><span style=display:flex><span>* d51e5f2 push dev branch
</span></span><span style=display:flex><span>* 8e3076e init
</span></span><span style=display:flex><span>* 3f097bb dev branch commit
</span></span><span style=display:flex><span>* 601bf08 del sth
</span></span></code></pre></div><h4 id=分支策略>分支策略</h4><ul><li><code>master</code>分支应该是非常稳定的，也就是仅用来发布新版本</li><li><code>dev</code>分支是不稳定的，到某个时候，比如1.0版本发布时，再把<code>dev</code>分支合并到<code>master</code>上，在<code>master</code>分支发布1.0版本。</li><li>你和你的小伙伴们每个人都在<code>dev</code>分支上干活，每个人都有自己的分支，时不时地往<code>dev</code>分支上合并就可以了。</li></ul><p>合并分支时，加上<code>--no-ff</code>参数就可以用普通模式合并，合并后的历史有分支，能看出来曾经做过合并，而<code>fast forward</code>合并就看不出来曾经做过合并。</p><h4 id=bug分支>Bug分支</h4><p>发现master分支有Bug需要修复，此时dev上的工作还没提交到暂存区。可以用<code>git stash</code>命令将当前工作现场保存起来，后面修复完Bug后在还原回来。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git status
</span></span><span style=display:flex><span>On branch dev
</span></span><span style=display:flex><span>Changes not staged <span style=color:#66d9ef>for</span> commit:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   readme.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>no changes added to commit <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add&#34;</span> and/or <span style=color:#e6db74>&#34;git commit -a&#34;</span><span style=color:#f92672>)</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git stash</span>
</span></span><span style=display:flex><span><span style=color:#f92672>Saved working directory and index state WIP on dev</span>: <span style=color:#ae81ff>7f2ad74 init status</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ git status</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>On</span> <span style=color:#ae81ff>branch dev</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>nothing to commit, working tree clean</span>
</span></span></code></pre></div><p>首先确定要在哪个分支上修复bug，假定需要在<code>master</code>分支上修复，就从<code>master</code>创建临时分支：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#ae81ff>$ git checkout master</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Switched to branch &#39;master&#39;</span>
</span></span></code></pre></div><p>创建新分支<code>issue-102</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git checkout -b issue-102</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Switched to a new branch &#39;issue-102&#39;</span>
</span></span></code></pre></div><p>修复Bug（修改readme.txt文件内容），然后提交。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git add readme.txt
</span></span><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;fix bug 102&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>issue-102 858cab6<span style=color:#f92672>]</span> fix bug <span style=color:#ae81ff>102</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>1</span> insertion<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>修复完成后，切换到<code>master</code>分支，并完成合并，最后删除<code>issue-102</code>分支：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git switch master
</span></span><span style=display:flex><span>Switched to branch <span style=color:#e6db74>&#39;master&#39;</span>
</span></span><span style=display:flex><span>$ git merge --no-ff -m <span style=color:#e6db74>&#34;merged bug fix 102&#34;</span> issue-102
</span></span><span style=display:flex><span>Merge made by the <span style=color:#e6db74>&#39;ort&#39;</span> strategy.
</span></span><span style=display:flex><span> readme.txt | <span style=color:#ae81ff>1</span> +
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> file changed, <span style=color:#ae81ff>1</span> insertion<span style=color:#f92672>(</span>+<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>现在回到dev分支还原之前的工作状态</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git switch dev
</span></span><span style=display:flex><span>Switched to branch <span style=color:#e6db74>&#39;dev&#39;</span>
</span></span></code></pre></div><p>查看之前存储的数据</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git stash list
</span></span><span style=display:flex><span>stash@<span style=color:#f92672>{</span>0<span style=color:#f92672>}</span>: WIP on dev: 7f2ad74 init status
</span></span></code></pre></div><p>两种方法恢复之前的工作内容</p><ul><li>用<code>git stash apply</code>恢复，但是恢复后，stash内容并不删除，你需要用<code>git stash drop</code>来删除</li><li>用<code>git stash pop</code>，恢复的同时把stash内容也删了</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git stash pop
</span></span><span style=display:flex><span>On branch dev
</span></span><span style=display:flex><span>Changes not staged <span style=color:#66d9ef>for</span> commit:
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add &lt;file&gt;...&#34;</span> to update what will be committed<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git restore &lt;file&gt;...&#34;</span> to discard changes in working directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>        modified:   readme.txt
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>no changes added to commit <span style=color:#f92672>(</span>use <span style=color:#e6db74>&#34;git add&#34;</span> and/or <span style=color:#e6db74>&#34;git commit -a&#34;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Dropped refs/stash@<span style=color:#f92672>{</span>0<span style=color:#f92672>}</span> <span style=color:#f92672>(</span>6228502b0116dba3633cdb19b738aba9bd6d4664<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>你可以多次stash，恢复的时候，先用<code>git stash list</code>查看，然后恢复指定的stash，用命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span><span style=color:#ae81ff>$ git stash apply stash@{0}</span>
</span></span></code></pre></div><p>在master分支上修复了bug后，我们要想一想，dev分支是早期从master分支分出来的，所以，这个bug其实在当前dev分支上也存在。</p><p>先切换到master分支上查看之前“ fix bug 102” 那条<code>commit id</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git switch master <span style=color:#75715e>#也可以用git switch -来切换。</span>
</span></span><span style=display:flex><span>$ git log --graph
</span></span><span style=display:flex><span>commit 858cab6c5238646df8d353bfd83382a92a432fcd <span style=color:#f92672>(</span>issue-102<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>Author: smith &lt;smith@gmail.com&gt;
</span></span><span style=display:flex><span>Date:   Tue May <span style=color:#ae81ff>10</span> 13:18:18 <span style=color:#ae81ff>2022</span> +0800
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    fix bug <span style=color:#ae81ff>102</span>
</span></span></code></pre></div><p>Git专门提供了一个<code>cherry-pick</code>命令，让我们能复制一个特定的提交到当前分支。再次切换到dev分支，复制master分支上“fix bug 102”这条改动提交。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ git branch</span>
</span></span><span style=display:flex><span>* <span style=color:#ae81ff>dev</span>
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>master</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>$ git cherry-pick 858cab</span>
</span></span><span style=display:flex><span>[<span style=color:#ae81ff>dev 0996ec3] fix bug 102</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>Date</span>: <span style=color:#ae81ff>Tue May 10 13:18:18 2022 +0800</span>
</span></span><span style=display:flex><span> <span style=color:#ae81ff>1</span> <span style=color:#ae81ff>file changed, 1 insertion(+)</span>
</span></span></code></pre></div><p>Git自动给dev分支做了一次提交，注意这次提交的commit是<code>0996ec3</code>，它并不同于master的<code>858cab</code>，因为这两个commit只是改动相同，但确实是两个不同的commit。用<code>git cherry-pick</code>，我们就不需要在dev分支上手动再把修bug的过程重复一遍。</p><h5 id=总结-4>总结</h5><p>修复bug时，我们会通过创建新的bug分支进行修复，然后合并，最后删除；</p><p>当手头工作没有完成时，先把工作现场<code>git stash</code>一下，然后去修复bug，修复后，再<code>git stash pop</code>，回到工作现场；</p><p>在master分支上修复的bug，想要合并到当前dev分支，可以用<code>git cherry-pick &lt;commit></code>命令，把bug提交的修改“复制”到当前分支，避免重复劳动。</p><h3 id=参考>参考</h3><p><a href=https://www.liaoxuefeng.com/wiki/896043488029600/900375748016320 target=_blank rel="noopener noreffer">1</a></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-05-07</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/ data-title=git入门><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/ data-title=git入门><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/ data-title=git入门><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@6.20.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=https://blog.haipengv.com/posts/git%E5%85%A5%E9%97%A8/ data-title=git入门><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/ansible%E5%9F%BA%E7%A1%80%E6%95%99%E7%A8%8B/ class=prev rel=prev title=ansible基础教程><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>ansible基础教程</a>
<a href=/posts/%E5%AE%89%E8%A3%85%E4%BB%BB%E6%84%8F%E7%89%88%E6%9C%ACpython/ class=next rel=next title=基于centos7/8安装任意版本python>基于centos7/8安装任意版本python<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.10"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>