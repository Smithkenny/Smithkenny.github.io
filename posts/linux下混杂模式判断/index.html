<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>linux下混杂模式判断 - My New Hugo Site</title><meta name=Description content="This is my cool site"><meta property="og:title" content="linux下混杂模式判断"><meta property="og:description" content="简介 混杂模式就是接收所有经过网卡的数据包，包括不是发给本机的包，即不验证MAC地址。普通模式下网卡只接收发给本机的包（包括广播包）传递给上层程序，其它的包一律丢弃。
一般来说，混杂模式不会影响网卡的正常工作，多在网络监听工具上使用。
网卡工作模式 广播模式（Broad Cast Model）:它的物理地址（MAC）地址是 0Xffffff 的帧为广播帧，工作在广播模式的网卡接收广播帧。
多播传送（MultiCast Model）：多播传送地址作为目的物理地址的帧可以被组内的其它主机同时接收，而组外主机却接收不到。但是，如果将网卡设置为多播传送模式，它可以接收所有的多播传送帧，而不论它是不是组内成员。
直接模式（Direct Model）:工作在直接模式下的网卡只接收目地址是自己 Mac地址的帧。
混杂模式（Promiscuous Model）:工作在混杂模式下的网卡接收所有的流过网卡的帧，信包捕获程序就是在这种模式下运行的。
网卡的缺省工作模式包含广播模式和直接模式，即它只接收广播帧和发给自己的帧。如果采用混杂模式，一个站点的网卡将接受同一网络内所有站点所发送的数据包这样就可以到达对于网络信息监视捕获的目的。
开启混杂模式 Linux下设置把网卡设置成混杂模式的命令也很简单。
ifconfig ens33 promisc cat /sys/class/net/ens33/flags 取消混杂模式 ifconfig ens33 -promisc cat /sys/class/net/ens33/flags 拓展 使用tcpdump工具抓包时，抓包的网口会临时变成混杂模式。
[root@nginx140 ~]# tcpdump -i ens33 -vv -nn -w ./test.cap tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes ^C537 packets captured 540 packets received by filter 0 packets dropped by kernel 抓包的同时查看对应网卡标志位
[root@nginx140 ~]# cat /sys/class/net/ens33/flags 0x1103 总结 当网卡的标志位为0x1003时，没有开启混杂模式。而网卡标志位为0x1103时，说明该网卡开启了混杂模式。"><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-14T19:10:03+00:00"><meta property="article:modified_time" content="2022-02-14T19:10:03+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="linux下混杂模式判断"><meta name=twitter:description content="简介 混杂模式就是接收所有经过网卡的数据包，包括不是发给本机的包，即不验证MAC地址。普通模式下网卡只接收发给本机的包（包括广播包）传递给上层程序，其它的包一律丢弃。
一般来说，混杂模式不会影响网卡的正常工作，多在网络监听工具上使用。
网卡工作模式 广播模式（Broad Cast Model）:它的物理地址（MAC）地址是 0Xffffff 的帧为广播帧，工作在广播模式的网卡接收广播帧。
多播传送（MultiCast Model）：多播传送地址作为目的物理地址的帧可以被组内的其它主机同时接收，而组外主机却接收不到。但是，如果将网卡设置为多播传送模式，它可以接收所有的多播传送帧，而不论它是不是组内成员。
直接模式（Direct Model）:工作在直接模式下的网卡只接收目地址是自己 Mac地址的帧。
混杂模式（Promiscuous Model）:工作在混杂模式下的网卡接收所有的流过网卡的帧，信包捕获程序就是在这种模式下运行的。
网卡的缺省工作模式包含广播模式和直接模式，即它只接收广播帧和发给自己的帧。如果采用混杂模式，一个站点的网卡将接受同一网络内所有站点所发送的数据包这样就可以到达对于网络信息监视捕获的目的。
开启混杂模式 Linux下设置把网卡设置成混杂模式的命令也很简单。
ifconfig ens33 promisc cat /sys/class/net/ens33/flags 取消混杂模式 ifconfig ens33 -promisc cat /sys/class/net/ens33/flags 拓展 使用tcpdump工具抓包时，抓包的网口会临时变成混杂模式。
[root@nginx140 ~]# tcpdump -i ens33 -vv -nn -w ./test.cap tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes ^C537 packets captured 540 packets received by filter 0 packets dropped by kernel 抓包的同时查看对应网卡标志位
[root@nginx140 ~]# cat /sys/class/net/ens33/flags 0x1103 总结 当网卡的标志位为0x1003时，没有开启混杂模式。而网卡标志位为0x1103时，说明该网卡开启了混杂模式。"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/><link rel=prev href=http://example.org/posts/redhat6.3yum%E6%BA%90%E5%A4%B1%E6%95%88%E8%A7%A3%E5%86%B3/><link rel=next href=http://example.org/posts/%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAip%E5%B9%B6%E5%A4%8D%E5%88%B6%E5%88%B0registry%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"linux下混杂模式判断","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD\/"},"genre":"posts","wordcount":73,"url":"http:\/\/example.org\/posts\/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD\/","datePublished":"2022-02-14T19:10:03+00:00","dateModified":"2022-02-14T19:10:03+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">linux下混杂模式判断</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-02-14>2022-02-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;73 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;One minute&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#简介>简介</a></li><li><a href=#网卡工作模式>网卡工作模式</a></li><li><a href=#开启混杂模式>开启混杂模式</a></li><li><a href=#取消混杂模式>取消混杂模式</a></li><li><a href=#拓展>拓展</a></li><li><a href=#总结>总结</a></li></ul></nav></div></div><div class=content id=content><h2 id=简介>简介</h2><p>混杂模式就是接收所有经过网卡的数据包，包括不是发给本机的包，即不验证MAC地址。普通模式下网卡只接收发给本机的包（包括广播包）传递给上层程序，其它的包一律丢弃。</p><p>一般来说，混杂模式不会影响网卡的正常工作，多在网络监听工具上使用。</p><h2 id=网卡工作模式>网卡工作模式</h2><p>广播模式（Broad Cast Model）:它的物理地址（MAC）地址是 0Xffffff 的帧为广播帧，工作在广播模式的网卡接收广播帧。</p><p>多播传送（MultiCast Model）：多播传送地址作为目的物理地址的帧可以被组内的其它主机同时接收，而组外主机却接收不到。但是，如果将网卡设置为多播传送模式，它可以接收所有的多播传送帧，而不论它是不是组内成员。</p><p>直接模式（Direct Model）:工作在直接模式下的网卡只接收目地址是自己 Mac地址的帧。</p><p>混杂模式（Promiscuous Model）:工作在混杂模式下的网卡接收所有的流过网卡的帧，信包捕获程序就是在这种模式下运行的。</p><p><strong>网卡的缺省工作模式包含广播模式和直接模式，即它只接收广播帧和发给自己的帧。如果采用混杂模式，一个站点的网卡将接受同一网络内所有站点所发送的数据包这样就可以到达对于网络信息监视捕获的目的。</strong></p><h2 id=开启混杂模式>开启混杂模式</h2><p>Linux下设置把网卡设置成混杂模式的命令也很简单。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ifconfig ens33 promisc
</span></span><span style=display:flex><span>cat /sys/class/net/ens33/flags
</span></span></code></pre></div><p><img class=lazyload src=/svg/loading.min.svg data-src=/img/postimages/%e5%bc%80%e5%90%af%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp data-srcset="/img/postimages/%e5%bc%80%e5%90%af%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp, /img/postimages/%e5%bc%80%e5%90%af%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp 1.5x, /img/postimages/%e5%bc%80%e5%90%af%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp 2x" data-sizes=auto alt=/img/postimages/开启混杂模式.webp title=开启混杂模式></p><h2 id=取消混杂模式>取消混杂模式</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>ifconfig ens33 -promisc
</span></span><span style=display:flex><span>cat /sys/class/net/ens33/flags
</span></span></code></pre></div><p><img class=lazyload src=/svg/loading.min.svg data-src=/img/postimages/%e5%85%b3%e9%97%ad%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp data-srcset="/img/postimages/%e5%85%b3%e9%97%ad%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp, /img/postimages/%e5%85%b3%e9%97%ad%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp 1.5x, /img/postimages/%e5%85%b3%e9%97%ad%e6%b7%b7%e6%9d%82%e6%a8%a1%e5%bc%8f.webp 2x" data-sizes=auto alt=/img/postimages/关闭混杂模式.webp title=关闭混杂模式></p><h2 id=拓展>拓展</h2><p>使用tcpdump工具抓包时，抓包的网口会临时变成混杂模式。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@nginx140 ~<span style=color:#f92672>]</span><span style=color:#75715e># tcpdump -i ens33 -vv -nn -w ./test.cap </span>
</span></span><span style=display:flex><span>tcpdump: listening on ens33, link-type EN10MB <span style=color:#f92672>(</span>Ethernet<span style=color:#f92672>)</span>, capture size <span style=color:#ae81ff>262144</span> bytes
</span></span><span style=display:flex><span>^C537 packets captured
</span></span><span style=display:flex><span><span style=color:#ae81ff>540</span> packets received by filter
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span> packets dropped by kernel
</span></span></code></pre></div><p>抓包的同时查看对应网卡标志位</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span><span style=color:#f92672>[</span>root@nginx140 ~<span style=color:#f92672>]</span><span style=color:#75715e># cat /sys/class/net/ens33/flags </span>
</span></span><span style=display:flex><span>0x1103
</span></span></code></pre></div><h2 id=总结>总结</h2><p>当网卡的标志位为<code>0x1003</code>时，没有开启混杂模式。而网卡标志位为<code>0x1103</code>时，说明该网卡开启了混杂模式。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-02-14</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/ data-title=linux下混杂模式判断><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/ data-title=linux下混杂模式判断><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/ data-title=linux下混杂模式判断><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=http://example.org/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/ data-title=linux下混杂模式判断><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/redhat6.3yum%E6%BA%90%E5%A4%B1%E6%95%88%E8%A7%A3%E5%86%B3/ class=prev rel=prev title=redhat6.3-yum源失效解决><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>redhat6.3-yum源失效解决</a>
<a href=/posts/%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAip%E5%B9%B6%E5%A4%8D%E5%88%B6%E5%88%B0registry%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD/ class=next rel=next title=使用脚本获取本机IP并复制到registry配置文件中>使用脚本获取本机IP并复制到registry配置文件中<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>