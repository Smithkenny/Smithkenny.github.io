<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>ansible基本环境搭建及升级版本 - My New Hugo Site</title><meta name=Description content="This is my cool site"><meta property="og:title" content="ansible基本环境搭建及升级版本"><meta property="og:description" content="应用场景 Ansible是一个基于Python开发的配置管理和应用部署工具，现在也在自动化管理领域大放异彩。它融合了众多老牌运维工具的优点，Pubbet和Saltstack能实现的功能，Ansible基本上都可以实现。
Ansible能批量配置、部署、管理一大堆的主机。比如以前需要切换到每个主机上执行的一或多个操作，使用Ansible只需在固定的一台Ansible控制节点上去完成所有主机的操作。
ansible主控端搭建 基于docker构建一个ansible镜像 编写Dockerfile FROM debian:10 COPY sources.list /etc/apt/sources.list RUN apt update;apt install -y ansible sshpass vim net-tools procps RUN sed -i 's/^#host_key_checking.*/host_key_checking = False/g' /etc/ansible/ansible.cfg CMD [&#34;/bin/bash&#34;] 说明：基于debain10搭建的基础ansible镜像包。
创建sources.list文件 cat <<EOF > sources.list deb http://mirrors.ustc.edu.cn/debian/ buster main deb-src http://mirrors.ustc.edu.cn/debian/ buster main deb http://mirrors.ustc.edu.cn/debian-security buster/updates main deb-src http://mirrors.ustc.edu.cn/debian-security buster/updates main # buster-updates, previously known as 'volatile' deb http://mirrors.ustc.edu.cn/debian/ buster-updates main deb-src http://mirrors.ustc.edu.cn/debian/ buster-updates main deb http://mirrors.ustc.edu.cn/debian/ buster-backports main non-free contrib deb-src http://mirrors."><meta property="og:type" content="article"><meta property="og:url" content="http://example.org/posts/ansible/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-04-12T10:51:17+00:00"><meta property="article:modified_time" content="2022-04-12T10:51:17+00:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="ansible基本环境搭建及升级版本"><meta name=twitter:description content="应用场景 Ansible是一个基于Python开发的配置管理和应用部署工具，现在也在自动化管理领域大放异彩。它融合了众多老牌运维工具的优点，Pubbet和Saltstack能实现的功能，Ansible基本上都可以实现。
Ansible能批量配置、部署、管理一大堆的主机。比如以前需要切换到每个主机上执行的一或多个操作，使用Ansible只需在固定的一台Ansible控制节点上去完成所有主机的操作。
ansible主控端搭建 基于docker构建一个ansible镜像 编写Dockerfile FROM debian:10 COPY sources.list /etc/apt/sources.list RUN apt update;apt install -y ansible sshpass vim net-tools procps RUN sed -i 's/^#host_key_checking.*/host_key_checking = False/g' /etc/ansible/ansible.cfg CMD [&#34;/bin/bash&#34;] 说明：基于debain10搭建的基础ansible镜像包。
创建sources.list文件 cat <<EOF > sources.list deb http://mirrors.ustc.edu.cn/debian/ buster main deb-src http://mirrors.ustc.edu.cn/debian/ buster main deb http://mirrors.ustc.edu.cn/debian-security buster/updates main deb-src http://mirrors.ustc.edu.cn/debian-security buster/updates main # buster-updates, previously known as 'volatile' deb http://mirrors.ustc.edu.cn/debian/ buster-updates main deb-src http://mirrors.ustc.edu.cn/debian/ buster-updates main deb http://mirrors.ustc.edu.cn/debian/ buster-backports main non-free contrib deb-src http://mirrors."><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/posts/ansible/><link rel=prev href=http://example.org/posts/%E5%9F%BA%E4%BA%8Etcp%E7%9A%84%E7%AE%80%E5%8D%95%E5%A5%97%E6%8E%A5%E5%AD%97%E9%80%9A%E4%BF%A1/><link rel=next href=http://example.org/posts/%E6%A8%A1%E6%8B%9Fssh%E6%89%A7%E8%A1%8C%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"ansible基本环境搭建及升级版本","inLanguage":"en-us","mainEntityOfPage":{"@type":"WebPage","@id":"http:\/\/example.org\/posts\/ansible\/"},"genre":"posts","wordcount":818,"url":"http:\/\/example.org\/posts\/ansible\/","datePublished":"2022-04-12T10:51:17+00:00","dateModified":"2022-04-12T10:51:17+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Author"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>Contents</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ansible基本环境搭建及升级版本</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-04-12>2022-04-12</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;818 words&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;4 minutes&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>Contents</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#应用场景>应用场景</a></li><li><a href=#ansible主控端搭建>ansible主控端搭建</a><ul><li><a href=#基于docker构建一个ansible镜像>基于docker构建一个ansible镜像</a></li><li><a href=#主控端容器创建>主控端容器创建</a></li></ul></li><li><a href=#ansible被控节点搭建>ansible被控节点搭建</a><ul><li><a href=#使用dockerfile创建被控节点镜像>使用Dockerfile创建被控节点镜像</a></li><li><a href=#创建sourceslist文件同主控端>创建sources.list文件(同主控端)</a></li><li><a href=#开始构建-1>开始构建</a></li><li><a href=#创建3个被控端容器>创建3个被控端容器</a></li><li><a href=#分别进入容器并修改root密码>分别进入容器并修改root密码</a></li></ul></li><li><a href=#在控制端添加所有被控端主机信息>在控制端添加所有被控端主机信息</a><ul><li><a href=#一种明文方式不安全>一种明文方式(不安全)</a></li><li><a href=#另一种密文方式推荐>另一种密文方式（推荐）</a></li><li><a href=#最后还可以免密登录>最后还可以免密登录</a></li></ul></li><li><a href=#ansible参数补全功能><strong>Ansible参数补全功能</strong></a></li><li><a href=#ansible升级到特定版本>ansible升级到特定版本</a><ul><li><a href=#卸载>卸载</a></li><li><a href=#安装新版本>安装新版本</a></li><li><a href=#查询>查询</a></li></ul></li><li><a href=#其他>其他</a><ul><li><a href=#关于debain10系统鼠标右键粘连的解决方法>关于<code>debain10系统</code>鼠标右键粘连的解决方法</a></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=应用场景>应用场景</h2><p><code>Ansible</code>是一个基于<code>Python</code>开发的配置管理和应用部署工具，现在也在自动化管理领域大放异彩。它融合了众多老牌运维工具的优点，<code>Pubbet和Saltstack</code>能实现的功能，<code>Ansible</code>基本上都可以实现。</p><p><code>Ansible</code>能批量配置、部署、管理一大堆的主机。比如以前需要切换到每个主机上执行的一或多个操作，使用<code>Ansible</code>只需在固定的一台<code>Ansible</code>控制节点上去完成所有主机的操作。</p><h2 id=ansible主控端搭建>ansible主控端搭建</h2><h3 id=基于docker构建一个ansible镜像>基于docker构建一个ansible镜像</h3><h4 id=编写dockerfile>编写Dockerfile</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>FROM debian:10
</span></span><span style=display:flex><span>COPY sources.list /etc/apt/sources.list
</span></span><span style=display:flex><span>RUN apt update;apt install -y ansible sshpass vim net-tools procps
</span></span><span style=display:flex><span>RUN sed -i <span style=color:#e6db74>&#39;s/^#host_key_checking.*/host_key_checking = False/g&#39;</span> /etc/ansible/ansible.cfg
</span></span><span style=display:flex><span>CMD <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>说明：基于debain10搭建的基础ansible镜像包。</p><h4 id=创建sourceslist文件>创建sources.list文件</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>cat <span style=color:#e6db74>&lt;&lt;EOF &gt; sources.list 
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://mirrors.ustc.edu.cn/debian/ buster main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb-src http://mirrors.ustc.edu.cn/debian/ buster main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://mirrors.ustc.edu.cn/debian-security buster/updates main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb-src http://mirrors.ustc.edu.cn/debian-security buster/updates main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74># buster-updates, previously known as &#39;volatile&#39;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://mirrors.ustc.edu.cn/debian/ buster-updates main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb-src http://mirrors.ustc.edu.cn/debian/ buster-updates main
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb http://mirrors.ustc.edu.cn/debian/ buster-backports main non-free contrib
</span></span></span><span style=display:flex><span><span style=color:#e6db74>deb-src http://mirrors.ustc.edu.cn/debian/ buster-backports main non-free contrib
</span></span></span><span style=display:flex><span><span style=color:#e6db74>EOF</span>
</span></span></code></pre></div><p>注意：<code>sources.list</code>是一个源配置文件，和<code>Dockerfile</code>文件在同一级。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>FROM 意思就是使用哪个基础镜像
</span></span><span style=display:flex><span>COPY 就是复制本地的哪个文件到容器镜像
</span></span><span style=display:flex><span>RUN 就是执行一个Linux命令
</span></span><span style=display:flex><span>CMD 就是设置容器启动的时候需要运行什么程序
</span></span></code></pre></div><h4 id=开始构建>开始构建</h4><p>语法</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> docker build -t <span style=color:#e6db74>${</span>镜像名称:版本<span style=color:#e6db74>}</span> .
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> docker build -t debian10/ansible .
</span></span></code></pre></div><p>当不设置版本的时候，默认会给予latest的一个版本标签。</p><p>注意构建过程中报错信息，根据报错信息更改Dockerfile文件内容。</p><h4 id=验证镜像>验证镜像</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@localhost ~<span style=color:#f92672>]</span><span style=color:#75715e># docker images | grep ansible</span>
</span></span><span style=display:flex><span>debain10/ansible       latest      03216dab3d76        <span style=color:#ae81ff>23</span> minutes ago      349MB
</span></span></code></pre></div><h3 id=主控端容器创建>主控端容器创建</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -it --name ansible-control --privilaged<span style=color:#f92672>=</span>true -d debain10/ansible sh
</span></span></code></pre></div><h4 id=查看容器是否正常启动>查看容器是否正常启动</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker ps 
</span></span><span style=display:flex><span>ccb07fbb3515  debain10/ansible  <span style=color:#e6db74>&#34;sh&#34;</span>  <span style=color:#ae81ff>25</span> minutes ago  Up <span style=color:#ae81ff>25</span> minutes  ansible-control
</span></span></code></pre></div><h4 id=进入容器>进入容器</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker exec -it ansible-control bash
</span></span></code></pre></div><p>查看ansible版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ccb07fbb3515:/etc/ansible# ansible --version 
</span></span><span style=display:flex><span>ansible 2.7.7
</span></span><span style=display:flex><span>  config file <span style=color:#f92672>=</span> /etc/ansible/ansible.cfg
</span></span><span style=display:flex><span>  configured module search path <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#e6db74>&#39;/root/.ansible/plugins/modules&#39;</span>, <span style=color:#e6db74>&#39;/usr/share/ansible/plugins/modules&#39;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  ansible python module location <span style=color:#f92672>=</span> /usr/lib/python3/dist-packages/ansible
</span></span><span style=display:flex><span>  executable location <span style=color:#f92672>=</span> /usr/bin/ansible
</span></span><span style=display:flex><span>  python version <span style=color:#f92672>=</span> 3.7.3 <span style=color:#f92672>(</span>default, Jan <span style=color:#ae81ff>22</span> 2021, 20:04:44<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>GCC 8.3.0<span style=color:#f92672>]</span>
</span></span></code></pre></div><h2 id=ansible被控节点搭建>ansible被控节点搭建</h2><h3 id=使用dockerfile创建被控节点镜像>使用Dockerfile创建被控节点镜像</h3><p>Dockerfile文件内容如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>FROM debian:10
</span></span><span style=display:flex><span>COPY sources.list /etc/apt/sources.list
</span></span><span style=display:flex><span>RUN apt update;apt install -y vim net-tools procps openssh-server python3.7
</span></span><span style=display:flex><span>RUN sed -i <span style=color:#e6db74>&#39;s/^#PermitRootLogin.*/PermitRootLogin yes/g&#39;</span> /etc/ssh/sshd_config;cp /usr/bin/python3.7 /usr/bin/python
</span></span><span style=display:flex><span>CMD <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;/bin/bash&#34;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div><p>这里有一个坑，被控节点中必须安装python，ansible默认会去<code>/usr/bin</code>内找python执行文件。如果没有就会报错。这里安装镜像时就默认安装了<code>python3.7</code>。并将执行文件复制为<code>/usr/bin/python</code>。</p><p>当然<code>openssh-server</code>是必备的，<code>ansible</code>就是基于ssh服务控制服务器的。</p><h3 id=创建sourceslist文件同主控端>创建sources.list文件(同主控端)</h3><h3 id=开始构建-1>开始构建</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> docker build -t debian10/ansible-node .
</span></span></code></pre></div><h3 id=创建3个被控端容器>创建3个被控端容器</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>docker run -it --name ansible-node1 --privilaged<span style=color:#f92672>=</span>true -d debain10/ansible init
</span></span><span style=display:flex><span>docker run -it --name ansible-node2 --privilaged<span style=color:#f92672>=</span>true -d debain10/ansible init
</span></span><span style=display:flex><span>docker run -it --name ansible-node3 --privilaged<span style=color:#f92672>=</span>true -d debain10/ansible init
</span></span></code></pre></div><h3 id=分别进入容器并修改root密码>分别进入容器并修改root密码</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#密码统一修改为123456</span>
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;123456&#34;</span> | passwd --stdin root <span style=color:#75715e>#debain10试了下不生效</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#使用以下命令更改</span>
</span></span><span style=display:flex><span>passwd root
</span></span><span style=display:flex><span><span style=color:#ae81ff>123456</span>
</span></span></code></pre></div><p>最后可以看到一个主控端和3个被控端容器。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>e8e005edfab9        debain/ansible-node                    <span style=color:#e6db74>&#34;init&#34;</span>                   About an hour ago   Up About an hour                             ansible-node3
</span></span><span style=display:flex><span>cd03436b2424        debain/ansible-node                    <span style=color:#e6db74>&#34;init&#34;</span>                   About an hour ago   Up About an hour                             ansible-node2
</span></span><span style=display:flex><span>88bf589578f5        debain/ansible-node                    <span style=color:#e6db74>&#34;init&#34;</span>                   About an hour ago   Up About an hour                             ansible-node1
</span></span><span style=display:flex><span>ccb07fbb3515        debain10/ansible                       <span style=color:#e6db74>&#34;sh&#34;</span>                     About an hour ago   Up About an hour                             ansible-control
</span></span></code></pre></div><h2 id=在控制端添加所有被控端主机信息>在控制端添加所有被控端主机信息</h2><p>有两种方法</p><h3 id=一种明文方式不安全>一种明文方式(不安全)</h3><p>在/etc/ansible/hosts文件添加下面的内容（覆盖）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>node1 ansible_ssh_host<span style=color:#f92672>=</span>172.18.0.5 ansible_ssh_port<span style=color:#f92672>=</span><span style=color:#ae81ff>22</span> ansible_ssh_pass<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>node2 ansible_ssh_host<span style=color:#f92672>=</span>172.18.0.6 ansible_ssh_port<span style=color:#f92672>=</span><span style=color:#ae81ff>22</span> ansible_ssh_pass<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>node3 ansible_ssh_host<span style=color:#f92672>=</span>172.18.0.7 ansible_ssh_port<span style=color:#f92672>=</span><span style=color:#ae81ff>22</span> ansible_ssh_pass<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>hello<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>node1
</span></span><span style=display:flex><span>node2
</span></span><span style=display:flex><span>node3
</span></span></code></pre></div><h3 id=另一种密文方式推荐>另一种密文方式（推荐）</h3><h4 id=使用openssl生成随机密码>使用openssl生成随机密码</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl rand -out vault_password_file -base64 <span style=color:#ae81ff>128</span> 
</span></span><span style=display:flex><span><span style=color:#75715e>#cat vault_password_file</span>
</span></span><span style=display:flex><span>eBqrIFYQ7XDJKjTywZwc26KElu1NQwwx5su3pzj21c4H33RQUV4kslL+UHVEJzxN
</span></span><span style=display:flex><span>sYIEbklwL7la+sugcSoK5PutqZ79bXnvT7FkEk2pMFNUO4W13/R3pH1AFAddAvsC
</span></span><span style=display:flex><span>h+YG1mxTCUsNbCwgtngCkAe9cBcLbkbLMVxjQ+dZym4<span style=color:#f92672>=</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#最小化权限并上锁。</span>
</span></span><span style=display:flex><span>chmod a-w vault_password_file
</span></span><span style=display:flex><span>chattr +i vault_password_file
</span></span></code></pre></div><p>删除文件前先解锁</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chattr -i vault_password_file
</span></span></code></pre></div><p>关于openssl补充：</p><p>openssl生成随机数</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>openssl rand <span style=color:#f92672>[</span>-out file<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-rand file<span style=color:#f92672>(</span>s<span style=color:#f92672>)]</span> <span style=color:#f92672>[</span>-base64<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>-hex<span style=color:#f92672>]</span> num
</span></span><span style=display:flex><span>常用选项有：
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-out file：将生成的随机数保存至指定文件中
</span></span><span style=display:flex><span>-base64：使用base64 编码格式
</span></span><span style=display:flex><span>-hex：使用16进制编码格式
</span></span></code></pre></div><h4 id=使用ansible-vault生成加密后的字符串>使用<code>ansible-vault</code>生成加密后的字符串</h4><pre tabindex=0><code>root@ccb07fbb3515:~# ansible-vault encrypt_string &#34;123456&#34; -name ansible_ssh_pass 
The number of --name options do not match the number of args.
The last named variable will be &#34;ame&#34;. The rest will not have names.
# The encrypted version of variable (&#34;ame&#34;, the string #1 from the command line args).
ame: !vault |
         $ANSIBLE_VAULT;1.1;AES256
         35643865643061373962376261653765333233333839353937643134643437396262646338363965
		 3366666561653365663164386536363963353961313362350a626662366361303434383665306531
		 34386161363965363634626663343832363664623139336665313131623732343437633439386264
		 6534663962663337640a363166383137613835383966396431326165663732646337653235646239
		 3534
# The encrypted version of the string #2 from the command line args.)
!vault |
         $ANSIBLE_VAULT;1.1;AES256
         34306239353764383165316133636366633131366332326362323830613638633263353638656562
	     3736396133633063623863623739326132383062373533300a613036646534353033363134383532          66333366633537643737333065313866396137663965393530653262616132633236663561336164
	     3633393361616162340a343931653762613765366339356632366135326464336532313562643432
	     38386533653231626365303837653831346263646464633430643765396239366334
Encryption successful
</code></pre><p>最后修改主机文件<code>/etc/ansible/hosts</code>配置(使用yaml风格)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>all</span>: 
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>node1</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.5</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_pass</span>: !<span style=color:#ae81ff>vault |</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>$ANSIBLE_VAULT;1.1;AES256</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>35643865643061373962376261653765333233333839353937643134643437396262646338363965</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>3366666561653365663164386536363963353961313362350a626662366361303434383665306531</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>34386161363965363634626663343832363664623139336665313131623732343437633439386264</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>6534663962663337640a363166383137613835383966396431326165663732646337653235646239</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>3534</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>node2</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.6</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_pass</span>: !<span style=color:#ae81ff>vault |</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>$ANSIBLE_VAULT;1.1;AES256</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>35643865643061373962376261653765333233333839353937643134643437396262646338363965</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>3366666561653365663164386536363963353961313362350a626662366361303434383665306531</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>34386161363965363634626663343832363664623139336665313131623732343437633439386264</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>6534663962663337640a363166383137613835383966396431326165663732646337653235646239</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>3534</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>node3</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.7</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_pass</span>: !<span style=color:#ae81ff>vault |</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>$ANSIBLE_VAULT;1.1;AES256</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>35643865643061373962376261653765333233333839353937643134643437396262646338363965</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>3366666561653365663164386536363963353961313362350a626662366361303434383665306531</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>34386161363965363634626663343832363664623139336665313131623732343437633439386264</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>6534663962663337640a363166383137613835383966396431326165663732646337653235646239</span>
</span></span><span style=display:flex><span>         <span style=color:#ae81ff>3534</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>yaml格式参考<a href=https://docs.ansible.com/ansible-core/devel/reference_appendices/YAMLSyntax.html target=_blank rel="noopener noreffer">官网</a></p><p>这里的ssh端口还有另一种写法</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible_port: <span style=color:#ae81ff>22</span>
</span></span></code></pre></div><h4 id=测试>测试</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ccb07fbb3515:/etc/ansible# ansible all -m ping
</span></span><span style=display:flex><span>node1 | SUCCESS <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;changed&#34;</span>: false,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ping&#34;</span>: <span style=color:#e6db74>&#34;pong&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>node3 | SUCCESS <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;changed&#34;</span>: false,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ping&#34;</span>: <span style=color:#e6db74>&#34;pong&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>node2 | SUCCESS <span style=color:#f92672>=</span>&gt; <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;changed&#34;</span>: false,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;ping&#34;</span>: <span style=color:#e6db74>&#34;pong&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>重启其中一个主机的服务</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>root@ccb07fbb3515:/etc/ansible# ansible node1 -m command -a <span style=color:#e6db74>&#34;systemctl restart cron&#34;</span>
</span></span><span style=display:flex><span>node1 | CHANGED | rc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> &gt;&gt;
</span></span></code></pre></div><p>查看所有主机的内核版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible all -m command -a <span style=color:#e6db74>&#34;uname -a&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>node1 | CHANGED | rc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> &gt;&gt;
</span></span><span style=display:flex><span>Linux cd03436b2424 4.18.0-147.5.1.el8_1.x86_64 <span style=color:#75715e>#1 SMP Wed Feb 5 02:00:39 UTC 2020 x86_64 GNU/Linux</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>node2 | CHANGED | rc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> &gt;&gt;
</span></span><span style=display:flex><span>Linux e8e005edfab9 4.18.0-147.5.1.el8_1.x86_64 <span style=color:#75715e>#1 SMP Wed Feb 5 02:00:39 UTC 2020 x86_64 GNU/Linux</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>node3 | CHANGED | rc<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> &gt;&gt;
</span></span><span style=display:flex><span>Linux 88bf589578f5 4.18.0-147.5.1.el8_1.x86_64 <span style=color:#75715e>#1 SMP Wed Feb 5 02:00:39 UTC 2020 x86_64 GNU/Linux</span>
</span></span></code></pre></div><h3 id=最后还可以免密登录>最后还可以免密登录</h3><p>主控端使用ssh-keygen生成公钥和私钥，通过sshpass传递到被控端。输入被控端用户名和密码。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>read -p <span style=color:#e6db74>&#39;input user: &#39;</span> USER
</span></span><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span>$USER<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>read -s -p <span style=color:#e6db74>&#39;input pass: &#39;</span> PASS
</span></span><span style=display:flex><span>rm -f /root/.ssh/id_rsa
</span></span><span style=display:flex><span><span style=color:#f92672>(</span>ssh-keygen -P <span style=color:#e6db74>&#34;&#34;</span> -f /root/.ssh/id_rsa<span style=color:#f92672>)</span> &amp;&gt;/dev/null
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>for</span> i in <span style=color:#f92672>{</span>5..7<span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>do</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    IP_host<span style=color:#f92672>=</span>172.18.0.<span style=color:#e6db74>${</span>i<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span>    ping  -c <span style=color:#ae81ff>1</span> -w <span style=color:#ae81ff>1</span> <span style=color:#e6db74>${</span>IP_host<span style=color:#e6db74>}</span> &amp;&gt;/dev/null
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $? -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>;<span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>(</span>sshpass -p <span style=color:#e6db74>${</span>PASS<span style=color:#e6db74>}</span> ssh-copy-id -o StrictHostKeyChecking<span style=color:#f92672>=</span>no <span style=color:#e6db74>${</span>IP_host<span style=color:#e6db74>}</span><span style=color:#f92672>)</span> &amp;&gt;/dev/null
</span></span><span style=display:flex><span>        echo -e <span style=color:#e6db74>&#34;\e[1;32m </span><span style=color:#e6db74>${</span>IP_host<span style=color:#e6db74>}</span><span style=color:#e6db74>    ok \e[0m&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>done</span>
</span></span></code></pre></div><p>然后ansible的配置文件hosts里可以不写密码了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>web</span>: <span style=color:#75715e>#组名1</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>node1</span>: <span style=color:#75715e>#被控主机1</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.5</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>node2</span>: <span style=color:#75715e>#被控主机2</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.6</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span><span style=color:#f92672>apache</span>: <span style=color:#75715e>#组名2</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>hosts</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>node3</span>: <span style=color:#75715e>#被控主机3</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.7</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>node4</span>: <span style=color:#75715e>#被控主机4</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_host</span>: <span style=color:#ae81ff>172.18.0.8</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>ansible_ssh_port</span>: <span style=color:#ae81ff>22</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h2 id=ansible参数补全功能><strong>Ansible参数补全功能</strong></h2><p>从Ansible 2.9版本开始，ansible支持命令的选项补全功能，它依赖于python的argcomplete插件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptitude install python-argcomplete -y <span style=color:#75715e>#安装</span>
</span></span><span style=display:flex><span>activate-global-python-argcomplete   <span style=color:#75715e>#激活</span>
</span></span></code></pre></div><p>激活后，就可以按两次tab补全命令和选项了。</p><h2 id=ansible升级到特定版本>ansible升级到特定版本</h2><h3 id=卸载>卸载</h3><p>查看当前版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible --version
</span></span><span style=display:flex><span>ansible 2.7.7
</span></span></code></pre></div><p>安装debain包管理器<code>aptitude</code>,它可以自动解决包依赖问题。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt install aptitude -y
</span></span></code></pre></div><p>卸载旧版本的ansible</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptitude remove ansible*
</span></span></code></pre></div><p>查看ansible依赖包是否没卸载干净</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>apt list | grep ansible*
</span></span></code></pre></div><h3 id=安装新版本>安装新版本</h3><p>debain 系统下ansible所有版本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>https://packages.debian.org/buster-backports/all/ansible/download
</span></span></code></pre></div><p>本次下载2.9.16版本的安装包进行升级</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>wget http://ftp.cn.debian.org/debian/pool/main/a/ansible/ansible_2.9.16+dfsg-1~bpo10+2_all.deb
</span></span></code></pre></div><p>安装</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptitude install ansible_2.9.16+dfsg-1~bpo10+2_all.deb
</span></span></code></pre></div><p>最新版支持<code>python3</code>，可以下载。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>aptitude install python3
</span></span></code></pre></div><h3 id=查询>查询</h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ansible --version 
</span></span><span style=display:flex><span>ansible 2.9.16
</span></span><span style=display:flex><span>  config file <span style=color:#f92672>=</span> /etc/ansible/ansible.cfg
</span></span><span style=display:flex><span>  configured module search path <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#e6db74>&#39;/root/.ansible/plugins/modules&#39;</span>, <span style=color:#e6db74>&#39;/usr/share/ansible/plugins/modules&#39;</span><span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  ansible python module location <span style=color:#f92672>=</span> /usr/lib/python3/dist-packages/ansible
</span></span><span style=display:flex><span>  executable location <span style=color:#f92672>=</span> /usr/bin/ansible
</span></span><span style=display:flex><span>  python version <span style=color:#f92672>=</span> 3.7.3 <span style=color:#f92672>(</span>default, Jan <span style=color:#ae81ff>22</span> 2021, 20:04:44<span style=color:#f92672>)</span> <span style=color:#f92672>[</span>GCC 8.3.0<span style=color:#f92672>]</span>
</span></span></code></pre></div><h2 id=其他>其他</h2><h3 id=关于debain10系统鼠标右键粘连的解决方法>关于<code>debain10系统</code>鼠标右键粘连的解决方法</h3><p>编辑<code> vim</code> 的默认配置文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>vi /usr/share/vim/vim81/defaults.vim
</span></span><span style=display:flex><span><span style=color:#75715e>#第79行</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> has<span style=color:#f92672>(</span><span style=color:#e6db74>&#39;mouse&#39;</span><span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>set mouse<span style=color:#f92672>=</span>a
</span></span><span style=display:flex><span>endif
</span></span><span style=display:flex><span><span style=color:#75715e>#set mouse=a 改为set mouse-=a</span>
</span></span><span style=display:flex><span>保存退出
</span></span></code></pre></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>Updated on 2022-04-12</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Share on Twitter" data-sharer=twitter data-url=http://example.org/posts/ansible/ data-title=ansible基本环境搭建及升级版本><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Facebook" data-sharer=facebook data-url=http://example.org/posts/ansible/><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Hacker News" data-sharer=hackernews data-url=http://example.org/posts/ansible/ data-title=ansible基本环境搭建及升级版本><i class="fab fa-hacker-news fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="Share on Line" data-sharer=line data-url=http://example.org/posts/ansible/ data-title=ansible基本环境搭建及升级版本><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/line.svg aria-hidden=true></i></a><a href=javascript:void(0); title="Share on 微博" data-sharer=weibo data-url=http://example.org/posts/ansible/ data-title=ansible基本环境搭建及升级版本><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Back</a></span>&nbsp;|&nbsp;<span><a href=/>Home</a></span></section></div><div class=post-nav><a href=/posts/%E5%9F%BA%E4%BA%8Etcp%E7%9A%84%E7%AE%80%E5%8D%95%E5%A5%97%E6%8E%A5%E5%AD%97%E9%80%9A%E4%BF%A1/ class=prev rel=prev title=基于tcp的简单套接字通信><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>基于tcp的简单套接字通信</a>
<a href=/posts/%E6%A8%A1%E6%8B%9Fssh%E6%89%A7%E8%A1%8C%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4/ class=next rel=next title=模拟ssh执行远程命令>模拟ssh执行远程命令<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},comment:{}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>