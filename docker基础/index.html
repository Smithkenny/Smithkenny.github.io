<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>docker基础 - Peng</title><meta name=Description content="One World,One Dream!"><meta property="og:title" content="docker基础"><meta property="og:description" content="安装及命令 Docker命令 常用 1 2 3 4 5 6 7 8 9 10 11 docker version docker info docker pull docker login docker logout docker images docker ps -a docker start|stop|restart docker rm xxxx docker rmi xxxx docker exec -it `name OR id` /bin/bash 批量停止删除容器和镜像 停止所"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.haipengv.com/docker%E5%9F%BA%E7%A1%80/"><meta property="og:image" content="https://blog.haipengv.com/logo.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-02-24T20:51:17+00:00"><meta property="article:modified_time" content="2022-02-24T20:51:17+00:00"><meta property="og:site_name" content="我的网站"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.haipengv.com/logo.webp"><meta name=twitter:title content="docker基础"><meta name=twitter:description content="安装及命令 Docker命令 常用 1 2 3 4 5 6 7 8 9 10 11 docker version docker info docker pull docker login docker logout docker images docker ps -a docker start|stop|restart docker rm xxxx docker rmi xxxx docker exec -it `name OR id` /bin/bash 批量停止删除容器和镜像 停止所"><meta name=application-name content="我的网站"><meta name=apple-mobile-web-app-title content="我的网站"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.haipengv.com/docker%E5%9F%BA%E7%A1%80/><link rel=prev href=https://blog.haipengv.com/harbor%E4%BD%BF%E7%94%A8%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6%E5%AE%9E%E7%8E%B0https%E7%99%BB%E5%BD%95/><link rel=next href=https://blog.haipengv.com/jupyter%E6%9B%B4%E6%94%B9%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"docker基础","inLanguage":"zh-cn","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.haipengv.com\/docker%E5%9F%BA%E7%A1%80\/"},"genre":"posts","keywords":"docker","wordcount":3197,"url":"https:\/\/blog.haipengv.com\/docker%E5%9F%BA%E7%A1%80\/","datePublished":"2022-02-24T20:51:17+00:00","dateModified":"2022-02-24T20:51:17+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Peng"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Peng>Peng</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friends/><i class='fas fa-fw fa-fan fa-spin'></i> 友链 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Peng>Peng</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friends/ title><i class='fas fa-fw fa-fan fa-spin'></i>友链</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">docker基础</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Peng</a>
</span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E5%B7%A5%E5%85%B7/><i class="far fa-folder fa-fw" aria-hidden=true></i>工具</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-02-24>2022-02-24</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 3197 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 7 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#安装及命令>安装及命令</a><ul><li><a href=#docker命令>Docker命令</a><ul><li><a href=#常用>常用</a></li><li><a href=#批量停止删除容器和镜像>批量停止删除容器和镜像</a></li><li><a href=#docker目录拷贝>Docker目录拷贝</a></li><li><a href=#docker-文件拷贝>Docker 文件拷贝</a></li><li><a href=#docker命令补全>Docker命令补全</a></li></ul></li><li><a href=#docker镜像>Docker镜像</a><ul><li><a href=#容器创建镜像>容器创建镜像</a></li></ul></li><li><a href=#导入导出镜像>导入导出镜像</a></li><li><a href=#docker-hub>Docker hub</a><ul><li><a href=#上传本地镜像>上传本地镜像</a></li><li><a href=#自动构建镜像>自动构建镜像</a></li></ul></li><li><a href=#docker安装>Docker安装</a><ul><li><a href=#docker官方脚本安装>Docker官方脚本安装</a></li><li><a href=#docker官方手动升级>Docker官方手动升级</a></li></ul></li><li><a href=#docker启动命令>Docker启动命令</a></li><li><a href=#docker-compose-安装>Docker-compose 安装</a><ul><li><a href=#官方安装>官方安装</a></li><li><a href=#手动安装>手动安装</a></li><li><a href=#pip在线安装>pip在线安装</a></li></ul></li><li><a href=#docker配置镜像加速及私有仓库>Docker配置镜像加速及私有仓库</a></li><li><a href=#配置镜像加速>配置镜像加速</a></li><li><a href=#私有镜像加速>私有镜像加速</a></li><li><a href=#配置私有仓库>配置私有仓库</a></li></ul></li><li><a href=#docker迁移varlibdocker目录>Docker迁移/var/lib/docker目录</a><ul><li><a href=#前言>前言</a><ul><li><a href=#迁移流程>迁移流程</a></li><li><a href=#迁移目录>迁移目录</a></li><li><a href=#检查>检查</a></li><li><a href=#完成>完成</a></li></ul></li><li><a href=#docker-私有镜像仓库>Docker 私有镜像仓库</a><ul><li><a href=#安装服务端>安装服务端</a></li></ul></li><li><a href=#配置客户端>配置客户端</a></li><li><a href=#使用>使用</a><ul><li><a href=#登录>登录</a></li><li><a href=#登出>登出</a></li><li><a href=#push>Push</a></li><li><a href=#pull>Pull</a></li><li><a href=#查看镜像仓库清单>查看镜像仓库清单</a></li><li><a href=#查看镜像-tag-清单>查看镜像 tag 清单</a></li><li><a href=#删除镜像>删除镜像</a><ul><li><a href=#获取镜像-digest-hash>获取镜像 digest hash</a></li><li><a href=#删除镜像清单>删除镜像清单</a></li><li><a href=#清理磁盘空间>清理磁盘空间</a></li><li><a href=#手动删除目录>手动删除目录</a></li></ul></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h2 id=安装及命令>安装及命令</h2><h3 id=docker命令>Docker命令</h3><h4 id=常用>常用</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker version  
</span></span><span class=line><span class=cl>docker info  
</span></span><span class=line><span class=cl>docker pull  
</span></span><span class=line><span class=cl>docker login  
</span></span><span class=line><span class=cl>docker <span class=nb>logout</span>  
</span></span><span class=line><span class=cl>docker images  
</span></span><span class=line><span class=cl>docker ps -a  
</span></span><span class=line><span class=cl>docker start<span class=p>|</span>stop<span class=p>|</span>restart  
</span></span><span class=line><span class=cl>docker rm xxxx  
</span></span><span class=line><span class=cl>docker rmi xxxx  
</span></span><span class=line><span class=cl>docker <span class=nb>exec</span> -it <span class=sb>`</span>name OR id<span class=sb>`</span> /bin/bash
</span></span></code></pre></td></tr></table></div></div><h4 id=批量停止删除容器和镜像>批量停止删除容器和镜像</h4><p>停止所有容器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker stop <span class=k>$(</span>docker ps -aq<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><p>删除所有的容器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker rm <span class=k>$(</span>docker ps -aq<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><p>删除所有的镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker rmi <span class=k>$(</span>docker images -q<span class=k>)</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=docker目录拷贝>Docker目录拷贝</h4><p>本机<code>/root/test</code>目录拷贝到容器内<code>/root</code>目录内</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker cp /root/test 28a186bbebd4:/root/
</span></span></code></pre></td></tr></table></div></div><p>本机<code>/root/test</code>目录拷贝到容器内,并更名为<code>/test123</code>.注意命令后没有<code>/</code>.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker cp /root/test 28a186bbebd4:/test123
</span></span></code></pre></td></tr></table></div></div><p>将容器内的<code>/test</code>目录拷贝到主机的<code>/root</code>目录内.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker cp  28a186bbebd4:/test /root/
</span></span></code></pre></td></tr></table></div></div><h4 id=docker-文件拷贝>Docker 文件拷贝</h4><p>本机<code>1.db</code>文件拷贝到容器内<code>root</code>目录内.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker cp 1.db 28a186bbebd4:/root/
</span></span></code></pre></td></tr></table></div></div><p>将容器内的<code>/root/1.db</code>文件拷贝到主机的当前目录.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker cp 28a186bbebd4:/root/1.db .
</span></span></code></pre></td></tr></table></div></div><h4 id=docker命令补全>Docker命令补全</h4><p>安装 bash-completion</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo yum install -y bash-completion
</span></span></code></pre></td></tr></table></div></div><p>根据官方文档进一步配置</p><p><a href=https://gdevillele.github.io/compose/completion/ target=_blank rel="noopener noreffer">官网链接</a></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -L https://raw.githubusercontent.com/docker/compose/<span class=k>$(</span>docker-compose version --short<span class=k>)</span>/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose
</span></span></code></pre></td></tr></table></div></div><p>重新进入终端即可补全命令。</p><h3 id=docker镜像>Docker镜像</h3><h4 id=容器创建镜像>容器创建镜像</h4><p>通过容器提交生成镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker commit 容器名 镜像名
</span></span></code></pre></td></tr></table></div></div><p>保存镜像到文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker save 镜像名 &gt; 文件名.tar 
</span></span></code></pre></td></tr></table></div></div><p>从文件恢复到镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker load &lt; 文件名.tar
</span></span></code></pre></td></tr></table></div></div><p>通过镜像启动新容器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run --name 容器名 相关参数 最后接新的镜像名
</span></span></code></pre></td></tr></table></div></div><p>例如</p><p>赋予容器所有权限</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -it --name <span class=nb>test</span> -d --privileged<span class=o>=</span><span class=nb>true</span> centos:7.6.1810 /usr/sbin/init 
</span></span></code></pre></td></tr></table></div></div><p>容器暴露端口给外面访问,容器内20、80，容器外2000、8080</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -it --name <span class=nb>test</span> -p 2000:20 -p 8080:80 -d centos:7.6.1810 /usr/sbin/init
</span></span></code></pre></td></tr></table></div></div><p>容器不间断运行，docker重启容器会自动重启不用人工干预。</p><p>做数据持久化存储。本地目录容器目录映射。容器内端口5000 容器外端口5000。</p><p>容器内目录：/var/lib/registry</p><p>容器外目录：/opt/registry</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -it --name registry -v /opt/registry:/var/lib/registry -p 5000:5000 --restart<span class=o>=</span>always registry
</span></span></code></pre></td></tr></table></div></div><p>退出容器后立即销毁</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run -it --rm --name test2 alpine sh
</span></span></code></pre></td></tr></table></div></div><p>进入容器</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker <span class=nb>exec</span> -it 容器名/容器id /bin/bash 
</span></span></code></pre></td></tr></table></div></div><h3 id=导入导出镜像>导入导出镜像</h3><p>导出镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker images
</span></span><span class=line><span class=cl><span class=c1># 查看IMAGE ID</span>
</span></span><span class=line><span class=cl>docker save bb2b73d4a4a6 &gt; xxx.tar
</span></span></code></pre></td></tr></table></div></div><p>导入镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker load &lt; xxx.tar
</span></span></code></pre></td></tr></table></div></div><p>修改镜像名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker tag bb2b73d4a4a6 xxx/xxx:latest
</span></span></code></pre></td></tr></table></div></div><h3 id=docker-hub>Docker hub</h3><h4 id=上传本地镜像>上传本地镜像</h4><p>登录</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker login -u 用户名 ip/域名 -p 密码
</span></span></code></pre></td></tr></table></div></div><p>上传镜像前打标签</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker tag SOURCE_IMAGE<span class=o>[</span>:TAG<span class=o>]</span> harbor.lhp.com/images/IMAGE<span class=o>[</span>:TAG<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>上传镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker push harbor.lhp.com/images/IMAGE<span class=o>[</span>:TAG<span class=o>]</span>
</span></span></code></pre></td></tr></table></div></div><p>下载镜像</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker pull harbor.lhp.com/images/alpine:latest
</span></span></code></pre></td></tr></table></div></div><p>登录成功信息查看</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>cat /root/.docker/config.json
</span></span><span class=line><span class=cl>auth后面字段可以用base64进行解码
</span></span><span class=line><span class=cl><span class=c1>#加密</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> test<span class=p>|</span>base64
</span></span><span class=line><span class=cl><span class=nv>dGVzdAo</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=c1>#解密</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;YWRtaW46SGFyYm9yMTIzNDU=&#34;</span> <span class=p>|</span> base64 -d
</span></span></code></pre></td></tr></table></div></div><h4 id=自动构建镜像>自动构建镜像</h4><p>Docker hub创建仓库</p><ul><li>链接 GitHub</li><li>配置 Build Rules</li></ul><table><thead><tr><th><strong>Source Type</strong></th><th><strong>Source</strong></th><th><strong>Docker Tag</strong></th><th><strong>Dockerfile location</strong></th></tr></thead><tbody><tr><td>Branch</td><td>Master</td><td>Latest</td><td>/</td></tr><tr><td>Tag</td><td>/^v([0-9.]+)$/</td><td>{\1}</td><td>/</td></tr></tbody></table><p>Tag</p><p>Github Tag</p><ul><li><code>/^v([0-9.]+)$/</code> 对应 v1.0 或 v1.0.0</li><li><code>/^([0-9.]+)$/</code> 对应 1.0 或 1.0.0</li><li><code>/^([0-9]+)$/</code> 对应 20210101</li></ul><p>Docker Tag</p><ul><li><code>{sourceref}</code> 对应 Github Tag</li><li><code>{\1}</code> 对应 Github Tag 去除 v</li></ul><p>Github push</p><ul><li>正常 commit 并 push 到 GitHub</li><li>Docker Hub 自动构建 master 分支为 latest 镜像</li><li>本地 tag commit 并 push tag</li><li>Docker Hub 自动构建 tag 标签为 tag名 镜像</li></ul><p>创建标签</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git log
</span></span><span class=line><span class=cl><span class=c1># 复制 commit ID</span>
</span></span><span class=line><span class=cl>git tag -a v1.0.0 commitID -m <span class=s2>&#34;v1.0.0&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 本地 tag 版本号标签</span>
</span></span><span class=line><span class=cl>git push origin v1.0.0 
</span></span><span class=line><span class=cl><span class=c1># 提交本地标签到 GitHub</span>
</span></span></code></pre></td></tr></table></div></div><p>删除标签</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>git tag -d 标签名
</span></span><span class=line><span class=cl>git push origin :refs/tags/标签名
</span></span></code></pre></td></tr></table></div></div><h3 id=docker安装>Docker安装</h3><h4 id=docker官方脚本安装>Docker官方脚本安装</h4><p>下载一键安装脚本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -fsSL https://get.docker.com -o get-docker.sh
</span></span></code></pre></td></tr></table></div></div><p>运行一键安装脚本(阿里云加速镜像)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo sh get-docker.sh --mirror Aliyun
</span></span></code></pre></td></tr></table></div></div><h4 id=docker官方手动升级>Docker官方手动升级</h4><p>升级yum</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>yum update
</span></span></code></pre></td></tr></table></div></div><p>安装依赖包</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo yum install -y yum-utils <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  device-mapper-persistent-data <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>  lvm2
</span></span></code></pre></td></tr></table></div></div><p>配置仓库(国内用户推荐使用下面阿里云加速镜像)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo yum-config-manager <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --add-repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    https://download.docker.com/linux/centos/docker-ce.repo
</span></span></code></pre></td></tr></table></div></div><p>配置仓库(阿里云加速镜像)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo yum-config-manager <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --add-repo <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
</span></span></code></pre></td></tr></table></div></div><p>排序查看仓库内文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>yum list docker-ce --showduplicates <span class=p>|</span> sort -r
</span></span></code></pre></td></tr></table></div></div><p>安装最新版Docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo yum install docker-ce docker-ce-cli containerd.io
</span></span></code></pre></td></tr></table></div></div><h3 id=docker启动命令>Docker启动命令</h3><p>启动Docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl start docker
</span></span><span class=line><span class=cl>或
</span></span><span class=line><span class=cl>sudo /etc/init.d/docker restart
</span></span></code></pre></td></tr></table></div></div><p>查看Docker版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo docker version
</span></span></code></pre></td></tr></table></div></div><p>设置Docker开机自动启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl <span class=nb>enable</span> docker
</span></span></code></pre></td></tr></table></div></div><h3 id=docker-compose-安装>Docker-compose 安装</h3><ol><li>官方安装 - 速度慢,有可能被DNS污染导致失败.</li><li>手动安装 - 手动下载,离线安装.</li><li>PIP 在线安装 - 使用 Python 的 pip 包管理工具在线安装.</li></ol><h4 id=官方安装>官方安装</h4><p>官网选择版本 <a href=https://github.com/docker/compose/releases target=_blank rel="noopener noreffer">https://github.com/docker/compose/releases</a>
<strong>以下命令手动修改版本号,例如<code>v2.2.3</code></strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -L https://github.com/docker/compose/releases/download/v2.2.3/docker-compose-<span class=sb>`</span>uname -s<span class=sb>`</span>-<span class=sb>`</span>uname -m<span class=sb>`</span> -o /usr/local/bin/docker-compose
</span></span></code></pre></td></tr></table></div></div><p>执行权限</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></td></tr></table></div></div><p>检查 docker compose 版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker-compose version
</span></span></code></pre></td></tr></table></div></div><h4 id=手动安装>手动安装</h4><p>官网选择版本 <a href=https://github.com/docker/compose/releases target=_blank rel="noopener noreffer">https://github.com/docker/compose/releases</a>
选择相应版本,下载到本地或者服务器中.
更名为<code>docker-compose</code>,并移动到<code>/usr/local/bin</code>目录下.</p><p>添加执行权限</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>chmod +x /usr/local/bin/docker-compose
</span></span></code></pre></td></tr></table></div></div><p>检查 docker compose 版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker-compose version
</span></span></code></pre></td></tr></table></div></div><h4 id=pip在线安装>pip在线安装</h4><p>安装依赖</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>yum -y install epel-release
</span></span></code></pre></td></tr></table></div></div><p>安装 PIP</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>yum -y install python-pip
</span></span></code></pre></td></tr></table></div></div><p>升级 PIP</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pip install --upgrade pip
</span></span></code></pre></td></tr></table></div></div><p>升级报错</p><p>You are using pip version 8.1.2, however version 22.0.3 is available</p><p>解决</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl https://bootstrap.pypa.io/pip/2.7/get-pip.py &gt;&gt; get-pip.py
</span></span><span class=line><span class=cl>python get-pip.py
</span></span></code></pre></td></tr></table></div></div><p>3.6版本的get-pip.py</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl https://bootstrap.pypa.io/get-pip.py &gt;&gt; get-pip.py
</span></span><span class=line><span class=cl>python get-pip.py
</span></span></code></pre></td></tr></table></div></div><p>检查 PIP 版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pip --version
</span></span><span class=line><span class=cl>pip 21.3.1 from /usr/local/lib/python3.6/site-packages/pip <span class=o>(</span>python 3.6<span class=o>)</span>
</span></span></code></pre></td></tr></table></div></div><p>安装 docker compose。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pip install -U docker-compose
</span></span></code></pre></td></tr></table></div></div><p>检查 docker compose 版本</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker-compose version
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>docker-compose version 1.29.2, build unknown
</span></span><span class=line><span class=cl>docker-py version: 5.0.3
</span></span><span class=line><span class=cl>CPython version: 3.6.8
</span></span><span class=line><span class=cl>OpenSSL version: OpenSSL 1.0.2k-fips  <span class=m>26</span> Jan <span class=m>2017</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=docker配置镜像加速及私有仓库>Docker配置镜像加速及私有仓库</h3><p>配置保存命令</p><p>配置<code>daemon.json</code>需要重载并重启生效</p><p>编辑 daemon.json</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>vi /etc/docker/daemon.json
</span></span></code></pre></td></tr></table></div></div><p>重新加载 daemon.json</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl daemon-reload
</span></span></code></pre></td></tr></table></div></div><p>重启 Docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>sudo systemctl restart docker
</span></span></code></pre></td></tr></table></div></div><h3 id=配置镜像加速>配置镜像加速</h3><p>公共镜像加速</p><p>添加<code>Docker 中国官方镜像加速</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;registry-mirrors&#34;</span><span class=p>:</span> <span class=p>[</span><span class=s2>&#34;https://registry.docker-cn.com&#34;</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>更多公共镜像加速服务</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nt>&#34;registry-mirrors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;https://hub-mirror.c.163.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;https://mirror.baidubce.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;https://registry.docker-cn.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;https://reg-mirror.qiniu.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;https://dockerhub.azk8s.cn&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;https://docker.mirrors.ustc.edu.cn&#34;</span>
</span></span><span class=line><span class=cl>  <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=私有镜像加速>私有镜像加速</h3><p>可使用<code>IP</code>或<code>反向代理域名</code>来配置私有镜像加速服务.
请注意镜像加速的 HTTP/HTTPS 协议,以及开放防火墙端口.</p><p>私有域名镜像加速</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;registry-mirrors&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;https://registry.yourdomain.com&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>私有IP镜像加速</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;registry-mirrors&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;http://101.102.103.104:5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=配置私有仓库>配置私有仓库</h3><p>私有仓库可以使用<code>内网 IP</code>和<code>公网 IP</code>的形式配置.</p><p>使用反向代理配置了域名的私有仓库无需配置<code>daemon.json</code>.</p><p>内网IP</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;insecure-registries&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;192.168.1.5:5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>公网IP</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;insecure-registries&#34;</span>: <span class=o>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;101.102.103.104:5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>同时配置镜像加速和私有仓库</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>{</span>
</span></span><span class=line><span class=cl>    <span class=s2>&#34;registry-mirrors&#34;</span>: <span class=o>[</span><span class=s2>&#34;https://registry.yourdomain.com&#34;</span><span class=o>]</span>,
</span></span><span class=line><span class=cl>    <span class=s2>&#34;insecure-registries&#34;</span>: <span class=o>[</span><span class=s2>&#34;192.168.1.5:5000&#34;</span><span class=o>]</span>
</span></span><span class=line><span class=cl><span class=o>}</span>
</span></span></code></pre></td></tr></table></div></div><p>更多的镜像加速服务和私有仓库</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;registry-mirrors&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;https://registry.yourdomain.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;https://hub-mirror.c.163.com&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;https://mirror.baidubce.com&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>],</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;insecure-registries&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;192.168.1.5:5000&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;101.102.103.104:5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=docker迁移varlibdocker目录>Docker迁移/var/lib/docker目录</h2><h3 id=前言>前言</h3><p>由于<code>/var/lib/docker/overlay2</code>目录占用磁盘空间过大,即使使用<code>docker system prune -a</code>命令也无法清理<code>overlay2</code>目录下的文件,手动删除则会导致容器无法启动.所以只有将 docker 根目录迁移至空间更大的目录.</p><h4 id=迁移流程>迁移流程</h4><p>停止docker服务</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>systemctl stop docker
</span></span></code></pre></td></tr></table></div></div><h4 id=迁移目录>迁移目录</h4><p>创建新的 docker 根目录,确保创建的目录空间容量够大.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir -p /home/docker/lib
</span></span></code></pre></td></tr></table></div></div><p>迁移<code>/var/lib/docker</code>目录至<code>/home/docker/lib</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>rsync -avz /var/lib/docker /home/docker/lib/
</span></span></code></pre></td></tr></table></div></div><p>配置<code>devicemapper.conf</code>,先查看该文件是否存在.如不存在则新建.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>mkdir -p /etc/systemd/system/docker.service.d/
</span></span><span class=line><span class=cl>vi /etc/systemd/system/docker.service.d/devicemapper.conf
</span></span></code></pre></td></tr></table></div></div><p>写入以下代码保存:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=o>[</span>Service<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>
</span></span><span class=line><span class=cl><span class=nv>ExecStart</span><span class=o>=</span>/usr/bin/dockerd  --graph<span class=o>=</span>/home/docker/lib/docker
</span></span></code></pre></td></tr></table></div></div><p>重加载 docker</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>systemctl daemon-reload
</span></span><span class=line><span class=cl>systemctl restart docker
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> docker
</span></span></code></pre></td></tr></table></div></div><h4 id=检查>检查</h4><p>执行以下命令检查</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker info
</span></span></code></pre></td></tr></table></div></div><p>确认显示信息中 Docker Root Dir 路径正确</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl> <span class=err>Docker</span> <span class=err>Root</span> <span class=err>Dir:</span> <span class=err>/home/docker/lib/docker</span>
</span></span><span class=line><span class=cl> <span class=err>Debug</span> <span class=err>Mode:</span> <span class=kc>false</span>
</span></span><span class=line><span class=cl> <span class=err>Registry:</span> <span class=err>https:</span><span class=c1>//index.docker.io/v1/
</span></span></span></code></pre></td></tr></table></div></div><h4 id=完成>完成</h4><p>再次启动容器,检查无误后可删除原路径<code>/var/lib/docker/</code>中的文件.</p><h3 id=docker-私有镜像仓库>Docker 私有镜像仓库</h3><h4 id=安装服务端>安装服务端</h4><p><strong>本文以部署至公网,开启账号密码,并配置域名反向代理为例.</strong>
命令参数过多,为方便配置参数,建议使用<code>docker compose</code>部署.</p><p>创建htpasswd账号密码</p><p>启动一个一次性容器用于创建账号密码.密码文件路径以<code>/root/registry/htpasswd</code>为例,账号密码以<code>admin</code>和<code>12345678</code>为例.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker run --rm --entrypoint <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    htpasswd httpd:2 -Bbn <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    admin <span class=m>12345678</span> &gt; /root/registry/htpasswd
</span></span></code></pre></td></tr></table></div></div><p>docker-compose.yml</p><p><strong>volumes</strong> 挂载<code>htpasswd</code>密码文件,数据目录,时区文件.配置文件<code>config.yml</code>作为高级用户可选挂载.
<strong>environment</strong> 环境变量开启认证,并开启删除镜像功能.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>version: <span class=s2>&#34;3&#34;</span>
</span></span><span class=line><span class=cl>services:
</span></span><span class=line><span class=cl>  registry:
</span></span><span class=line><span class=cl>    image: registry:2
</span></span><span class=line><span class=cl>    container_name: registry
</span></span><span class=line><span class=cl>    volumes:
</span></span><span class=line><span class=cl>      <span class=c1># - ./config.yml:/etc/docker/registry/config.yml</span>
</span></span><span class=line><span class=cl>      - ./htpasswd:/auth/htpasswd
</span></span><span class=line><span class=cl>      - ./registry:/var/lib/registry
</span></span><span class=line><span class=cl>      - /etc/localtime:/etc/localtime
</span></span><span class=line><span class=cl>    ports:
</span></span><span class=line><span class=cl>      - 5000:5000
</span></span><span class=line><span class=cl>    environment:
</span></span><span class=line><span class=cl>      - <span class=nv>REGISTRY_AUTH</span><span class=o>=</span>htpasswd
</span></span><span class=line><span class=cl>      - <span class=nv>REGISTRY_AUTH_HTPASSWD_PATH</span><span class=o>=</span>/auth/htpasswd
</span></span><span class=line><span class=cl>      - <span class=nv>REGISTRY_AUTH_HTPASSWD_REALM</span><span class=o>=</span>Registry Realm
</span></span><span class=line><span class=cl>      - <span class=nv>REGISTRY_STORAGE_DELETE_ENABLED</span><span class=o>=</span><span class=nb>true</span>
</span></span><span class=line><span class=cl>    networks:
</span></span><span class=line><span class=cl>      - registry
</span></span><span class=line><span class=cl>    restart: always
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>networks:
</span></span><span class=line><span class=cl>  registry:
</span></span></code></pre></td></tr></table></div></div><p>启动</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker-compose up -d
</span></span></code></pre></td></tr></table></div></div><p>成功启动后私有镜像仓库内网地址为: <strong>192.168.1.5:5000</strong>
可根据需求使用域名配置反向代理,例如: <strong><a href=https://registry.yourdomain.com target=_blank rel="noopener noreffer">https://registry.yourdomain.com</a></strong></p><p>注意需开放防火墙 5000 端口</p><h3 id=配置客户端>配置客户端</h3><p>以<code>CentOS</code>为例,创建或修改<code>/etc/docker/daemon.json</code>文件.</p><p><strong>注意,如使用域名配置反向代理并开启<code>HTTPS</code>,则无需配<code>daemon.json</code>文件.</strong></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;insecure-registries&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;192.168.1.5:5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>或</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nt>&#34;insecure-registries&#34;</span><span class=p>:</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>      <span class=s2>&#34;101.102.103.104:5000&#34;</span>
</span></span><span class=line><span class=cl>    <span class=p>]</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=使用>使用</h3><h4 id=登录>登录</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker login registry.yourdomain.com
</span></span><span class=line><span class=cl>docker login 192.168.1.5:5000
</span></span><span class=line><span class=cl>docker login 101.102.103.104:5000
</span></span><span class=line><span class=cl><span class=c1># 使用上文创建的账号密码 admin 12345678 登录</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=登出>登出</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker <span class=nb>logout</span> registry.yourdomain.com
</span></span><span class=line><span class=cl>docker <span class=nb>logout</span> 192.168.1.5:5000
</span></span><span class=line><span class=cl>docker <span class=nb>logout</span> 101.102.103.104:5000
</span></span></code></pre></td></tr></table></div></div><h4 id=push>Push</h4><p>将现有镜像 tag 为私有仓库镜像名</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker images
</span></span><span class=line><span class=cl><span class=c1># 获取现有镜像的 IMAGE ID</span>
</span></span><span class=line><span class=cl>docker tag 102816b1ee7d registry.yourdomain.com/mysql:8.0.13
</span></span><span class=line><span class=cl>docker tag 102816b1ee7d 192.168.1.5:5000/mysql:8.0.13
</span></span><span class=line><span class=cl>docker tag 102816b1ee7d 101.102.103.104:5000/mysql:8.0.13
</span></span></code></pre></td></tr></table></div></div><p>Push 至私有镜像仓库</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker push registry.yourdomain.com/mysql:8.0.13
</span></span><span class=line><span class=cl>docker push 192.168.1.5:5000/mysql:8.0.13
</span></span><span class=line><span class=cl>docker push 101.102.103.104:5000/mysql:8.0.13
</span></span></code></pre></td></tr></table></div></div><h4 id=pull>Pull</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker pull registry.yourdomain.com/mysql:8.0.13
</span></span><span class=line><span class=cl>docker pull 192.168.1.5:5000/mysql:8.0.13
</span></span><span class=line><span class=cl>docker pull 101.102.103.104:5000/mysql:8.0.13
</span></span></code></pre></td></tr></table></div></div><h4 id=查看镜像仓库清单>查看镜像仓库清单</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -u admin:12345678 -X GET https://registry.yourdomain.com/v2/_catalog
</span></span></code></pre></td></tr></table></div></div><h4 id=查看镜像-tag-清单>查看镜像 tag 清单</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -u admin:12345678 -X GET https://registry.yourdomain.com/v2/mysql/tags/list
</span></span></code></pre></td></tr></table></div></div><h4 id=删除镜像>删除镜像</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>docker-compose.yml`环境变量中开启`REGISTRY_STORAGE_DELETE_ENABLED=true
</span></span></code></pre></td></tr></table></div></div><h5 id=获取镜像-digest-hash>获取镜像 digest hash</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -u admin:12345678 --header <span class=s2>&#34;Accept: application/vnd.docker.distribution.manifest.v2+json&#34;</span> -I -X GET https://registry.yourdomain.com/v2/mysql/manifests/8.0.13
</span></span><span class=line><span class=cl><span class=c1># 获取 digest hash 如下</span>
</span></span><span class=line><span class=cl>sha256:45a2a291xxx223123fc03d9be551e362b460exxs56787736919baa
</span></span></code></pre></td></tr></table></div></div><h5 id=删除镜像清单>删除镜像清单</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>curl -u admin:12345678 -I -X DELETE https://registry.yourdomain.com/v2/mysql/manifests/sha256:45a2a291xxx223123fc03d9be551e362b460exxs56787736919baa
</span></span></code></pre></td></tr></table></div></div><h5 id=清理磁盘空间>清理磁盘空间</h5><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>docker <span class=nb>exec</span> registry bin/registry garbage-collect /etc/docker/registry/config.yml
</span></span></code></pre></td></tr></table></div></div><h5 id=手动删除目录>手动删除目录</h5><p>完成上述操作后还可以删除存储目录中的空目录文件,如不删除依旧可以被上述<code>查看镜像仓库</code>的命令查询到结果.
<strong>依照上文示例,挂载存储目录路径如下:</strong></p><p>./registry/docker/registry/v2/repositories</p><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fwwarning"></i>警告<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>本文最后更新于 <span class=timeago datetime=2022-02-24T20:51:17 title="February 24, 2022">February 24, 2022</span>，文中内容可能已过时，请谨慎使用。</div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-02-24</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/docker%E5%9F%BA%E7%A1%80/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/docker/>docker</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/harbor%E4%BD%BF%E7%94%A8%E8%87%AA%E7%AD%BE%E5%90%8D%E8%AF%81%E4%B9%A6%E5%AE%9E%E7%8E%B0https%E7%99%BB%E5%BD%95/ class=prev rel=prev title=harbor使用自签名证书实现https登录><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>harbor使用自签名证书实现https登录</a>
<a href=/jupyter%E6%9B%B4%E6%94%B9%E7%99%BB%E5%BD%95%E5%AF%86%E7%A0%81/ class=next rel=next title=jupyter更改登录密码>jupyter更改登录密码<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2021 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Peng</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:0},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=/js/custom.js></script>
<script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script></body></html>