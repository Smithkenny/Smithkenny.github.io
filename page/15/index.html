<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.115.3"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>My New Hugo Site</title><meta name=Description content="This is my cool site"><meta property="og:title" content="My New Hugo Site"><meta property="og:description" content="This is my cool site"><meta property="og:type" content="website"><meta property="og:url" content="http://example.org/"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary"><meta name=twitter:title content="My New Hugo Site"><meta name=twitter:description content="This is my cool site"><meta name=application-name content="My cool site"><meta name=apple-mobile-web-app-title content="My cool site"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=http://example.org/><link rel=alternate href=/index.xml type=application/rss+xml title="My New Hugo Site"><link rel=feed href=/index.xml type=application/rss+xml title="My New Hugo Site"><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"WebSite","url":"http:\/\/example.org\/","inLanguage":"en-us","description":"This is my cool site","name":"My New Hugo Site"}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu><div class=menu-inner><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="My New Hugo Site">My cool site</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a href=javascript:void(0); class="menu-item theme-switch" title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class="page home" data-home=posts><div class=home-profile><div class=home-subtitle><div id=id-1 class=typeit></div></div><div class=links></div></div><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B8%AD%E5%85%B6%E4%BB%96%E4%B8%BB%E6%9C%BA%E8%AE%BF%E9%97%AE%E6%9C%AC%E6%9C%BAwsl2%E4%B8%AD%E7%9A%84%E6%9C%8D%E5%8A%A1/>局域网中其他主机访问本机wsl2中的服务</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span>&nbsp;<span class=post-publish>published on <time datetime=2022-02-21>2022-02-21</time></span></div><div class=content>前言 由于我使用的ubuntu20.04中docker所启动的服务除了本机能访问，局域网中其他设备都无法访问。容器端口和windows本机端口不相通，需要windows开启端口转发。网上找了好多资料发现有位github用户开发的脚本简单易用并且能完美解决端口转发问题。
windows上使用 链接
下载wslpp.exe即可使用，默认所有IP都能访问本机的docker生成的服务端口，并且不用配置。
linux中使用 环境
wsl中必须安装net-tools工具
sudo apt-get install net-tools 在Windows PowerShell中, 将其clone到本地:
git clone https://github.com/HobaiRiku/wsl2-auto-portproxy.git 在WSL2中, 编译此项目,注意,是需要Go的环境的, 而且这一步骤需要在Windows的管理员模式进行
sudo apt install golang-go cd /mnt/c/Users/`windows-user-name`/wsl2-auto-portproxy/ make build 配置wslpp的配置文件, 在WSL中执行
mkdir /mnt/c/Users/14408/.wslpp vim /mnt/c/Users/14408/.wslpp/config.json 输入: { "onlyPredefined": true, "predefined": { "tcp": [ "22:22" ] }, "ignore": { "tcp": [ 445 ] } }: 回到Windows PowerShell中, 执行:
cd .\wsl2-auto-portproxy\dist\ .\wslpp.exe 此外, WSL操作Windows的文件,是需要在管理员模式下进行的.</div><div class=post-footer><a href=/posts/%E5%B1%80%E5%9F%9F%E7%BD%91%E4%B8%AD%E5%85%B6%E4%BB%96%E4%B8%BB%E6%9C%BA%E8%AE%BF%E9%97%AE%E6%9C%AC%E6%9C%BAwsl2%E4%B8%AD%E7%9A%84%E6%9C%8D%E5%8A%A1/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/harbor%E5%AE%89%E8%A3%85%E4%B8%8E%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/>harbor安装与简单使用</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span>&nbsp;<span class=post-publish>published on <time datetime=2022-02-18>2022-02-18</time></span></div><div class=content>前言 Harbor 是一个开源的容器镜像仓库，它提供用户权限管理、镜像复制等功能，提高使用的registry的效率。确保镜像被扫描并且没有漏洞，并将镜像标记为可信。
harbor架构 主要组件包括proxy，他是一个nginx前端代理，主要是分发前端页面ui访问和镜像上传和下载流量，上图中通过深蓝色先标识； ui提供了一个web管理页面，当然还包括了一个前端页面和后端API，底层使用mysql数据库。 registry是镜像仓库，负责存储镜像文件，当镜像上传完毕后通过hook通知ui创建repository，上图通过红色线标识，当然registry的token认证也是通过ui组件完成。 adminserver是系统的配置管理中心附带检查存储用量，ui和jobserver启动时候回需要加载adminserver的配置，通过灰色线标识。jobsevice是负责镜像复制工作的，他和registry通信，从一个registry pull镜像然后push到另一个registry，并记录job_log，上图通过紫色线标识。 log是日志汇总组件，通过docker的log-driver把日志汇总到一起，通过浅蓝色线条标识。
环境准备 运行环境
Ubuntu 20.04 LTS docker-ce：20.10.12 docker-compose：v2.2.3 harbor-offline：v1.10.10 安装docker 官方安装参考
我是在wsl2中使用ubuntu 20.04系统安装docker的。
删除旧版docker sudo apt-get remove docker docker-engine docker.io containerd runc 如果之前安装过docker,那么所有配置文件都在/var/lib/docker/中,包括images, containers, volumes, and networks。
不用可以删除。
开始安装设置repo源 sudo apt-get update sudo apt-get install \ ca-certificates \ curl \ gnupg \ lsb-release 添加Docker的官方GPG key curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg 设置稳定版repo源 echo \ "deb [arch=$(dpkg --print-architecture) signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.</div><div class=post-footer><a href=/posts/harbor%E5%AE%89%E8%A3%85%E4%B8%8E%E7%AE%80%E5%8D%95%E4%BD%BF%E7%94%A8/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/wsl2%E4%B8%ADportainer%E5%AE%B9%E5%99%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/>wsl2中Portainer容器可视化管理工具的安装与使用</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span>&nbsp;<span class=post-publish>published on <time datetime=2022-02-17>2022-02-17</time></span></div><div class=content>前言 Portainer是一款轻量级的Docker图形化管理的方案，相比k8s和k3s，只需要创建一个容器！
功能点：
多平台支持：Linux/Windows/OSX 控制面板分类展示 技术栈分类展示：使用swarm或docker-compose等启动的服务/集群会在这里出现 管理容器生命周期 应用模板快速部署 管理Swarm集群或多服务器的镜像/容器/卷/网络 操作事件日志记录 容器控制台日志展示 使用多个Docker仓库私服pull/push镜像 用户权限管理功能（需付费$9.9） 安装 官方文档
首先，创建 Portainer Server 将用于存储其数据库的卷：
docker volume create portainer_data 然后，下载并安装 Portainer Server 容器:
docker run -d -p 8000:8000 -p 9000:9000 -p 9443:9443 \ --name=portainer --restart=always \ -v /var/run/docker.sock:/var/run/docker.sock \ -v portainer_data:/data \ portainer/portainer-ce:2.11.1 查看是否启动
➜ ~ docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES bb2b73d4a4a6 portainer/portainer-ce:2.11.1 "/portainer" 2 hours ago Up About an hour 0.</div><div class=post-footer><a href=/posts/wsl2%E4%B8%ADportainer%E5%AE%B9%E5%99%A8%E5%8F%AF%E8%A7%86%E5%8C%96%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7%E7%9A%84%E5%AE%89%E8%A3%85%E4%B8%8E%E4%BD%BF%E7%94%A8/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAip%E5%B9%B6%E5%A4%8D%E5%88%B6%E5%88%B0registry%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD/>使用脚本获取本机IP并复制到registry配置文件中</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span>&nbsp;<span class=post-publish>published on <time datetime=2022-02-17>2022-02-17</time></span></div><div class=content>前言 由于wsl2每次启动IP都会改变，查阅微软官方文档后发现wsl2无法设置静态IP。然而dockers私有仓库registry中IP配置是固定的。所以需要自定义脚本实时获取wsl2本机IP，并复制到/etc/docker/daemon.json中对应的IP位置。还需要创建系统服务启动脚本。以下内容均在ubuntu 20.04 LTS中实现。
思路 要想实现需求，可以使用bash中多脚本之间变量传递。参考
获取wsl2本机IP vi /root/init_code/get-ip.sh && chmod +x /root/init_code/get-ip.sh
var=`hostname -I | awk '{print $1}'` echo $var 查看文本格式 cat /etc/docker/daemon.json
{ "registry-mirrors": ["https://8xpk5wnt.mirror.aliyuncs.com"], "insecure-registries": ["172.26.133.115:5000"] } 创建脚本来更改daemon.json中对应IP vi chang-daemon.sh && chmod +x chang-daemon.sh
#!/bin/bash source /root/init_code/get-ip.sh echo "{ \"registry-mirrors\": [\"https://8xpk5wnt.mirror.aliyuncs.com\"], \"insecure-registries\": [\"$var:5000\"] } " > /etc/docker/daemon.json 在脚本2中使用source 来引用脚本1中的变量。如何打印出双引号？双引号前加反斜杠。
例如：
打印出"Hello World!"
echo "\"Hello World!"\" 创建开机自启动脚本 vi /root/init_code/init_myservice.sh
#启动ssh服务和docker服务 sudo service ssh restart sudo service docker start 创建查看仓库中镜像脚本 vi /root/init_code/watch-myregistry.</div><div class=post-footer><a href=/posts/%E4%BD%BF%E7%94%A8%E8%84%9A%E6%9C%AC%E8%8E%B7%E5%8F%96%E6%9C%AC%E6%9C%BAip%E5%B9%B6%E5%A4%8D%E5%88%B6%E5%88%B0registry%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B8%AD/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/>linux下混杂模式判断</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span>&nbsp;<span class=post-publish>published on <time datetime=2022-02-14>2022-02-14</time></span></div><div class=content>简介 混杂模式就是接收所有经过网卡的数据包，包括不是发给本机的包，即不验证MAC地址。普通模式下网卡只接收发给本机的包（包括广播包）传递给上层程序，其它的包一律丢弃。
一般来说，混杂模式不会影响网卡的正常工作，多在网络监听工具上使用。
网卡工作模式 广播模式（Broad Cast Model）:它的物理地址（MAC）地址是 0Xffffff 的帧为广播帧，工作在广播模式的网卡接收广播帧。
多播传送（MultiCast Model）：多播传送地址作为目的物理地址的帧可以被组内的其它主机同时接收，而组外主机却接收不到。但是，如果将网卡设置为多播传送模式，它可以接收所有的多播传送帧，而不论它是不是组内成员。
直接模式（Direct Model）:工作在直接模式下的网卡只接收目地址是自己 Mac地址的帧。
混杂模式（Promiscuous Model）:工作在混杂模式下的网卡接收所有的流过网卡的帧，信包捕获程序就是在这种模式下运行的。
网卡的缺省工作模式包含广播模式和直接模式，即它只接收广播帧和发给自己的帧。如果采用混杂模式，一个站点的网卡将接受同一网络内所有站点所发送的数据包这样就可以到达对于网络信息监视捕获的目的。
开启混杂模式 Linux下设置把网卡设置成混杂模式的命令也很简单。
ifconfig ens33 promisc cat /sys/class/net/ens33/flags 取消混杂模式 ifconfig ens33 -promisc cat /sys/class/net/ens33/flags 拓展 使用tcpdump工具抓包时，抓包的网口会临时变成混杂模式。
[root@nginx140 ~]# tcpdump -i ens33 -vv -nn -w ./test.cap tcpdump: listening on ens33, link-type EN10MB (Ethernet), capture size 262144 bytes ^C537 packets captured 540 packets received by filter 0 packets dropped by kernel 抓包的同时查看对应网卡标志位
[root@nginx140 ~]# cat /sys/class/net/ens33/flags 0x1103 总结 当网卡的标志位为0x1003时，没有开启混杂模式。而网卡标志位为0x1103时，说明该网卡开启了混杂模式。</div><div class=post-footer><a href=/posts/linux%E4%B8%8B%E6%B7%B7%E6%9D%82%E6%A8%A1%E5%BC%8F%E5%88%A4%E6%96%AD/>Read More</a></div></article><article class="single summary" itemscope itemtype=http://schema.org/Article><h1 class=single-title itemprop="name headline"><a href=/posts/redhat6.3yum%E6%BA%90%E5%A4%B1%E6%95%88%E8%A7%A3%E5%86%B3/>redhat6.3-yum源失效解决</a></h1><div class=post-meta><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Author</a></span>&nbsp;<span class=post-publish>published on <time datetime=2022-02-12>2022-02-12</time></span></div><div class=content>备份原repo mv /etc/yum.repos.d/rhel-source.repo /etc/yum.repos.d/rhel-source.repo-old 新建repo文件 vi /etc/yum.repos.d/rhel-source.repo
# CentOS-Base.repo # # The mirror system uses the connecting IP address of the client and the # update status of each mirror to pick mirrors that are updated to and # geographically close to the client. You should use this for CentOS updates # unless you are manually picking other mirrors. # # If the mirrorlist= does not work for you, as a fall back you can try the # remarked out baseurl= line instead.</div><div class=post-footer><a href=/posts/redhat6.3yum%E6%BA%90%E5%A4%B1%E6%95%88%E8%A7%A3%E5%86%B3/>Read More</a></div></article><ul class=pagination><li class=page-item><span class=page-link><a href=/>1</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/13/>13</a></span></li><li class=page-item><span class=page-link><a href=/page/14/>14</a></span></li><li class="page-item active"><span class=page-link><a href=/page/15/>15</a></span></li><li class=page-item><span class=page-link><a href=/page/16/>16</a></span></li><li class=page-item><span class=page-link><a href=/page/17/>17</a></span></li><li class=page-item><span class=page-link aria-hidden=true>&mldr;</span></li><li class=page-item><span class=page-link><a href=/page/19/>19</a></span></li></ul></div></div></main><footer class=footer><div class=footer-container><div class=footer-line>Powered by <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.115.3">Hugo</a> | Theme - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2022 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank></a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title="Back to Top"><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title="View Comments"><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/typeit@8.6.0/dist/index.umd.js></script><script type=text/javascript>window.config={code:{copyTitle:"Copy to clipboard",maxShownLines:50},data:{"id-1":"This is my cool site"},typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"id-1":["id-1"]},duration:-1,speed:100}}</script><script type=text/javascript src=/js/theme.min.js></script></body></html>