<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>python常用模块 - Peng</title><meta name=Description content="One World,One Dream!"><meta property="og:title" content="python常用模块"><meta property="og:description" content="日志模块角色 1.Logger:产生日志 2.Filter:几乎不用 3.Handler: 接收Logger传过来的日志，进行日志格式化，可以打印到终端，也可以打印到"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.haipengv.com/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/"><meta property="og:image" content="https://blog.haipengv.com/logo.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-26T12:44:37+00:00"><meta property="article:modified_time" content="2022-03-26T12:44:37+00:00"><meta property="og:site_name" content="我的网站"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.haipengv.com/logo.webp"><meta name=twitter:title content="python常用模块"><meta name=twitter:description content="日志模块角色 1.Logger:产生日志 2.Filter:几乎不用 3.Handler: 接收Logger传过来的日志，进行日志格式化，可以打印到终端，也可以打印到"><meta name=application-name content="我的网站"><meta name=apple-mobile-web-app-title content="我的网站"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.haipengv.com/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/><link rel=prev href=https://blog.haipengv.com/%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85/><link rel=next href=https://blog.haipengv.com/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/><link rel=stylesheet href=/lib/normalize/normalize.min.css><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=/lib/fontawesome-free/all.min.css><link rel=stylesheet href=/lib/animate/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"python常用模块","inLanguage":"zh-cn","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.haipengv.com\/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97\/"},"genre":"posts","keywords":"python","wordcount":9921,"url":"https:\/\/blog.haipengv.com\/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97\/","datePublished":"2022-03-26T12:44:37+00:00","dateModified":"2022-03-26T12:44:37+00:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"Peng"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title=Peng>Peng</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/friends/><i class='fas fa-fw fa-fan fa-spin'></i> 友链 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><span class="menu-item search" id=search-desktop>
<input type=text placeholder=搜索文章标题或内容... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span>
</span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=Peng>Peng</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><div class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=搜索文章标题或内容... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fas fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fas fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fas fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></div><a class=menu-item href=/posts/ title>文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/friends/ title><i class='fas fa-fw fa-fan fa-spin'></i>友链</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class="toc-content always-active" id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">python常用模块</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=/ title=Author rel=author class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Peng</a>
</span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E7%BC%96%E7%A8%8B/><i class="far fa-folder fa-fw" aria-hidden=true></i>编程</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-03-26>2022-03-26</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 9921 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 20 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#日志模块角色>日志模块角色</a></li><li><a href=#日志模块相关说明>日志模块相关说明</a><ul><li><a href=#format参数中可能用到的格式化串>format参数中可能用到的格式化串</a></li></ul></li><li><a href=#日志打印实现过程>日志打印实现过程</a></li><li><a href=#日志的继承关系了解>日志的继承关系（了解）</a></li><li><a href=#日志模块应用>日志模块应用</a><ul><li><a href=#整体项目结构>整体项目结构</a></li><li><a href=#每个目录简单介绍>每个目录简单介绍</a></li><li><a href=#相关源码>相关源码</a></li></ul></li><li><a href=#re模块-正则表达式>re模块-正则表达式</a><ul><li><a href=#什么是正则>什么是正则？</a></li><li><a href=#常用匹配模式元字符>常用匹配模式(元字符)</a><ul><li><a href=#点>点</a></li><li><a href=#问号>问号</a></li><li><a href=#星>星</a></li><li><a href=#加号>加号</a></li><li><a href=#大括号>大括号</a></li><li><a href=#点星>点星</a></li><li><a href=#点星问号>点星问号</a></li><li><a href=#斜杠>斜杠</a></li><li><a href=#小括号>小括号</a></li><li><a href=#中括号>中括号</a></li></ul></li><li><a href=#re模块的其他用法>re模块的其他用法</a></li></ul></li><li><a href=#时间模块>时间模块</a></li><li><a href=#random模块>random模块</a></li><li><a href=#os模块>os模块</a></li><li><a href=#sys模块>sys模块</a></li><li><a href=#shutil模块>shutil模块</a></li><li><a href=#xml模块>xml模块</a><ul><li><a href=#遍历文档>遍历文档</a><ul><li><a href=#只遍历year节点>只遍历year节点</a></li></ul></li><li><a href=#修改>修改</a></li><li><a href=#删除>删除</a></li></ul></li><li><a href=#configerparser模块>configerparser模块</a></li><li><a href=#hashlib模块>hashlib模块</a><ul><li><a href=#什么叫hash>什么叫hash?</a></li><li><a href=#hash值的特点>hash值的特点</a></li></ul></li><li><a href=#subprocess模块>subprocess模块</a></li></ul></nav></div></div><div class=content id=content><h2 id=日志模块角色>日志模块角色</h2><p>1.<code>Logger</code>:产生日志
2.<code>Filter</code>:几乎不用
3.<code>Handler</code>: 接收Logger传过来的日志，进行日志格式化，可以打印到终端，也可以打印到文件
4.<code>Formatter</code>：日志格式</p><h2 id=日志模块相关说明>日志模块相关说明</h2><p>可在<code>logging.basicConfig()</code>函数中可通过具体参数来更改<code>logging</code>模块默认行为，可用参数有.
<code>filename</code>：用指定的文件名创建<code>FiledHandler</code>，这样日志会被存储在指定的文件中。
<code>filemode</code>：文件打开方式，在指定了<code>filename</code>时使用这个参数，默认值为“a”还可指定为“w”。
<code>format</code>：指定<code>handler</code>使用的日志显示格式。
<code>datefmt</code>：指定日期时间格式。
<code>level</code>：设置<code>rootlogger</code>的日志级别
<code>stream</code>：用指定的<code>stream</code>创建<code>StreamHandler</code>。可以指定输出到<code>sys.stderr,sys.stdout</code>或者文件，默认为<code>sys.stderr</code>。若同时列出了<code>filename</code>和<code>stream</code>两个参数，则<code>stream</code>参数会被忽略。</p><h3 id=format参数中可能用到的格式化串>format参数中可能用到的格式化串</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>%(name)s Logger的名字
</span></span><span class=line><span class=cl>%(levelno)s 数字形式的日志级别
</span></span><span class=line><span class=cl>%(levelname)s 文本形式的日志级别
</span></span><span class=line><span class=cl>%(pathname)s 调用日志输出函数的模块的完整路径名，可能没有
</span></span><span class=line><span class=cl>%(filename)s 调用日志输出函数的模块的文件名
</span></span><span class=line><span class=cl>%(module)s 调用日志输出函数的模块名
</span></span><span class=line><span class=cl>%(funcName)s 调用日志输出函数的函数名
</span></span><span class=line><span class=cl>%(lineno)d 调用日志输出函数的语句所在的代码行
</span></span><span class=line><span class=cl>%(created)f 当前时间，用UNIX标准的表示时间的浮 点数表示
</span></span><span class=line><span class=cl>%(relativeCreated)d 输出日志信息时的，自Logger创建以 来的毫秒数
</span></span><span class=line><span class=cl>%(asctime)s 字符串形式的当前时间。默认格式是 “2003-07-08 16:49:45,896”。逗号后面的是毫秒
</span></span><span class=line><span class=cl>%(thread)d 线程ID。可能没有
</span></span><span class=line><span class=cl>%(threadName)s 线程名。可能没有
</span></span><span class=line><span class=cl>%(process)d 进程ID。可能没有
</span></span><span class=line><span class=cl>%(message)s用户输出的消息
</span></span></code></pre></td></tr></table></div></div><h2 id=日志打印实现过程>日志打印实现过程</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=c1>#1.Logger:产生日志</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;访问日志&#39;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=c1>#2.Handler: 接收Logger传过来的日志，进行日志格式化，可以打印到终端，也可以打印到文件</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span> <span class=c1>#打印到终端</span>
</span></span><span class=line><span class=cl><span class=n>fh1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s1>&#39;s1.log&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> <span class=c1>#打印到文件</span>
</span></span><span class=line><span class=cl><span class=n>fh2</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s1>&#39;s2.log&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#3.Formatter：日志格式</span>
</span></span><span class=line><span class=cl><span class=n>formatter1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(module)s</span><span class=s1>: </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>formatter2</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> : </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>formatter3</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> : </span><span class=si>%(module)s</span><span class=s1> : </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#4.为Handler绑定日志格式</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh1</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh2</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#5.为logger 绑定handler</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>fh1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>fh2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#6.设置日志级别:logger 对象的日志级别应该&lt;=handler的日志级别</span>
</span></span><span class=line><span class=cl><span class=c1>#logger1.setLevel(30)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh1</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh2</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#7.测试</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;测试者玩&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;运行还算正常&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s1>&#39;可能要有bug了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s1>&#39;不好了，真出bug了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=s1>&#39;推到重写&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>去注释版</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;访问日志&#39;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>fh1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s1>&#39;s1.log&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span> 
</span></span><span class=line><span class=cl><span class=n>fh2</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>FileHandler</span><span class=p>(</span><span class=s1>&#39;s2.log&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>formatter1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(module)s</span><span class=s1>: </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>formatter2</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> : </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>formatter3</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> : </span><span class=si>%(module)s</span><span class=s1> : </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh1</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh2</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter3</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>fh1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>fh2</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#logger1.setLevel(30)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh1</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fh2</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>测试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;测试者玩&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;运行还算正常&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>warning</span><span class=p>(</span><span class=s1>&#39;可能要有bug了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>error</span><span class=p>(</span><span class=s1>&#39;不好了，真出bug了&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>critical</span><span class=p>(</span><span class=s1>&#39;推到重写&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>结果：</p><p><code>s1.log</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2022-03-22 20:26:58 PM : 测试者玩
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : 运行还算正常
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : 可能要有bug了
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : 不好了，真出bug了
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : 推到重写
</span></span></code></pre></td></tr></table></div></div><p><code>s2.log</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2022-03-22 20:26:58 PM : my_logging : 测试者玩
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : my_logging : 运行还算正常
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : my_logging : 可能要有bug了
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : my_logging : 不好了，真出bug了
</span></span><span class=line><span class=cl>2022-03-22 20:26:58 PM : my_logging : 推到重写
</span></span></code></pre></td></tr></table></div></div><p>终端</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2022-03-26 11:32:48 AM - 访问日志 - INFO - my_logging: 运行还算正常
</span></span><span class=line><span class=cl>2022-03-26 11:32:48 AM - 访问日志 - WARNING - my_logging: 可能要有bug了
</span></span><span class=line><span class=cl>2022-03-26 11:32:48 AM - 访问日志 - ERROR - my_logging: 不好了，真出bug了
</span></span><span class=line><span class=cl>2022-03-26 11:32:48 AM - 访问日志 - CRITICAL - my_logging: 推到重写
</span></span></code></pre></td></tr></table></div></div><h2 id=日志的继承关系了解>日志的继承关系（了解）</h2><p>练习</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=c1>#1.Logger:产生日志</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;root.child1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;root.child1.child2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#2.Handler: 接收Logger传过来的日志，进行日志格式化，可以打印到终端，也可以打印到文件</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span> <span class=c1>#打印到终端</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#3.Formatter：日志格式</span>
</span></span><span class=line><span class=cl><span class=n>formatter1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(module)s</span><span class=s1>: </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#4.为Handler绑定日志格式</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#5.为logger 绑定handler</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#6.设置日志级别:logger 对象的日志级别应该&lt;=handler的日志级别</span>
</span></span><span class=line><span class=cl><span class=c1>#logger1.setLevel(30)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#7.测试</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;爷爷&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;爸爸&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=s1>&#39;孙子&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>结果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>2022-03-22 21:00:30 PM - root - DEBUG - my_logging_child: 爷爷
</span></span><span class=line><span class=cl>2022-03-22 21:00:30 PM - root.child1 - DEBUG - my_logging_child: 爸爸
</span></span><span class=line><span class=cl>2022-03-22 21:00:30 PM - root.child1 - DEBUG - my_logging_child: 爸爸
</span></span><span class=line><span class=cl>2022-03-22 21:00:30 PM - root.child1.child2 - DEBUG - my_logging_child: 孙子
</span></span><span class=line><span class=cl>2022-03-22 21:00:30 PM - root.child1.child2 - DEBUG - my_logging_child: 孙子
</span></span><span class=line><span class=cl>2022-03-22 21:00:30 PM - root.child1.child2 - DEBUG - my_logging_child: 孙子
</span></span></code></pre></td></tr></table></div></div><p>去注释版</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;root.child1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=s1>&#39;root.child1.child2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>StreamHandler</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>formatter1</span><span class=o>=</span><span class=n>logging</span><span class=o>.</span><span class=n>Formatter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>fmt</span><span class=o>=</span><span class=s1>&#39;</span><span class=si>%(asctime)s</span><span class=s1> - </span><span class=si>%(name)s</span><span class=s1> - </span><span class=si>%(levelname)s</span><span class=s1> - </span><span class=si>%(module)s</span><span class=s1>: </span><span class=si>%(message)s</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>datefmt</span><span class=o>=</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S %p&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setFormatter</span><span class=p>(</span><span class=n>formatter1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>.</span><span class=n>addHandler</span><span class=p>(</span><span class=n>sh</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#logger1.setLevel(30)</span>
</span></span><span class=line><span class=cl><span class=n>logger1</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger2</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>logger3</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>sh</span><span class=o>.</span><span class=n>setLevel</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>测试</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>logger1.debug(&#39;爷爷&#39;)
</span></span><span class=line><span class=cl>logger2.debug(&#39;爸爸&#39;)
</span></span><span class=line><span class=cl>logger3.debug(&#39;孙子&#39;)
</span></span></code></pre></td></tr></table></div></div><h2 id=日志模块应用>日志模块应用</h2><p>模拟购物小程序，选择转账时记录日志。</p><h3 id=整体项目结构>整体项目结构</h3><p><img class=lazyload src=/svg/loading.min.svg data-src=/postimages/%e8%b4%ad%e7%89%a9%e5%b0%8f%e7%a8%8b%e5%ba%8f%e6%95%b4%e4%bd%93%e7%bb%93%e6%9e%84.webp data-srcset="/postimages/%e8%b4%ad%e7%89%a9%e5%b0%8f%e7%a8%8b%e5%ba%8f%e6%95%b4%e4%bd%93%e7%bb%93%e6%9e%84.webp, /postimages/%e8%b4%ad%e7%89%a9%e5%b0%8f%e7%a8%8b%e5%ba%8f%e6%95%b4%e4%bd%93%e7%bb%93%e6%9e%84.webp 1.5x, /postimages/%e8%b4%ad%e7%89%a9%e5%b0%8f%e7%a8%8b%e5%ba%8f%e6%95%b4%e4%bd%93%e7%bb%93%e6%9e%84.webp 2x" data-sizes=auto alt=/postimages/购物小程序整体结构.webp title=购物小程序整体结构></p><h3 id=每个目录简单介绍>每个目录简单介绍</h3><p><code>bin</code>目录：存放用户交互程序</p><p><code>conf</code>目录：设置相关</p><p><code>core</code>：核心功能</p><p><code>db</code>:用户认证相关</p><p><code>lib</code>:常用功能</p><p><code>log</code>：日志文件</p><p><code>README</code>:项目介绍</p><h3 id=相关源码>相关源码</h3><p><code>start.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span><span class=o>,</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=c1>#print(os.path.abspath(__file__))</span>
</span></span><span class=line><span class=cl><span class=c1>#print(os.path.dirname(os.path.abspath(__file__)))</span>
</span></span><span class=line><span class=cl><span class=c1>#print(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>BASE_DIR</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>sys</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>core</span> <span class=kn>import</span> <span class=n>src</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>src</span><span class=o>.</span><span class=n>run</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><code>settings.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>os</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging.config</span>
</span></span><span class=line><span class=cl><span class=n>BASE_DIR</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=vm>__file__</span><span class=p>)))</span>
</span></span><span class=line><span class=cl><span class=n>LOG_PATH</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;log&#39;</span><span class=p>,</span> <span class=s1>&#39;access.log&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>DB_PATH</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;db&#39;</span><span class=p>,</span> <span class=s1>&#39;user&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>COLLECT_PATH</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>,</span> <span class=s1>&#39;log&#39;</span><span class=p>,</span> <span class=s1>&#39;collect.log&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>LOG_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>DB_PATH</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 定义三种日志输出格式 开始</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>standard_format</span> <span class=o>=</span> <span class=s1>&#39;[</span><span class=si>%(asctime)s</span><span class=s1>][</span><span class=si>%(threadName)s</span><span class=s1>:</span><span class=si>%(thread)d</span><span class=s1>][task_id:</span><span class=si>%(name)s</span><span class=s1>][</span><span class=si>%(filename)s</span><span class=s1>:</span><span class=si>%(lineno)d</span><span class=s1>]&#39;</span> \
</span></span><span class=line><span class=cl>                  <span class=s1>&#39;[</span><span class=si>%(levelname)s</span><span class=s1>][</span><span class=si>%(message)s</span><span class=s1>]&#39;</span> <span class=c1>#其中name为getlogger指定的名字</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>simple_format</span> <span class=o>=</span> <span class=s1>&#39;[</span><span class=si>%(levelname)s</span><span class=s1>][</span><span class=si>%(asctime)s</span><span class=s1>][</span><span class=si>%(filename)s</span><span class=s1>:</span><span class=si>%(lineno)d</span><span class=s1>]</span><span class=si>%(message)s</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>id_simple_format</span> <span class=o>=</span> <span class=s1>&#39;[</span><span class=si>%(levelname)s</span><span class=s1>][</span><span class=si>%(asctime)s</span><span class=s1>] </span><span class=si>%(message)s</span><span class=s1>&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># log配置字典</span>
</span></span><span class=line><span class=cl><span class=n>LOGGING_DIC</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;version&#39;</span><span class=p>:</span> <span class=mi>1</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;disable_existing_loggers&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;formatters&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;standard&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=n>standard_format</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;simple&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=n>simple_format</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;id_simple&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;format&#39;</span><span class=p>:</span> <span class=n>id_simple_format</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;filters&#39;</span><span class=p>:</span> <span class=p>{},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;handlers&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=c1>#打印到终端的日志</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;console&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;DEBUG&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=s1>&#39;logging.StreamHandler&#39;</span><span class=p>,</span>  <span class=c1># 打印到屏幕</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;formatter&#39;</span><span class=p>:</span> <span class=s1>&#39;simple&#39;</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=c1>#打印到文件的日志,收集info及以上的日志</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;default&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;DEBUG&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=s1>&#39;logging.handlers.RotatingFileHandler&#39;</span><span class=p>,</span>  <span class=c1># 保存到文件</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;formatter&#39;</span><span class=p>:</span> <span class=s1>&#39;standard&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>LOG_PATH</span><span class=p>,</span>  <span class=c1># 日志文件</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;maxBytes&#39;</span><span class=p>:</span> <span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=o>*</span><span class=mi>5</span><span class=p>,</span>  <span class=c1># 日志大小 5M</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;backupCount&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;encoding&#39;</span><span class=p>:</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>,</span>  <span class=c1># 日志文件的编码，再也不用担心中文log乱码了</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;collect&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;DEBUG&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;class&#39;</span><span class=p>:</span> <span class=s1>&#39;logging.handlers.RotatingFileHandler&#39;</span><span class=p>,</span>  <span class=c1># 保存到文件</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;formatter&#39;</span><span class=p>:</span> <span class=s1>&#39;simple&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;filename&#39;</span><span class=p>:</span> <span class=n>COLLECT_PATH</span><span class=p>,</span>  <span class=c1># 日志文件</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;maxBytes&#39;</span><span class=p>:</span> <span class=mi>1024</span><span class=o>*</span><span class=mi>1024</span><span class=o>*</span><span class=mi>5</span><span class=p>,</span>  <span class=c1># 日志大小 5M</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;backupCount&#39;</span><span class=p>:</span> <span class=mi>5</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;encoding&#39;</span><span class=p>:</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>,</span>  <span class=c1># 日志文件的编码，再也不用担心中文log乱码了</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;loggers&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;&#39;</span><span class=p>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;handlers&#39;</span><span class=p>:</span> <span class=p>[</span><span class=s1>&#39;default&#39;</span><span class=p>,</span> <span class=s1>&#39;console&#39;</span><span class=p>,</span> <span class=s1>&#39;collect&#39;</span><span class=p>],</span>  <span class=c1># 这里把上面定义的两个handler都加上，即log数据既写入文件又打印到屏幕</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;level&#39;</span><span class=p>:</span> <span class=s1>&#39;DEBUG&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=s1>&#39;propagate&#39;</span><span class=p>:</span> <span class=kc>False</span><span class=p>,</span>  <span class=c1># 向上（更高level的logger）传递</span>
</span></span><span class=line><span class=cl>        <span class=p>},</span>
</span></span><span class=line><span class=cl>    <span class=p>},</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p><code>src.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>lib</span> <span class=kn>import</span> <span class=n>common</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>lib</span> <span class=kn>import</span> <span class=n>sql</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>shop</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;购物&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>check_balance</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;查看余额....&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#res = sql.execute(&#39;select balance from user where id=3&#39;)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#print(res)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>transfer_account</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;转账....&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1>#记录日志</span>
</span></span><span class=line><span class=cl>    <span class=n>log_msg</span> <span class=o>=</span> <span class=s1>&#39;jack give smith ten yuan&#39;</span>
</span></span><span class=line><span class=cl>    <span class=c1>#调用日志功能</span>
</span></span><span class=line><span class=cl>    <span class=n>loggers</span> <span class=o>=</span> <span class=n>common</span><span class=o>.</span><span class=n>logger_handle</span><span class=p>(</span><span class=s1>&#39;transfer_account&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>loggers</span><span class=o>.</span><span class=n>debug</span><span class=p>(</span><span class=n>log_msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>run</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>msg</span> <span class=o>=</span> <span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    1.购物
</span></span></span><span class=line><span class=cl><span class=s1>    2.查看余额
</span></span></span><span class=line><span class=cl><span class=s1>    3.转账
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>msg</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>choice</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;&gt;&gt;: &#39;</span><span class=p>)</span><span class=o>.</span><span class=n>strip</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=ow>not</span> <span class=n>choice</span><span class=p>:</span><span class=k>continue</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>choice</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>shop</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=s1>&#39;2&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>check_balance</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>choice</span> <span class=o>==</span> <span class=s1>&#39;3&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>transfer_account</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p><code>user</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>alex</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=n>male</span><span class=p>,</span><span class=mi>10000</span>
</span></span><span class=line><span class=cl><span class=n>egon</span><span class=p>,</span><span class=mi>18</span><span class=p>,</span><span class=n>male</span><span class=p>,</span><span class=mi>1000000</span>
</span></span></code></pre></td></tr></table></div></div><p><code>common.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>conf</span> <span class=kn>import</span> <span class=n>settings</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>logging.config</span>
</span></span><span class=line><span class=cl><span class=c1># def logger(msg):</span>
</span></span><span class=line><span class=cl><span class=c1>#     with open(settings.LOG_PATH, &#39;a&#39;, encoding=&#39;utf-8&#39;) as f:</span>
</span></span><span class=line><span class=cl><span class=c1>#         f.write(&#39;%s\n&#39; %msg)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>logger_handle</span><span class=p>(</span><span class=n>log_name</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>logging</span><span class=o>.</span><span class=n>config</span><span class=o>.</span><span class=n>dictConfig</span><span class=p>(</span><span class=n>settings</span><span class=o>.</span><span class=n>LOGGING_DIC</span><span class=p>)</span>  <span class=c1># 导入上面定义的logging配置</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span> <span class=o>=</span> <span class=n>logging</span><span class=o>.</span><span class=n>getLogger</span><span class=p>(</span><span class=n>log_name</span><span class=p>)</span>  <span class=c1># 生成一个log实例</span>
</span></span><span class=line><span class=cl>    <span class=n>logger</span><span class=o>.</span><span class=n>info</span><span class=p>(</span><span class=s1>&#39;It works!&#39;</span><span class=p>)</span>  <span class=c1># 记录该文件的运行状态</span>
</span></span></code></pre></td></tr></table></div></div><p><code>sql.py</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>def</span> <span class=nf>execute</span><span class=p>(</span><span class=n>sql</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;解析&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;执行sql&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>access.log</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>jack给smith转账了10元
</span></span><span class=line><span class=cl>[2022-03-22 22:01:20,767][MainThread:2600][task_id:转账][common.py:10][INFO][It works!]
</span></span><span class=line><span class=cl>[2022-03-22 22:04:08,963][MainThread:14184][task_id:转账][common.py:10][INFO][It works!]
</span></span><span class=line><span class=cl>[2022-03-22 22:06:59,656][MainThread:15740][task_id:transfer_account][common.py:10][INFO][It works!]
</span></span><span class=line><span class=cl>[2022-03-26 11:41:33,154][MainThread:12820][task_id:transfer_account][common.py:10][INFO][It works!]
</span></span></code></pre></td></tr></table></div></div><p><code>collect.log</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[INFO][2022-03-22 22:01:20,767][common.py:10]It works!
</span></span><span class=line><span class=cl>[INFO][2022-03-22 22:04:08,963][common.py:10]It works!
</span></span><span class=line><span class=cl>[INFO][2022-03-22 22:06:59,656][common.py:10]It works!
</span></span><span class=line><span class=cl>[INFO][2022-03-26 11:41:33,154][common.py:10]It works!
</span></span></code></pre></td></tr></table></div></div><h2 id=re模块-正则表达式>re模块-正则表达式</h2><h3 id=什么是正则>什么是正则？</h3><p>正则就是用一些具有特殊含义的符号组合到一起（称为正则表达式）来描述字符或者字符串的方法。或者说：正则就是用来描述一类事物的规则。（在Python中）它内嵌在Python中，并通过 re 模块实现。正则表达式模式被编译成一系列的字节码，然后由用 C 编写的匹配引擎执行。</p><h3 id=常用匹配模式元字符>常用匹配模式(元字符)</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>re</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;\w&#39;</span><span class=p>,</span> <span class=s1>&#39;jack 123 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;\W&#39;</span><span class=p>,</span> <span class=s1>&#39;jack 123 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;\s&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;\S&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;\d&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;\D&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\t</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;j&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + hello _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;^j&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + hello _ - *&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;o$&#39;</span><span class=p>,</span> <span class=s1>&#39;jack</span><span class=se>\t</span><span class=s1>n 12</span><span class=se>\n</span><span class=s1>3 + _ * hello&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>重复<code>./?/*/+/{m,n}/.*/.*?</code></p><h4 id=点>点</h4><p><code>.</code>能匹配换行符(<code>\n)</code>以外的任意一个字符 (以<code>a</code>开头的都没匹配上，直到遇到<code>aab</code>符合<code>a.b</code>匹配规则，所以结果是<code>aab</code>)</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a.b&#39;</span><span class=p>,</span> <span class=s1>&#39;a1b a b a-b aaaaaaaab&#39;</span><span class=p>))</span> <span class=c1># [&#39;a1b&#39; ,&#39;a b&#39; , &#39;a-b&#39;, &#39;aab&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a.b&#39;</span><span class=p>,</span> <span class=s1>&#39;a1b a b a</span><span class=se>\n</span><span class=s1>b aaaaaaaab&#39;</span><span class=p>))</span> <span class=c1># [&#39;a1b&#39;,&#39;a b&#39;, &#39;aab&#39;]</span>
</span></span><span class=line><span class=cl>                        <span class=c1>#a.b</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a.b&#39;</span><span class=p>,</span> <span class=s1>&#39;a1b a b a</span><span class=se>\n</span><span class=s1>b aaaaaaaab&#39;</span><span class=p>,</span> <span class=n>re</span><span class=o>.</span><span class=n>DOTALL</span><span class=p>))</span> <span class=c1>#[&#39;a1b&#39;,&#39;a b&#39;, &#39;a\nb&#39;,&#39;aab&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=问号>问号</h4><p><code>?</code>代表<code>?</code>左边的字符出现0次或者1次</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab?&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbb a1b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a&#39; ,&#39;ab&#39; ,&#39;ab&#39;,&#39;ab&#39;,&#39;a&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><p>分析过程:</p><p>要匹配<code>ab?</code>。<code>b</code>可以出现1个也可以不出现。即<code>'a'</code>或者<code>'ab'.字母a开头</code>的只要能匹配就取出来。</p><h4 id=星>星</h4><p><code>*</code>代表<code>*</code>左边的字符出现0次或者无穷次</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab*&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbb a1b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a&#39;, &#39;ab&#39;, &#39;abb&#39;,&#39;abbbb&#39;,&#39;a&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=加号>加号</h4><p><code>+</code>代表<code>+</code>号左边的字符出现1次或者无穷次</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab+&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbbb a1b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;ab&#39;,&#39;abb&#39;,&#39;abbbbb&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><p>分析过程:</p><p>要匹配<code>ab+</code>,<code>b</code>可以出现1个或者无穷次但不能不出现。即<code>'ab'或者'a无穷个b'</code>.需要以字母<code>ab</code>开头的才能匹配，注意和问号、星号做对比。</p><h4 id=大括号>大括号</h4><p><code>{m,n}</code>：代表左边的字符出现<code>m</code>次到<code>n</code>次</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab{0,1}&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbb a1b&#39;</span><span class=p>))</span> <span class=c1>#等同于?效果。0次到1次</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab{0,}&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbb a1b&#39;</span><span class=p>))</span> <span class=c1>#等同于*效果。0次到无穷次</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab{1,}&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbb a1b&#39;</span><span class=p>))</span> <span class=c1>#等同于+效果。1次到无穷次</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;ab{2,4}&#39;</span><span class=p>,</span> <span class=s1>&#39;a ab abb abbbb abbbbbbbbbbbb  a1b&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#2次到4次，即匹配abb,abbb,abbbb ,如果出现4个以上的b只取到4个。结果为[&#39;abb&#39;,&#39;abbbb&#39;,&#39;abbbb&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=点星>点星</h4><p><code>.*</code>代表要么不出现，要么出现无穷次。（贪婪匹配）通常匹配的不够精准。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a.*b&#39;</span><span class=p>,</span> <span class=s1>&#39;xxxxy123a123b456b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a123b456b&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=点星问号>点星问号</h4><p><code>.*?</code>非贪婪匹配和.*对应。（爬虫经常用！！！）</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a.*?b&#39;</span><span class=p>,</span> <span class=s1>&#39;xxxxy123a123b456b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a123b&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><p>分析:有多个<code>b</code>时，匹配最近的一个<code>b</code></p><h4 id=斜杠>斜杠</h4><p><code>/</code>或者</p><h4 id=小括号>小括号</h4><p><code>()</code>分组，<code>findall()</code>只取分组里面的字符。<code>(?:)</code>代表分组外面的字符也保留。是固定写法！</p><p>需求:找出所有<code>compan</code>开头的英文字母</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;compan(y|ies)&#39;</span><span class=p>,</span> <span class=s1>&#39;Too many companies have gone bankrupt, and the next one is my company&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#结果：[&#39;ies&#39;,&#39;y&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;compan(?:y|ies)&#39;</span><span class=p>,</span> <span class=s1>&#39;Too many companies have gone bankrupt, and the next one is my company&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#结果：[&#39;companies&#39;,&#39;company&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><p>应用取出网页中的链接</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;href=&#34;(.*?)&#34;&#39;</span><span class=p>,</span> <span class=s1>&#39;&lt;a href=&#34;http://www.baidu.com&#34;&gt;点击我&lt;/a&gt;&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>结果:</p><p><code>['http://www.baidu.com']</code></p><p><code>rawstring</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;a</span><span class=se>\\</span><span class=s1>c&#39;</span><span class=p>,</span> <span class=s1>&#39;a</span><span class=se>\\</span><span class=s1>c a1c aBc&#39;</span><span class=p>))</span> <span class=c1>#a\\c -&gt;a\c [&#39;a\\c&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h4 id=中括号>中括号</h4><p><code>[]</code>取中括号内任意一个</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a[a-z]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a-b a+b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;axb&#39;,&#39;azb&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a[A-Z]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a-b a+b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;aAb&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a[a-zA-Z]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a-b a+b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;axb&#39;, &#39;azb&#39;, &#39;aAb&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a[0-9]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a1b a-b a+b a9b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a1b&#39;, &#39;a9b&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a[-+*/]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a1b a-b a+b a9b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a-b&#39;, &#39;a+b&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a[^-+*/]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a1b a-b a+b a9b&#39;</span><span class=p>))</span> <span class=c1>#[&#39;axb&#39;, &#39;azb&#39;, &#39;aAb&#39;, &#39;a1b&#39;, &#39;a9b&#39;]</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=re模块的其他用法>re模块的其他用法</h3><p><code>re.search</code>匹配成功一次就返回,取不到就返回<code>None</code>,加<code>.group()</code>返回结果。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;a[*]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a1b a-b a+b aaab&#39;</span><span class=p>))</span> <span class=c1>#None</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;a[a-z]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a1b a-b a+b aaab&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span> <span class=c1># axb</span>
</span></span></code></pre></td></tr></table></div></div><p><code>re.match</code>：从开头取,开头没有就为<code>None</code>,只取一次。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;a[0-9]b&#39;</span><span class=p>,</span> <span class=s1>&#39;axb azb aAb a1b a-b a2b a+b&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=k>match</span><span class=p>(</span><span class=s1>&#39;a[0-9]b&#39;</span><span class=p>,</span> <span class=s1>&#39;a9b a8b  axb azb aAb a1b a-b a2b a+b&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;^a[0-9]b&#39;</span><span class=p>,</span> <span class=s1>&#39;a9b a8b  axb azb aAb a1b a-b a2b a+b&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p><code>re.split</code>:分割</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;:&#39;</span><span class=p>,</span> <span class=s1>&#39;root❌0:0::/root:/bin/bash&#39;</span><span class=p>,</span><span class=n>maxsplit</span><span class=o>=</span><span class=mi>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=c1>#结果为：[&#39;root&#39;,&#39;x:0:0::/root:/bin/bash&#39;]</span>
</span></span><span class=line><span class=cl><span class=c1>#&#39;root❌0:0::/root:/bin/bash&#39;.split(&#39;:&#39;)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>re.sub:替换</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>,</span> <span class=s1>&#39;admin&#39;</span><span class=p>,</span> <span class=s1>&#39;root❌0:0::/root:/bin/bash&#39;</span><span class=p>))</span> <span class=c1>#都替换</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=s1>&#39;root&#39;</span><span class=p>,</span> <span class=s1>&#39;admin&#39;</span><span class=p>,</span> <span class=s1>&#39;root❌0:0::/root:/bin/bash&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>))</span> <span class=c1>#只换一次</span>
</span></span></code></pre></td></tr></table></div></div><p>需求：文本前后倒转</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>re</span><span class=o>.</span><span class=n>sub</span><span class=p>(</span><span class=s1>&#39;^([a-z]+)([^a-z]+)(.*?)([^a-z]+)([a-z]+)$&#39;</span><span class=p>,</span> <span class=sa>r</span><span class=s1>&#39;\5\2\3\4\1&#39;</span><span class=p>,</span> <span class=s1>&#39;root❌0:0::/root:/bin/bash&#39;</span><span class=p>))</span> 
</span></span><span class=line><span class=cl><span class=c1>#只换一次</span>
</span></span></code></pre></td></tr></table></div></div><p>解析：</p><p><code>^</code>以&mldr;开头</p><p><code>$</code>以&mldr;结尾</p><p><code>([a-z]+)</code> 分组匹配单词</p><p><code>([^a-z]+)</code>分组匹配非单词</p><p><code>(.*?)</code>分组匹配任意字符</p><p>正则整体表示：以单词开头，并且以单词结尾。<code>r</code>表示显示字符原本含义不进行转义，<code>\5</code>表示第五个分组。<code>r'\5\2\3\4\1'</code> 整体表示第<code>5</code>个分组和第一个分组的内容调换
并且斜杠使用原本含义不做转义。</p><p><code>re.compile</code> :它将正则表达式转化为对象</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>obj</span> <span class=o>=</span> <span class=n>re</span><span class=o>.</span><span class=n>compile</span><span class=p>(</span><span class=s1>&#39;a\d</span><span class=si>{2}</span><span class=s1>b&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;a12b a123b a12345b abbb&#39;</span><span class=p>))</span> <span class=c1>#[&#39;a12b&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>obj</span><span class=o>.</span><span class=n>search</span><span class=p>(</span><span class=s1>&#39;a12b a123b a12345b abbb&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>group</span><span class=p>())</span> <span class=c1>#a12b</span>
</span></span></code></pre></td></tr></table></div></div><p>常用正则表</p><p><img class=lazyload src=/svg/loading.min.svg data-src=https://images-1316789231.cos.ap-shanghai.myqcloud.com/%E7%BC%96%E7%A8%8B/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8.png data-srcset="https://images-1316789231.cos.ap-shanghai.myqcloud.com/%E7%BC%96%E7%A8%8B/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8.png, https://images-1316789231.cos.ap-shanghai.myqcloud.com/%E7%BC%96%E7%A8%8B/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8.png 1.5x, https://images-1316789231.cos.ap-shanghai.myqcloud.com/%E7%BC%96%E7%A8%8B/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8.png 2x" data-sizes=auto alt=https://images-1316789231.cos.ap-shanghai.myqcloud.com/%E7%BC%96%E7%A8%8B/%E5%B8%B8%E7%94%A8%E6%AD%A3%E5%88%99%E8%A1%A8.png title=常用正则表></p><h2 id=时间模块>时间模块</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span> <span class=c1>#时间戳格式：1648026287.9298368</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>()</span><span class=o>.</span><span class=n>tm_mday</span><span class=p>)</span> <span class=c1>#23</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>())</span> <span class=c1>#结构化时间</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>gmtime</span><span class=p>())</span> <span class=c1>#结构化时间</span>
</span></span><span class=line><span class=cl><span class=c1>#结果</span>
</span></span><span class=line><span class=cl><span class=c1>#time.struct_time(tm_year=2022, tm_mon=3, tm_mday=23, tm_hour=17, tm_min=5, tm_sec=26, tm_wday=2, tm_yday=82, tm_isdst=0)</span>
</span></span><span class=line><span class=cl><span class=c1>#time.struct_time(tm_year=2022, tm_mon=3, tm_mday=23, tm_hour=9, tm_min=5, tm_sec=26, tm_wday=2, tm_yday=82, tm_isdst=0)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> %H:%M:%S&#39;</span><span class=p>))</span> <span class=c1>#2022-03-23 17:07:47</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1> </span><span class=si>%X</span><span class=s1>&#39;</span><span class=p>))</span> <span class=c1>#2022-03-23 17:07:47</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#了解</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>(</span><span class=mi>1111111111</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>gmtime</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>()))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>mktime</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>()))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>strftime</span><span class=p>(</span><span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>,</span> <span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>()))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>strptime</span><span class=p>(</span><span class=s1>&#39;2020-03-01&#39;</span><span class=p>,</span> <span class=s1>&#39;%Y-%m-</span><span class=si>%d</span><span class=s1>&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>asctime</span><span class=p>())</span> <span class=c1>#Wed Mar 23 17:15:40 2022</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>ctime</span><span class=p>())</span> <span class=c1>#Wed Mar 23 17:15:40 2022</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>asctime</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>localtime</span><span class=p>()))</span> <span class=c1>#Wed Mar 23 17:16:32 2022</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>ctime</span><span class=p>(</span><span class=mi>111111111</span><span class=p>))</span> <span class=c1>#Tue Jul 10 08:11:51 1973</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>ctime</span><span class=p>(</span><span class=mf>1648027065.7651727</span><span class=p>))</span> <span class=c1>#Wed Mar 23 17:17:45 2022</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>time</span><span class=o>.</span><span class=n>time</span><span class=p>())</span> <span class=c1>#时间戳格式：1648026287.9298368</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#datetime</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>datetime</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>())</span> <span class=c1>#当前时间：2022-03-23 17:20:11.964584</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>fromtimestamp</span><span class=p>(</span><span class=mi>111111111</span><span class=p>))</span> <span class=c1>#1973-07-10 08:11:51</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>+</span><span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=</span><span class=mi>3</span><span class=p>))</span> <span class=c1>#当前时间开始的三天后。2022-03-26 17:22:35.581422</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>+</span><span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>days</span><span class=o>=-</span><span class=mi>3</span><span class=p>))</span> <span class=c1>#当前时间开始的三天前。2022-03-20 17:22:35.581422</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>+</span><span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>minutes</span><span class=o>=</span><span class=mi>3</span><span class=p>))</span> <span class=c1>#当前时间开始的三分钟后。2022-03-23 17:25:35.581422</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>+</span><span class=n>datetime</span><span class=o>.</span><span class=n>timedelta</span><span class=p>(</span><span class=n>seconds</span><span class=o>=</span><span class=mi>3</span><span class=p>))</span> <span class=c1>#当前时间开始的三秒后。2022-03-23 17:22:38.581422</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>datetime</span><span class=o>.</span><span class=n>datetime</span><span class=o>.</span><span class=n>now</span><span class=p>()</span><span class=o>.</span><span class=n>replace</span><span class=p>(</span><span class=n>year</span><span class=o>=</span><span class=mi>2000</span><span class=p>))</span> <span class=c1>#将当前时间中年替换成2000. 2000-03-23 17:25:04.696554</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=random模块>random模块</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>random</span><span class=p>())</span> <span class=c1>#(0,1) --float 大于0且小于1之间的小数 0.8266764258093519</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span> <span class=c1>#[1,3] 大于等于1且小于等于3之间的整数</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randrange</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>3</span><span class=p>))</span> <span class=c1>#[1,3) 大于等于1且小于3之间的整数</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span> <span class=s1>&#39;23&#39;</span><span class=p>,</span> <span class=p>[</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>]]))</span> <span class=c1>#1或者23或者[4,5]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>sample</span><span class=p>([</span><span class=mi>1</span><span class=p>,</span><span class=s1>&#39;23&#39;</span><span class=p>,[</span><span class=mi>4</span><span class=p>,</span><span class=mi>5</span><span class=p>]],</span><span class=mi>2</span><span class=p>))</span> <span class=c1>#列表元素任意2个组合 [[4, 5], &#39;23&#39;]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>uniform</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>))</span> <span class=c1>#大于1小于3的小数 2.3344194593026546</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>l</span><span class=o>=</span><span class=p>[</span><span class=mi>1</span><span class=p>,</span><span class=mi>3</span><span class=p>,</span><span class=mi>4</span><span class=p>,</span><span class=mi>2</span><span class=p>,</span><span class=mi>5</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>random</span><span class=o>.</span><span class=n>shuffle</span><span class=p>(</span><span class=n>l</span><span class=p>)</span> <span class=c1>#列表中元素随机打乱顺序。[5, 1, 3, 4, 2]</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>l</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#随机验证码。数字+字母</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>make_code</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>res</span><span class=o>=</span><span class=s1>&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=n>n</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>s1</span><span class=o>=</span><span class=nb>str</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>9</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>s2</span><span class=o>=</span><span class=nb>chr</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>65</span><span class=p>,</span><span class=mi>90</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>res</span><span class=o>+=</span><span class=n>random</span><span class=o>.</span><span class=n>choice</span><span class=p>([</span><span class=n>s1</span><span class=p>,</span><span class=n>s2</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>res</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>make_code</span><span class=p>(</span><span class=mi>6</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=os模块>os模块</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>()</span> <span class=n>获取当前工作目录</span><span class=err>，</span><span class=n>即当前python脚本工作的目录路径</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>chdir</span><span class=p>(</span><span class=s2>&#34;dirname&#34;</span><span class=p>)</span>  <span class=n>改变当前脚本工作目录</span><span class=err>；</span><span class=n>相当于shell下cd</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>curdir</span>  <span class=n>返回当前目录</span><span class=p>:</span> <span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>pardir</span>  <span class=n>获取当前目录的父目录字符串名</span><span class=err>：</span><span class=p>(</span><span class=s1>&#39;..&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>makedirs</span><span class=p>(</span><span class=s1>&#39;dirname1/dirname2&#39;</span><span class=p>)</span>    <span class=n>可生成多层递归目录</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>removedirs</span><span class=p>(</span><span class=s1>&#39;dirname1&#39;</span><span class=p>)</span>    <span class=n>若目录为空</span><span class=err>，</span><span class=n>则删除</span><span class=err>，</span><span class=n>并递归到上一级目录</span><span class=err>，</span><span class=n>如若也为空</span><span class=err>，</span><span class=n>则删除</span><span class=err>，</span><span class=n>依此类推</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>mkdir</span><span class=p>(</span><span class=s1>&#39;dirname&#39;</span><span class=p>)</span>    <span class=n>生成单级目录</span><span class=err>；</span><span class=n>相当于shell中mkdir</span> <span class=n>dirname</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>rmdir</span><span class=p>(</span><span class=s1>&#39;dirname&#39;</span><span class=p>)</span>    <span class=n>删除单级空目录</span><span class=err>，</span><span class=n>若目录不为空则无法删除</span><span class=err>，</span><span class=n>报错</span><span class=err>；</span><span class=n>相当于shell中rmdir</span> <span class=n>dirname</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>listdir</span><span class=p>(</span><span class=s1>&#39;dirname&#39;</span><span class=p>)</span>    <span class=n>列出指定目录下的所有文件和子目录</span><span class=err>，</span><span class=n>包括隐藏文件</span><span class=err>，</span><span class=n>并以列表方式打印</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>remove</span><span class=p>()</span>  <span class=n>删除一个文件</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>rename</span><span class=p>(</span><span class=s2>&#34;oldname&#34;</span><span class=p>,</span><span class=s2>&#34;newname&#34;</span><span class=p>)</span>  <span class=n>重命名文件</span><span class=o>/</span><span class=n>目录</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>stat</span><span class=p>(</span><span class=s1>&#39;path/filename&#39;</span><span class=p>)</span>  <span class=n>获取文件</span><span class=o>/</span><span class=n>目录信息</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>sep</span>    <span class=n>输出操作系统特定的路径分隔符</span><span class=err>，</span><span class=n>win下为</span><span class=s2>&#34;</span><span class=se>\\</span><span class=s2>&#34;</span><span class=p>,</span><span class=n>Linux下为</span><span class=s2>&#34;/&#34;</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>linesep</span>    <span class=n>输出当前平台使用的行终止符</span><span class=err>，</span><span class=n>win下为</span><span class=s2>&#34;</span><span class=se>\t\n</span><span class=s2>&#34;</span><span class=p>,</span><span class=n>Linux下为</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>pathsep</span>    <span class=n>输出用于分割文件路径的字符串</span> <span class=n>win下为</span><span class=p>;,</span><span class=n>Linux下为</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>name</span>    <span class=n>输出字符串指示当前使用平台</span><span class=err>。</span><span class=n>win</span><span class=o>-&gt;</span><span class=s1>&#39;nt&#39;</span><span class=p>;</span> <span class=n>Linux</span><span class=o>-&gt;</span><span class=s1>&#39;posix&#39;</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s2>&#34;bash command&#34;</span><span class=p>)</span>  <span class=n>运行shell命令</span><span class=err>，</span><span class=n>直接显示</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>environ</span>  <span class=n>获取系统环境变量</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>返回path规范化的绝对路径</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>将path分割成目录和文件名二元组返回</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>返回path的目录</span><span class=err>。</span><span class=n>其实就是os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=n>的第一个元素</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>返回path最后的文件名</span><span class=err>。</span><span class=n>如何path以</span><span class=err>／</span><span class=n>或</span>\<span class=n>结尾</span><span class=err>，</span><span class=n>那么就会返回空值</span><span class=err>。</span><span class=n>即os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=n>path</span><span class=p>)</span><span class=n>的第二个元素</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>exists</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>如果path存在</span><span class=err>，</span><span class=n>返回True</span><span class=err>；</span><span class=n>如果path不存在</span><span class=err>，</span><span class=n>返回False</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isabs</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>如果path是绝对路径</span><span class=err>，</span><span class=n>返回True</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isfile</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>如果path是一个存在的文件</span><span class=err>，</span><span class=n>返回True</span><span class=err>。</span><span class=n>否则返回False</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isdir</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>如果path是一个存在的目录</span><span class=err>，</span><span class=n>则返回True</span><span class=err>。</span><span class=n>否则返回False</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>path1</span><span class=p>[,</span> <span class=n>path2</span><span class=p>[,</span> <span class=o>...</span><span class=p>]])</span>  <span class=n>将多个路径组合后返回</span><span class=err>，</span><span class=n>第一个绝对路径之前的参数将被忽略</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getatime</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>返回path所指向的文件或者目录的最后存取时间</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getmtime</span><span class=p>(</span><span class=n>path</span><span class=p>)</span>  <span class=n>返回path所指向的文件或者目录的最后修改时间</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=n>path</span><span class=p>)</span> <span class=n>返回path的大小</span>
</span></span><span class=line><span class=cl><span class=n>在Linux和Mac平台上</span><span class=err>，</span><span class=n>该函数会原样返回path</span><span class=err>，</span><span class=n>在windows平台上会将路径中所有字符转换为小写</span><span class=err>，</span><span class=n>并将所有斜杠转换为反斜杠</span><span class=err>。</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normcase</span><span class=p>(</span><span class=s1>&#39;c:/windows</span><span class=se>\\</span><span class=s1>system32</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>)</span>   
</span></span><span class=line><span class=cl><span class=s1>&#39;c:</span><span class=se>\\</span><span class=s1>windows</span><span class=se>\\</span><span class=s1>system32</span><span class=se>\\</span><span class=s1>&#39;</span>  
</span></span><span class=line><span class=cl><span class=n>规范化路径</span><span class=err>，</span><span class=n>如</span><span class=o>..</span><span class=n>和</span><span class=o>/</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span><span class=s1>&#39;c://windows</span><span class=se>\\</span><span class=s1>System32</span><span class=se>\\</span><span class=s1>../Temp/&#39;</span><span class=p>)</span>   
</span></span><span class=line><span class=cl><span class=s1>&#39;c:</span><span class=se>\\</span><span class=s1>windows</span><span class=se>\\</span><span class=s1>Temp&#39;</span>   
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=n>a</span><span class=o>=</span><span class=s1>&#39;/Users/jieli/test1/</span><span class=se>\\\a</span><span class=s1>1/</span><span class=se>\\\\</span><span class=s1>aa.py/../..&#39;</span>
</span></span><span class=line><span class=cl><span class=o>&gt;&gt;&gt;</span> <span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=o>/</span><span class=n>Users</span><span class=o>/</span><span class=n>jieli</span><span class=o>/</span><span class=n>test1</span>
</span></span></code></pre></td></tr></table></div></div><p>举例</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>getcwd</span><span class=p>())</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>stat</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\oracle.py&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>stat</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\oracle.py&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>st_size</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>getsize</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\oracle.py&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;tasklist&#39;</span><span class=p>)</span> <span class=c1>#看系统进程,有编码问题。</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\oracle.py&#39;</span><span class=p>))</span> <span class=c1>#(&#39;D:\\pccharmcode&#39;, &#39;oracle.py&#39;)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\oracle.py&#39;</span><span class=p>))</span> <span class=c1>#D:\pccharmcode</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>basename</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\oracle.py&#39;</span><span class=p>))</span> <span class=c1>#oracle.py</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isabs</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;C:</span><span class=se>\\</span><span class=s1>a123123123&#39;</span><span class=p>))</span> <span class=c1>#True</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>isabs</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;/root/123.txt&#39;</span><span class=p>))</span> <span class=c1>#True</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=s1>&#39;C:&#39;</span><span class=p>,</span> <span class=s1>&#39;D:</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>,</span> <span class=s1>&#39;dir1&#39;</span><span class=p>,</span> <span class=s1>&#39;dir2&#39;</span><span class=p>,</span> <span class=s1>&#39;dir3&#39;</span><span class=p>))</span> <span class=c1>#D:dir1\dir2\dir3</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normcase</span><span class=p>(</span><span class=s1>&#39;c:/windows</span><span class=se>\\</span><span class=s1>SYstem32</span><span class=se>\\</span><span class=s1>&#39;</span><span class=p>))</span> <span class=c1>#c:\windows\system32\</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span><span class=s1>&#39;c://windows</span><span class=se>\\</span><span class=s1>System32</span><span class=se>\\</span><span class=s1>../Temp/&#39;</span><span class=p>))</span> <span class=c1>#c:\windows\Temp</span>
</span></span></code></pre></td></tr></table></div></div><p>路径：<code>D:\pccharmcode\api_key\__init__.py</code>
要求获取到根开始的第一级路径。</p><p>方法1：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>dirname</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\api_key\__init__.py&#39;</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><p>方法2：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>res</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\api_key\__init__.py&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>pardir</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>pardir</span>
</span></span><span class=line><span class=cl><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>方法3：</p><p>先将原路径拼接成一个新路径(用<code>os.path.join()</code>)。 <code>D:\pccharmcode\api_key\__init__.py\..\..</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>BASE_DIR</span> <span class=o>=</span> <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>normpath</span><span class=p>(</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span>
</span></span><span class=line><span class=cl>    <span class=n>os</span><span class=o>.</span><span class=n>path</span><span class=o>.</span><span class=n>abspath</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\api_key\__init__.py&#39;</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;..&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;..&#39;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>BASE_DIR</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=sys模块>sys模块</h2><p>主要掌握</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sys.argv
</span></span><span class=line><span class=cl>sys.exit(0)
</span></span><span class=line><span class=cl>sys.path
</span></span></code></pre></td></tr></table></div></div><p>其他</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>sys.argv           命令行参数List，第一个元素是程序本身路径
</span></span><span class=line><span class=cl>sys.exit(n)        退出程序，正常退出时exit(0)
</span></span><span class=line><span class=cl>sys.version        获取Python解释程序的版本信息
</span></span><span class=line><span class=cl>sys.maxint         最大的Int值
</span></span><span class=line><span class=cl>sys.path           返回模块的搜索路径，初始化时使用PYTHONPATH环境变量的值
</span></span><span class=line><span class=cl>sys.platform       返回操作系统平台名称
</span></span></code></pre></td></tr></table></div></div><p>模拟下载进度条</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*1))
</span></span><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*2))
</span></span><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*3))
</span></span><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*4))
</span></span><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*5))
</span></span><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*6))
</span></span><span class=line><span class=cl>print((&#39;[%%-%ds]&#39; %50) %(&#39;#&#39;*7))
</span></span></code></pre></td></tr></table></div></div><p>效果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[#                                                 ]
</span></span><span class=line><span class=cl>[##                                                ]
</span></span><span class=line><span class=cl>[###                                               ]
</span></span><span class=line><span class=cl>[####                                              ]
</span></span><span class=line><span class=cl>[#####                                             ]
</span></span><span class=line><span class=cl>[######                                            ]
</span></span><span class=line><span class=cl>[#######                                           ]
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>sys</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>progress</span><span class=p>(</span><span class=n>percent</span><span class=p>,</span><span class=n>width</span><span class=o>=</span><span class=mi>50</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>percent</span> <span class=o>&gt;=</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>percent</span><span class=o>=</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>show_str</span> <span class=o>=</span> <span class=p>(</span><span class=s1>&#39;[</span><span class=si>%%</span><span class=s1>-</span><span class=si>%d</span><span class=s1>s]&#39;</span> <span class=o>%</span> <span class=n>width</span><span class=p>)</span> <span class=o>%</span> <span class=p>(</span><span class=s1>&#39;#&#39;</span> <span class=o>*</span> <span class=nb>int</span><span class=p>(</span><span class=n>width</span><span class=o>*</span><span class=n>percent</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;</span><span class=se>\r</span><span class=si>%s</span><span class=s1> </span><span class=si>%d%%</span><span class=s1>&#39;</span> <span class=o>%</span><span class=p>(</span><span class=n>show_str</span><span class=p>,</span><span class=nb>int</span><span class=p>(</span><span class=mi>100</span><span class=o>*</span><span class=n>percent</span><span class=p>)),</span><span class=n>end</span><span class=o>=</span><span class=s1>&#39;&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>recv_size</span><span class=o>=</span><span class=mi>0</span>
</span></span><span class=line><span class=cl><span class=n>total_size</span><span class=o>=</span><span class=mi>10241</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=n>recv_size</span> <span class=o>&lt;</span> <span class=n>total_size</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.1</span><span class=p>)</span> <span class=c1>#模拟数据的传输延迟</span>
</span></span><span class=line><span class=cl>    <span class=n>recv_size</span><span class=o>+=</span><span class=mi>1024</span> <span class=c1>#每次收1024</span>
</span></span><span class=line><span class=cl>    <span class=n>progress</span><span class=p>(</span><span class=n>recv_size</span><span class=o>/</span><span class=n>total_size</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=shutil模块>shutil模块</h2><p>高级的文件、文件夹、压缩包 处理模块。</p><p>格式：</p><p><code>shutil.copyfileobj(fsrc, fdst[, length])</code></p><p>将文件内容拷贝到另一个文件中</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copyfileobj</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;old.xml&#39;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>),</span> <span class=nb>open</span><span class=p>(</span><span class=s1>&#39;new.xml&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.copyfile(src, dst)</code></p><p>拷贝文件</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copyfile</span><span class=p>(</span><span class=s1>&#39;f1.log&#39;</span><span class=p>,</span> <span class=s1>&#39;f2.log&#39;</span><span class=p>)</span> <span class=c1>#目标文件无需存在</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.copymode(src, dst)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>仅拷贝权限</span><span class=err>。</span><span class=n>内容</span><span class=err>、</span><span class=n>组</span><span class=err>、</span><span class=n>用户均不变</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copymode</span><span class=p>(</span><span class=s1>&#39;f1.log&#39;</span><span class=p>,</span> <span class=s1>&#39;f2.log&#39;</span><span class=p>)</span> <span class=c1>#目标文件必须存在</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.copystat(src, dst)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>仅拷贝状态的信息</span><span class=err>，</span><span class=n>包括</span><span class=err>：</span><span class=n>mode</span> <span class=n>bits</span><span class=p>,</span> <span class=n>atime</span><span class=p>,</span> <span class=n>mtime</span><span class=p>,</span> <span class=n>flags</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copystat</span><span class=p>(</span><span class=s1>&#39;f1.log&#39;</span><span class=p>,</span> <span class=s1>&#39;f2.log&#39;</span><span class=p>)</span> <span class=c1>#目标文件必须存在</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.copy(src, dst)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>拷贝文件和权限</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copy</span><span class=p>(</span><span class=s1>&#39;f1.log&#39;</span><span class=p>,</span> <span class=s1>&#39;f2.log&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.copy2(src, dst)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>拷贝文件和状态信息</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copy2</span><span class=p>(</span><span class=s1>&#39;f1.log&#39;</span><span class=p>,</span> <span class=s1>&#39;f2.log&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.ignore_patterns(*patterns) shutil.copytree(src, dst, symlinks=False, ignore=None)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>递归的去拷贝文件夹</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copytree</span><span class=p>(</span><span class=s1>&#39;folder1&#39;</span><span class=p>,</span> <span class=s1>&#39;folder2&#39;</span><span class=p>,</span> <span class=n>ignore</span><span class=o>=</span><span class=n>shutil</span><span class=o>.</span><span class=n>ignore_patterns</span><span class=p>(</span><span class=s1>&#39;*.pyc&#39;</span><span class=p>,</span> <span class=s1>&#39;tmp*&#39;</span><span class=p>))</span> <span class=c1>#目标目录不能存在，注意对folder2目录父级目录要有可写权限，ignore的意思是排除 </span>
</span></span></code></pre></td></tr></table></div></div><p>拷贝软连接:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>copytree</span><span class=p>(</span><span class=s1>&#39;f1&#39;</span><span class=p>,</span> <span class=s1>&#39;f2&#39;</span><span class=p>,</span> <span class=n>symlinks</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>ignore</span><span class=o>=</span><span class=n>shutil</span><span class=o>.</span><span class=n>ignore_patterns</span><span class=p>(</span><span class=s1>&#39;*.pyc&#39;</span><span class=p>,</span> <span class=s1>&#39;tmp*&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>通常的拷贝都把软连接拷贝成硬链接，即对待软连接来说，创建新的文件.</p><p>格式：</p><p><code>shutil.rmtree(path[, ignore_errors[, onerror]])</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>递归的去删除文件</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=s1>&#39;folder1&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>格式：</p><p><code>shutil.move(src, dst)</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>递归的去移动文件，它类似mv命令，其实就是重命名。
</span></span><span class=line><span class=cl>shutil.move(&#39;folder1&#39;, &#39;folder3&#39;)
</span></span></code></pre></td></tr></table></div></div><p>压缩与解压缩</p><p>格式：</p><p><code>shutil.make_archive(base_name, format,...)</code></p><p>创建压缩包并返回文件路径，例如：zip、tar.</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>base_name： 压缩包的文件名，也可以是压缩包的路径。只是文件名时，则保存至当前目录，否则保存至指定路径，
</span></span><span class=line><span class=cl>如 data_bak                       =&gt;保存至当前路径
</span></span><span class=line><span class=cl>如：/tmp/data_bak =&gt;保存至/tmp/
</span></span><span class=line><span class=cl>format： 压缩包种类，“zip”, “tar”, “bztar”，“gztar”
</span></span><span class=line><span class=cl>root_dir： 要压缩的文件夹路径（默认当前目录）
</span></span><span class=line><span class=cl>owner： 用户，默认当前用户
</span></span><span class=line><span class=cl>group： 组，默认当前组
</span></span><span class=line><span class=cl>logger： 用于记录日志，通常是logging.Logger对象
</span></span></code></pre></td></tr></table></div></div><p>将 <code>/data</code> 下的文件打包放置当前程序目录</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>shutil</span><span class=o>.</span><span class=n>make_archive</span><span class=p>(</span><span class=s2>&#34;data_bak&#34;</span><span class=p>,</span> <span class=s1>&#39;gztar&#39;</span><span class=p>,</span> <span class=n>root_dir</span><span class=o>=</span><span class=s1>&#39;/data&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>将 <code>/data</code>下的文件打包放置 <code>/tmp/</code>目录</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=n>ret</span> <span class=o>=</span> <span class=n>shutil</span><span class=o>.</span><span class=n>make_archive</span><span class=p>(</span><span class=s2>&#34;/tmp/data_bak&#34;</span><span class=p>,</span> <span class=s1>&#39;gztar&#39;</span><span class=p>,</span> <span class=n>root_dir</span><span class=o>=</span><span class=s1>&#39;/data&#39;</span><span class=p>)</span> 
</span></span></code></pre></td></tr></table></div></div><p><code>shutil </code>对压缩包的处理是调用 <code>ZipFile</code> 和 <code>TarFile</code> 两个模块来进行的.</p><p>详细：</p><p>压缩</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=s1>&#39;laxi.zip&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>z</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;a.log&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>z</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;data.data&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>z</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>解压</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>z</span> <span class=o>=</span> <span class=n>zipfile</span><span class=o>.</span><span class=n>ZipFile</span><span class=p>(</span><span class=s1>&#39;laxi.zip&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>z</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=n>path</span><span class=o>=</span><span class=s1>&#39;.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>z</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>使用<code>tarfile</code>压缩与解压缩</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>import tarfile
</span></span></code></pre></td></tr></table></div></div><p>压缩</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>t</span><span class=o>=</span><span class=n>tarfile</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;/tmp/egon.tar&#39;</span><span class=p>,</span><span class=s1>&#39;w&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s1>&#39;/test1/a.py&#39;</span><span class=p>,</span><span class=n>arcname</span><span class=o>=</span><span class=s1>&#39;a.bak&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>.</span><span class=n>add</span><span class=p>(</span><span class=s1>&#39;/test1/b.py&#39;</span><span class=p>,</span><span class=n>arcname</span><span class=o>=</span><span class=s1>&#39;b.bak&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>解压缩</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>t</span><span class=o>=</span><span class=n>tarfile</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;/tmp/egon.tar&#39;</span><span class=p>,</span><span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=s1>&#39;/egon&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>t</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span></code></pre></td></tr></table></div></div><p>练习：</p><p>将<code>ATM</code>文件夹以<code>tar.gz</code>方式压缩，然后解压到<code>aaa</code>文件夹内。最后删除<code>aaa</code>文件夹。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>shutil</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>tarfile</span>
</span></span><span class=line><span class=cl><span class=c1>#压缩</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>make_archive</span><span class=p>(</span><span class=s2>&#34;backup&#34;</span><span class=p>,</span> <span class=s1>&#39;gztar&#39;</span><span class=p>,</span> <span class=n>root_dir</span><span class=o>=</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\ATM&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=c1>#解压</span>
</span></span><span class=line><span class=cl><span class=n>o</span> <span class=o>=</span> <span class=n>tarfile</span><span class=o>.</span><span class=n>open</span><span class=p>(</span><span class=s1>&#39;backup.tar.gz&#39;</span><span class=p>,</span> <span class=s1>&#39;r&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>o</span><span class=o>.</span><span class=n>extractall</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\aaa&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>o</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=c1>#删除aaa文件夹</span>
</span></span><span class=line><span class=cl><span class=n>shutil</span><span class=o>.</span><span class=n>rmtree</span><span class=p>(</span><span class=sa>r</span><span class=s1>&#39;D:\pccharmcode\aaa&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=xml模块>xml模块</h2><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>from xml.etree import ElementTree
</span></span><span class=line><span class=cl>tree = ElementTree.parse(&#39;a.xml&#39;)
</span></span><span class=line><span class=cl>root = tree.getroot()
</span></span><span class=line><span class=cl># print(root.tag)
</span></span><span class=line><span class=cl># print(root.attrib)
</span></span><span class=line><span class=cl># print(root.text)
</span></span></code></pre></td></tr></table></div></div><p>三种查找方式</p><p>从子节点中查找</p><p>显示一种</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>root</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;country&#39;</span><span class=p>))</span> <span class=c1>#&lt;Element &#39;country&#39; at 0x000001E26EDCC130&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#加.tag .attrib .text就可以显示内容</span>
</span></span></code></pre></td></tr></table></div></div><p>显示所有。以列表的形式显示。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>root</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;country&#39;</span><span class=p>))</span> 
</span></span><span class=line><span class=cl><span class=c1>#[&lt;Element &#39;country&#39; at 0x0000027D6F00C0E0&gt;, &lt;Element &#39;country&#39; at 0x0000027D6F00C2C0&gt;, &lt;Element &#39;country&#39; at 0x0000027D6F00C450&gt;]</span>
</span></span></code></pre></td></tr></table></div></div><p>注意：如果找不到就会显示<code> None</code></p><p>从树形结构中查找</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>root</span><span class=o>.</span><span class=n>iter</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>list</span><span class=p>(</span><span class=n>root</span><span class=o>.</span><span class=n>iter</span><span class=p>(</span><span class=s1>&#39;country&#39;</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=遍历文档>遍历文档</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>xml.etree</span> <span class=kn>import</span> <span class=n>ElementTree</span>
</span></span><span class=line><span class=cl><span class=n>tree</span> <span class=o>=</span> <span class=n>ElementTree</span><span class=o>.</span><span class=n>parse</span><span class=p>(</span><span class=s1>&#39;a.xml&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>root</span> <span class=o>=</span> <span class=n>tree</span><span class=o>.</span><span class=n>getroot</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>root</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;==========&gt;&#39;</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>tag</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>attrib</span><span class=p>,</span> <span class=n>country</span><span class=o>.</span><span class=n>attrib</span><span class=p>[</span><span class=s1>&#39;name&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>rank</span> <span class=ow>in</span> <span class=n>country</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>rank</span><span class=o>.</span><span class=n>tag</span><span class=p>,</span> <span class=n>rank</span><span class=o>.</span><span class=n>attrib</span><span class=p>,</span> <span class=n>rank</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>结果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>==========&gt; country {&#39;name&#39;: &#39;Liechtenstein&#39;} Liechtenstein
</span></span><span class=line><span class=cl>rank {&#39;updated&#39;: &#39;yes&#39;} 2
</span></span><span class=line><span class=cl>year {} 2008
</span></span><span class=line><span class=cl>gdppc {} 141100
</span></span><span class=line><span class=cl>neighbor {&#39;name&#39;: &#39;Austria&#39;, &#39;direction&#39;: &#39;E&#39;} None
</span></span><span class=line><span class=cl>neighbor {&#39;name&#39;: &#39;Switzerland&#39;, &#39;direction&#39;: &#39;W&#39;} None
</span></span><span class=line><span class=cl>==========&gt; country {&#39;name&#39;: &#39;Singapore&#39;} Singapore
</span></span><span class=line><span class=cl>rank {&#39;updated&#39;: &#39;yes&#39;} 5
</span></span><span class=line><span class=cl>year {} 2011
</span></span><span class=line><span class=cl>gdppc {} 59900
</span></span><span class=line><span class=cl>neighbor {&#39;name&#39;: &#39;Malaysia&#39;, &#39;direction&#39;: &#39;N&#39;} None
</span></span><span class=line><span class=cl>==========&gt; country {&#39;name&#39;: &#39;Panama&#39;} Panama
</span></span><span class=line><span class=cl>rank {&#39;updated&#39;: &#39;yes&#39;} 69
</span></span><span class=line><span class=cl>year {} 2011
</span></span><span class=line><span class=cl>gdppc {} 13600
</span></span><span class=line><span class=cl>neighbor {&#39;name&#39;: &#39;Costa Rica&#39;, &#39;direction&#39;: &#39;W&#39;} None
</span></span><span class=line><span class=cl>neighbor {&#39;name&#39;: &#39;Colombia&#39;, &#39;direction&#39;: &#39;E&#39;} None
</span></span></code></pre></td></tr></table></div></div><h4 id=只遍历year节点>只遍历year节点</h4><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>year</span> <span class=ow>in</span> <span class=n>root</span><span class=o>.</span><span class=n>iter</span><span class=p>(</span><span class=s1>&#39;year&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>year</span><span class=o>.</span><span class=n>tag</span><span class=p>,</span> <span class=n>year</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>结果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>year 2008
</span></span><span class=line><span class=cl>year 2011
</span></span><span class=line><span class=cl>year 2011
</span></span></code></pre></td></tr></table></div></div><h3 id=修改>修改</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>c</span> <span class=ow>in</span> <span class=n>root</span><span class=o>.</span><span class=n>iter</span><span class=p>(</span><span class=s1>&#39;year&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>new_year</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>text</span><span class=p>)</span><span class=o>+</span><span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=nb>str</span><span class=p>(</span><span class=n>new_year</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;update&#39;</span><span class=p>,</span> <span class=s1>&#39;yes&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;version&#39;</span><span class=p>,</span> <span class=s1>&#39;1.0&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tree</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;b.xml&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=删除>删除</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>root</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;country&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>rank</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>country</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;rank&#39;</span><span class=p>)</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>rank</span> <span class=o>&gt;</span> <span class=mi>50</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>root</span><span class=o>.</span><span class=n>remove</span><span class=p>(</span><span class=n>country</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>tree</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;output.xml&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>在<code>country</code>内添加<code>（append）</code>节点<code>year2</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>country</span> <span class=ow>in</span> <span class=n>root</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;country&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>year</span> <span class=ow>in</span> <span class=n>country</span><span class=o>.</span><span class=n>findall</span><span class=p>(</span><span class=s1>&#39;year&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>int</span><span class=p>(</span><span class=n>year</span><span class=o>.</span><span class=n>text</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>2000</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>year2</span> <span class=o>=</span> <span class=n>ElementTree</span><span class=o>.</span><span class=n>Element</span><span class=p>(</span><span class=s1>&#39;year2&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>year2</span><span class=o>.</span><span class=n>text</span> <span class=o>=</span> <span class=s1>&#39;happy-new-year&#39;</span>
</span></span><span class=line><span class=cl>            <span class=n>year2</span><span class=o>.</span><span class=n>attrib</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;update&#39;</span><span class=p>:</span><span class=s1>&#39;yes&#39;</span><span class=p>}</span>
</span></span><span class=line><span class=cl>            <span class=n>country</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>year2</span><span class=p>)</span> <span class=c1>#往country节点下添加子节点</span>
</span></span><span class=line><span class=cl><span class=n>tree</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=s1>&#39;a.xml.swap&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=configerparser模块>configerparser模块</h2><p><code>[mysqld]</code>叫做<code>section</code></p><p><code>port</code>、<code>basedir</code>等等叫做<code>option</code></p><p>练习配置文件<code>my.ini</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>[mysqld]
</span></span><span class=line><span class=cl>port = 3306
</span></span><span class=line><span class=cl>basedir = D:\\softnew\\MYSQL\\mysql-5.7.20-winx64
</span></span><span class=line><span class=cl>max_connections = 200
</span></span><span class=line><span class=cl>character-set-server = utf8
</span></span><span class=line><span class=cl>default-storage-engine = INNODB
</span></span><span class=line><span class=cl>skip-grant-table = True
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>[client]
</span></span><span class=line><span class=cl>user = root
</span></span><span class=line><span class=cl>password = 123
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>configparser</span>
</span></span><span class=line><span class=cl><span class=n>config</span> <span class=o>=</span> <span class=n>configparser</span><span class=o>.</span><span class=n>ConfigParser</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>read</span><span class=p>(</span><span class=s1>&#39;my.ini&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>sections</span><span class=p>())</span> <span class=c1>#查看所有的标题</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>options</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>))</span> <span class=c1>#查看标题mysqld下所有key=value的key</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>))</span> <span class=c1>#查看标题mysqld下port的值=&gt;字符串格式</span>
</span></span></code></pre></td></tr></table></div></div><p>判断有没有名字为<code>aaa</code>的<code>option</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>if</span> <span class=n>config</span><span class=o>.</span><span class=n>has_option</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;aaa&#39;</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;aaaa&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>查看值的类型</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>type</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;skip-grant-table&#39;</span><span class=p>)))</span> <span class=c1>#&lt;class &#39;str&#39;&gt;</span>
</span></span></code></pre></td></tr></table></div></div><p>转换成布尔类型</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>getboolean</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;skip-grant-table&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>getint</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>config</span><span class=o>.</span><span class=n>getfloat</span><span class=p>(</span><span class=s1>&#39;mysqld&#39;</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>向文件中添加section和option</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>add_section</span><span class=p>(</span><span class=s1>&#39;client1&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;client1&#39;</span><span class=p>,</span> <span class=s1>&#39;name&#39;</span><span class=p>,</span> <span class=s1>&#39;jack&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;client1&#39;</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>,</span> <span class=s1>&#39;2000&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;my.ini&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p><code>my.ini</code>文件</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/postimages/image-20220326204239624.webp data-srcset="/postimages/image-20220326204239624.webp, /postimages/image-20220326204239624.webp 1.5x, /postimages/image-20220326204239624.webp 2x" data-sizes=auto alt=/postimages/image-20220326204239624.webp title=image-20220326204239624></p><p>将<code>section（client1）</code>中<code>option(port)</code>对应的值<code>2000</code>改为<code>3000</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>set</span><span class=p>(</span><span class=s1>&#39;client1&#39;</span><span class=p>,</span> <span class=s1>&#39;port&#39;</span><span class=p>,</span> <span class=s1>&#39;3000&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>config</span><span class=o>.</span><span class=n>write</span><span class=p>(</span><span class=nb>open</span><span class=p>(</span><span class=s1>&#39;my.ini&#39;</span><span class=p>,</span> <span class=s1>&#39;w&#39;</span><span class=p>,</span> <span class=n>encoding</span><span class=o>=</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>查看<code>my.ini</code>文件，<code>port</code>对应的值已经改变。</p><h2 id=hashlib模块>hashlib模块</h2><h3 id=什么叫hash>什么叫hash?</h3><p>hash是一种算法（<code>3.x</code>里代替了<code>md5模块</code>和<code>sha模块</code>，主要提供 <code>SHA1, SHA224, SHA256, SHA384, SHA512 ，MD5 算法</code>），该算法接受传入的内容，经过运算得到一串hash值。</p><h3 id=hash值的特点>hash值的特点</h3><p>只要传入的内容一样，得到的hash值必然一样=====>要用明文传输密码文件完整性校验。</p><p>不能由hash值返解成内容=======》把密码做成hash值，不应该在网络传输明文密码。</p><p>只要使用的hash算法不变，无论校验的内容有多大，得到的hash值长度是固定的。</p><p>hash算法就像一座工厂，工厂接收你送来的原材料（可以用<code>m.update()</code>为工厂运送原材料），经过加工返回的产品就是<code>hash值</code>。</p><p><img class=lazyload src=/svg/loading.min.svg data-src=/postimages/image-20220326213810288.webp data-srcset="/postimages/image-20220326213810288.webp, /postimages/image-20220326213810288.webp 1.5x, /postimages/image-20220326213810288.webp 2x" data-sizes=auto alt=/postimages/image-20220326213810288.webp title=image-20220326213810288></p><p>练习</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>()</span> <span class=c1># m=hashlib.sha256()</span>
</span></span><span class=line><span class=cl><span class=n>m</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;jack&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1>#4ff9fc6e4e5d5f590c4f2134a8cc96d1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;j&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1>#636a4e0a176a6cbb43dd00aec17e64ab</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m2</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha3_256</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>m2</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;jack123&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m2</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1>#1183ac670862872ae3315c178a68dddd6166a004b0086bfa23f70e780fe7545c</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>m2</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;j&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m2</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1>#fe50db7bfb8a1e79934413625d2024114de0afd62bd17c3e9d97aee74f8553c6</span>
</span></span></code></pre></td></tr></table></div></div><p>注意：把一段很长的数据<code>update多次</code>，与一次<code>update</code>这段长数据，得到的结果一样。但是<code>update</code>多次为校验大文件提供了可能。</p><p>以上加密算法虽然依然非常厉害，但时候存在缺陷，即：通过撞库可以反解。所以，有必要对加密算法中添加自定义key再来做加密。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=nb>hash</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>(</span><span class=s1>&#39;898oaFs09f&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>hash</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;alvin&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=nb>hash</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1>#e79e68f070cdedcfe63eaf1a2e92c83b4cfb1b5c6bc452d214c1b7e77cdfd1c7</span>
</span></span></code></pre></td></tr></table></div></div><p>模拟用户登录并把密码哈希</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>name</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;user&gt;&gt;: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>pwd</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;password&gt;&gt;: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>m</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=n>pwd</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>pwd</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>name</span><span class=p>,</span> <span class=n>pwd</span><span class=p>)</span> <span class=c1># jack 1d6c1e168e362bc0092f247399003a88(jack123)</span>
</span></span></code></pre></td></tr></table></div></div><p>模拟撞库，先生成字典。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=n>cryt_pwd</span> <span class=o>=</span> <span class=s1>&#39;1d6c1e168e362bc0092f247399003a88&#39;</span>
</span></span><span class=line><span class=cl><span class=n>pwds</span><span class=o>=</span><span class=p>[</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;jack1234&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;jack&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;jack456&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;jack123&#39;</span>
</span></span><span class=line><span class=cl><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>mack_dic</span><span class=p>(</span><span class=n>pwds</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>dic</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>pwd</span> <span class=ow>in</span> <span class=n>pwds</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>m</span> <span class=o>=</span> <span class=n>hashlib</span><span class=o>.</span><span class=n>md5</span><span class=p>(</span><span class=n>pwd</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=n>dic</span><span class=p>[</span><span class=n>pwd</span><span class=p>]</span> <span class=o>=</span> <span class=n>m</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>dic</span>
</span></span><span class=line><span class=cl><span class=n>dic</span> <span class=o>=</span> <span class=n>mack_dic</span><span class=p>(</span><span class=n>pwds</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>for</span> <span class=n>pwd</span> <span class=ow>in</span> <span class=n>dic</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>dic</span><span class=p>[</span><span class=n>pwd</span><span class=p>]</span> <span class=o>==</span> <span class=n>cryt_pwd</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>pwd</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p><code>结果：jack123</code></p><p>python 还有一个 <code>hmac 模块</code>，它内部对我们创建 <code>key</code> 和 内容 进行进一步的处理然后再加密</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=n>h1</span><span class=o>=</span><span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span><span class=n>digestmod</span><span class=o>=</span><span class=s1>&#39;md5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h1</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;world&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>h1</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=n>m</span> <span class=o>=</span> <span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=n>key</span><span class=o>=</span><span class=s1>&#39;加盐&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=n>msg</span><span class=o>=</span><span class=s1>&#39;jack123&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span> <span class=n>digestmod</span><span class=o>=</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>m</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span>
</span></span></code></pre></td></tr></table></div></div><p>要想保证<code>hmac</code>最终结果一致，必须保证：
<code>hmac.new</code>括号内指定的初始key一样
无论<code>update</code>多少次，校验的内容累加到一起是一样的内容</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=c1># 操作一</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=n>h1</span><span class=o>=</span><span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span><span class=n>digestmod</span><span class=o>=</span><span class=s1>&#39;md5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h1</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;world&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>h1</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1># 0e2564b7e100f034341ea477c23f283b</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 操作二</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hmac</span>
</span></span><span class=line><span class=cl><span class=n>h2</span><span class=o>=</span><span class=n>hmac</span><span class=o>.</span><span class=n>new</span><span class=p>(</span><span class=s1>&#39;hello&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>),</span><span class=n>digestmod</span><span class=o>=</span><span class=s1>&#39;md5&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>h2</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;w&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>h2</span><span class=o>.</span><span class=n>update</span><span class=p>(</span><span class=s1>&#39;orld&#39;</span><span class=o>.</span><span class=n>encode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>h1</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>())</span> <span class=c1># 0e2564b7e100f034341ea477c23f283b</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=subprocess模块>subprocess模块</h2><p>在<code>linux</code>中使用<code>subporcess</code>模块可以实现shell命令效果。</p><p>在<code>windows</code>中使用可以实现<code>windows平台</code>下的命令。</p><p>举例：在<code>Linux</code>下查找<code>/root路径</code>下所有以<code>.txt</code>结尾的文件。</p><p>shell 实现</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ls /root <span class=p>|</span> grep txt$
</span></span></code></pre></td></tr></table></div></div><p><code>subprocess模块</code>实现</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=n>res1</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>(</span><span class=s1>&#39;ls /root&#39;</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span><span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>res</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>(</span><span class=s1>&#39;grep txt$&#39;</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stdin</span><span class=o>=</span><span class=n>res1</span><span class=o>.</span><span class=n>stdout</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;utf-8&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>解析：</p><p><code>subprocess.Popen()</code>执行命令<code>ls /root</code>并传入管道（<code>subprocess.PIPE</code>）并赋值给<code>res1</code></p><p><code>shell=True</code>指定用<code>shell</code>来执行。</p><p><code>subprocess.Popen()</code>执行命令<code>grep txt$</code>先把<code>res1</code>传进来，然后再把整个命令作为输出，最后赋值给res。</p><p>读输出的内容，<code>linux平台</code>默认编码为<code>utf-8</code>。</p><p>结果：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>a.txt
</span></span><span class=line><span class=cl>output.txt
</span></span><span class=line><span class=cl>url.txt
</span></span></code></pre></td></tr></table></div></div><p>windows平台</p><p>查看当前系统所有任务</p><p><code>shell</code></p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>tasklist
</span></span></code></pre></td></tr></table></div></div><p>使用<code>subprocess</code>实现</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>subprocess</span>
</span></span><span class=line><span class=cl><span class=n>res</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>Popen</span><span class=p>(</span><span class=s1>&#39;tasklist&#39;</span><span class=p>,</span> <span class=n>shell</span><span class=o>=</span><span class=kc>True</span><span class=p>,</span> <span class=n>stdout</span><span class=o>=</span><span class=n>subprocess</span><span class=o>.</span><span class=n>PIPE</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>res</span><span class=o>.</span><span class=n>stdout</span><span class=o>.</span><span class=n>read</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>(</span><span class=s1>&#39;gbk&#39;</span><span class=p>))</span>
</span></span></code></pre></td></tr></table></div></div><p>注意：windows下默认编码为<code>gbk</code>。使用其他编码会出现乱码情况。</p><p>结果</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>映像名称                       PID 会话名              会话#       内存使用 
</span></span><span class=line><span class=cl>========================= ======== ================ =========== ============
</span></span><span class=line><span class=cl>System Idle Process              0 Services                   0          8 K
</span></span><span class=line><span class=cl>System                           4 Services                   0        148 K
</span></span><span class=line><span class=cl>Secure System                   88 Services                   0     73,304 K
</span></span><span class=line><span class=cl>Registry                       156 Services                   0    108,364 K
</span></span><span class=line><span class=cl>smss.exe                       532 Services                   0      1,232 K
</span></span><span class=line><span class=cl>csrss.exe                      868 Services                   0      5,128 K
</span></span><span class=line><span class=cl>Everything.exe               14296 Console                    1    110,268 K
</span></span><span class=line><span class=cl>LogiOptions.exe               2244 Console                    1     15,932 K
</span></span><span class=line><span class=cl>conhost.exe                   6812 Console                    1     11,480 K
</span></span><span class=line><span class=cl>python.exe                    9740 Console                    1     10,116 K
</span></span><span class=line><span class=cl>cmd.exe                       3740 Console                    1      4,852 K
</span></span><span class=line><span class=cl>tasklist.exe                 15428 Console                    1      9,824 K
</span></span></code></pre></td></tr></table></div></div><p>官方文档<a href="https://docs.python.org/2/library/subprocess.html?highlight=subprocess#frequently-used-arguments" target=_blank rel="noopener noreffer">参考</a></p><div class="details admonition warning open"><div class="details-summary admonition-title"><i class="icon fas fa-exclamation-triangle fa-fwwarning"></i>警告<i class="details-icon fas fa-angle-right fa-fw"></i></div><div class=details-content><div class=admonition-content>本文最后更新于 <span class=timeago datetime=2022-03-26T12:44:37 title="March 26, 2022">March 26, 2022</span>，文中内容可能已过时，请谨慎使用。</div></div></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-03-26</span></div></div><div class=post-info-line><div class=post-info-md><span><a class=link-to-markdown href=/python%E5%B8%B8%E7%94%A8%E6%A8%A1%E5%9D%97/index.md target=_blank>阅读原始文档</a></span></div><div class=post-info-share><span></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/python/>python</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85/ class=prev rel=prev title=模块与包><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>模块与包</a>
<a href=/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/ class=next rel=next title=序列化与反序列化>序列化与反序列化<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line><span id=run-time></span></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2021 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=/ target=_blank>Peng</a></span>&nbsp;|&nbsp;<span class=license><a rel="license external nofollow noopener noreffer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=/lib/katex/katex.min.css><link rel=stylesheet href=/lib/katex/copy-tex.min.css><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><script type=text/javascript src=/lib/autocomplete/autocomplete.min.js></script><script type=text/javascript src=/lib/lunr/lunr.min.js></script><script type=text/javascript src=/lib/lunr/lunr.stemmer.support.min.js></script><script type=text/javascript src=/lib/lunr/lunr.zh.min.js></script><script type=text/javascript src=/lib/lazysizes/lazysizes.min.js></script><script type=text/javascript src=/lib/clipboard/clipboard.min.js></script><script type=text/javascript src=/lib/sharer/sharer.min.js></script><script type=text/javascript src=/lib/katex/katex.min.js></script><script type=text/javascript src=/lib/katex/auto-render.min.js></script><script type=text/javascript src=/lib/katex/copy-tex.min.js></script><script type=text/javascript src=/lib/katex/mhchem.min.js></script><script type=text/javascript src=/lib/cookieconsent/cookieconsent.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:0},comment:{},cookieconsent:{content:{dismiss:"同意",link:"了解更多",message:"本网站使用 Cookies 来改善您的浏览体验."},enable:!0,palette:{button:{background:"#f0f0f0"},popup:{background:"#1aa3ff"}},theme:"edgeless"},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},search:{highlightTag:"em",lunrIndexURL:"/index.json",lunrLanguageCode:"zh",lunrSegmentitURL:"/lib/lunr/lunr.segmentit.js",maxResultLength:10,noResultsFound:"没有找到结果",snippetLength:50,type:"lunr"}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript src=/js/custom.js></script>
<script type=text/javascript src=https://cdn.jsdelivr.net/npm/jquery@2.1.3/dist/jquery.min.js></script></body></html>